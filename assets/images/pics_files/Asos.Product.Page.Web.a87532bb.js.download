define("Models/Component",[],(function(){return function(){this.componentConfig=null,this.type=null,this.elementId=null,this.element=null,this.useComponentTemplate=!1,this.data=null,this.state=void 0,this.setComponentConfig=function(ut){this.componentConfig=void 0!==ut?ut:null},this.setType=function(ut){this.type=void 0!==ut?ut:null},this.setElementId=function(ut){this.elementId=void 0!==ut?ut:this.type,this.element=document.getElementById(this.elementId)},this.setUseComponentTemplate=function(ut){ut=void 0===ut||ut,this.useComponentTemplate="boolean"!=typeof ut||ut},this.setData=function(ut){this.data=void 0!==ut?ut:null},this.setState=function(ut){this.state=void 0!==ut?ut:this.state},this.getComponentPath=function(){return null!==this.type?"Components/"+this.type+"/"+this.type:null},this.getElement=function(){return this.element},this.getDictionary=function(){if(!this.element||!this.element.hasAttribute("dictionary"))return null;try{return JSON.parse(this.element.getAttribute("dictionary"))}catch(ut){return null}},this.getComponentConfig=function(){return!this.useComponentTemplate&&this.element&&(this.componentConfig.template={element:this.element}),this.componentConfig}}})),define("ProductUtils/ComponentLoader",["ko","Models/Component"],(function(ut,ht){return function(){this.register=function(pt,mt,ft){var gt=new ht;return gt.setType(pt.type),gt.setElementId(pt.elementId),gt.setData(mt),gt.setState(ft),gt.setUseComponentTemplate(pt.useComponentTemplate),require([gt.getComponentPath()],(function(ht){gt.setComponentConfig(ht),ut.components.register(pt.name,gt.getComponentConfig()),(null!==gt.getElement()||gt.getElement()!=={})&&ut.applyBindingsToNode(gt.getElement(),{component:{name:pt.name,params:{dictionary:gt.getDictionary(),data:gt.data,state:gt.state}}})})),gt},this.unregister=function(ht){ht&&0!==ht.length&&ut.components.isRegistered(ht)&&ut.components.unregister(ht)}}})),define("videoPlayerView",[],(function(){return'<div class="asos-media-players">\r\n    <div class="amp-video-player amp-relative">\r\n        <video class="amp-page amp-video-element" data-bind="foreach: sources" controls="controls" muted>\r\n            <source data-bind="attr: { type: type, src: src }" />\r\n        </video>\r\n        <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\r\n            <div class="amp-message-container">\r\n                <div class="amp-message-box">\r\n                    <h2 data-bind="html: messages.errorHeaderText"></h2>\r\n                    <p data-bind="html: messages.errorMessageText"></p>\r\n                    <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="amp-page amp-page-message amp-unsupported-page" data-bind="visible: isUnsupportedPageVisible">\r\n            <div class="amp-message-container">\r\n                <div class="amp-message-box">\r\n                    <h2 data-bind="html: messages.unsupportedHeaderText"></h2>\r\n                    <p data-bind="html: messages.unsupportedMessageText"></p>\r\n                    <div class="amp-button amp-button-black" data-bind="html: messages.closeButtonText, click: closeButtonClicked"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'})),define("utils/scene7.config",[],(function(){"use strict";return function(ut,ht){this.jsonpCallback="s7jsonResponse",this.jsonpErrorCallback="s7jsonError",this.scene7imageServer=ut,this.scene7videoServer=ht,this.spinsetManifestFileUrlPattern=this.scene7imageServer+"/products/test-desc/[productID]-spinset",this.imageUrlPattern=this.scene7imageServer+"/products/[assetID]",this.maxImageSize={width:4e3,height:4e3},this.imageMinPartitionFactors={horizontal:3,vertical:4}}})),define("utils/scene7.DataProvider",["$"],(function(ut){"use strict";var e=function(ut){this.scene7config=ut,this.manifestCache={}};return e.prototype.ABSOLUTE_URL_REGEX=/^https?:\/\/|^\/\//i,e.requests=[],e.prototype.getJson=function(ht,pt,mt){Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpErrorCallback)||(window[this.scene7config.jsonpErrorCallback]=function(ut,ht){var pt=e.requests[ht];"function"==typeof pt.onError&&pt.onError()}),Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpCallback)||(window[this.scene7config.jsonpCallback]=function(ut,ht){var pt=e.requests[ht];"function"==typeof pt.onSuccess&&pt.onSuccess(ut)}),e.requests.push({onSuccess:pt,onError:mt});var ft=e.requests.length-1;ut.ajax({url:ht.replace("[requestID]",ft),jsonp:!1,jsonpCallback:this.scene7config.jsonpCallback+ft,dataType:"jsonp",cache:!0,success:pt,error:mt})},e.prototype.getManifestData=function(ht){this.ABSOLUTE_URL_REGEX.test(ht)||(ht="//"+ht);var pt=new ut.Deferred;if(!this.manifestCache[ht]){var mt=ht+(-1===ht.indexOf("?")?"?":"&")+"req=set,json&id=[requestID]";return this.getJson(mt,function(mt){this.manifestCache[ht]=mt,pt.resolve(ut.extend(!0,{},mt))}.bind(this),(function(){pt.reject()})),pt.promise()}return pt.resolve(ut.extend(!0,{},this.manifestCache[ht])),pt.promise()},e})),define("videoPlayer/DataMapper",[],(function(){"use strict";var t=function(ut){this.scene7config=ut};return t.prototype.VIDEO_FILE_URL_PATTERN="/products/[assetID]",t.prototype.VIDEO_TYPE_FORMAT={m3u8:"application/x-mpegurl",mp4:"video/mp4"},t.prototype.map=function(ut){return ut.set.item.map(this.getAssetFromServerItem.bind(this))},t.prototype.getAssetFromServerItem=function(ut){return{bitrate:parseInt(ut.v.bitrate,10),width:parseInt(ut.v.dx,10),height:parseInt(ut.v.dy,10),src:this.scene7config.scene7videoServer+this.VIDEO_FILE_URL_PATTERN.replace("[assetID]",ut.v.path),format:ut.v.suffix,type:this.VIDEO_TYPE_FORMAT[ut.v.suffix],fps:ut.userdata&&ut.userdata[0]&&ut.userdata[0].Video_Frame_Rate?parseFloat(ut.userdata[0].Video_Frame_Rate):null}},t})),define("utils/deviceHelper",[],(function(){"use strict";var t=function(){return this};return t.prototype.getScreenProperties=function(ut){return{width:ut.screen.width,height:ut.screen.height}},t.prototype.isPhysicalSizeGreaterThanLogicalSize=function(ut){return ut&&void 0!==ut.systemXDPI&&void 0!==ut.logicalXDPI&&ut.systemXDPI>ut.logicalXDPI},t.prototype.getDevicePixelRatio=function(ut){var ht=1;return this.isPhysicalSizeGreaterThanLogicalSize(ut.screen)?ht=ut.screen.systemXDPI/ut.screen.logicalXDPI:void 0!==ut.devicePixelRatio&&(ht=ut.devicePixelRatio),ht},t.prototype.getWidthInPhysicalPixels=function(ut){return this.getScreenProperties(ut).width*this.getDevicePixelRatio(ut)},t.prototype.getHeightInPhysicalPixels=function(ut){return this.getScreenProperties(ut).height*this.getDevicePixelRatio(ut)},new t})),define("videoPlayer/AssetsProvider",["$","utils/deviceHelper"],(function(ut,ht){"use strict";var i=function(ut,ht,pt){this.scene7config=ut,this.dataProvider=ht,this.dataMapper=pt};return i.prototype.MANIFEST_PATH_PATTERN="/products/test-desc/[productID]-catwalk-AVS",i.prototype.DEFAULT_FPS=50,i.prototype.DEFAULT_BITRATES={480:800,720:1200,1080:2500},i.prototype.getAssetsByFormat=function(ut,ht){return ut.filter((function(ut){return ut.format===ht}))},i.prototype.isBetterWidthDifference=function(ut,ht){return 0===ut||ut>0&&0>ht||!(0>ut&&ht>0)&&Math.abs(ut)<=Math.abs(ht)},i.prototype.getBestAssetsByWidth=function(ut){var pt=ht.getWidthInPhysicalPixels(window),mt=ut[0].width,ft=ut[0].width-pt,gt=ft;return ut.forEach(function(ut){gt=ut.width-pt,this.isBetterWidthDifference(gt,ft)&&(mt=ut.width,ft=gt)}.bind(this)),ut.filter((function(ut){return ut.width===mt}))},i.prototype.getPreferredBitrateForDevice=function(ut){ut=ut||this.DEFAULT_BITRATES;var pt=Object.keys(ut).map((function(ut){return parseInt(ut,10)})),mt=ht.getWidthInPhysicalPixels(window),ft=pt[0],gt=pt[0]-mt,vt=gt;return pt.forEach((function(ut){vt=ut-mt,Math.abs(vt)<=Math.abs(gt)&&(ft=ut,gt=vt)})),1e3*ut[ft]},i.prototype.getBestAssetsByBitrate=function(ut,ht){var pt=this.getPreferredBitrateForDevice(ht),mt=ut[0].bitrate,ft=ut[0].bitrate-pt,gt=ft;return ut.forEach(function(ut){gt=ut.bitrate-pt,Math.abs(gt)<=Math.abs(ft)&&(mt=ut.bitrate,ft=gt)}.bind(this)),ut.filter((function(ut){return ut.bitrate===mt}))},i.prototype.getBestAssetsByFPS=function(ut,ht){var pt=ut[0].fps,mt=ut[0].fps-ht,ft=mt;return ut.forEach(function(ut){ft=ut.fps-ht,Math.abs(ft)<=Math.abs(mt)&&(pt=ut.fps,mt=ft)}.bind(this)),ut.filter((function(ut){return ut.fps===pt}))},i.prototype.getBestAsset=function(ut,ht,pt){if(ut&&ut.length){pt=pt||this.DEFAULT_FPS;var mt=this.getBestAssetsByWidth(ut);if(mt.length<=1)return mt[0];var ft=this.getBestAssetsByBitrate(mt,ht);return ft.length<=1?ft[0]:this.getBestAssetsByFPS(ft,pt)[0]}},i.prototype.getBestAssets=function(ut,ht,pt){var mt=this.getBestAssetsFromManifest(ht,pt);return-1!==pt.formats.indexOf("m3u8")&&this.addM3U8Asset(ut,mt),mt},i.prototype.getBestAssetsFromManifest=function(ut,ht){var pt=[];return ht.formats.forEach(function(mt){var ft=this.getBestAsset(this.getAssetsByFormat(ut,mt),ht.preferredBitrates,ht.preferredFPS);ft&&pt.push(ft)}.bind(this)),pt},i.prototype.addM3U8Asset=function(ut,ht){ht.push({src:ut+".m3u8",format:"m3u8",type:this.dataMapper.VIDEO_TYPE_FORMAT.m3u8})},i.prototype.hasAudio=function(ut){return ut.set.item.some(function(ut){return!!ut.userdata&&ut.userdata.some((function(ut){return!!ut.Audio_Codec}))}.bind(this))},i.prototype.getAssets=function(ut,ht,pt,mt){return isNaN(parseInt(ut,10))||(ut=this.scene7config.scene7videoServer+this.MANIFEST_PATH_PATTERN.replace("[productID]",ut)),this.dataProvider.getManifestData(ut).then(function(mt){var ft=this.dataMapper.map(mt),gt=this.getBestAssets(ut,ft,ht);gt.sort((function(ut,pt){return ht.formats.indexOf(ut.format)-ht.formats.indexOf(pt.format)}));var vt={assets:gt,hasAudio:this.hasAudio(mt)};return"function"==typeof pt&&pt(vt),vt}.bind(this)).fail((function(){"function"==typeof mt&&mt()}))},i})),define("videoPlayer/ViewModel",["ko"],(function(ut){return function e(ht,pt){this.events=ht,this.sources=ut.observableArray(),this.messages=pt,this.isErrorPageVisible=ut.observable(!1),this.isUnsupportedPageVisible=ut.observable(!1),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.closeButtonClicked=function(){this.events.trigger("closeButtonClicked")}.bind(this)}})),define("utils/fullScreenHelper",["$"],(function(ut){"use strict";var e=function(ut,ht){this.events=ut,this.fullscreenLauncherName=this.getFullscreenLauncherName(ht),this.fullscreenElementName=this.getFullscreenElementName(ht),this.fullscreenCancelName=this.getFullscreenCancelName(ht),this.elementStyle={position:null,top:null,left:null,width:null,height:null,backgroundColor:null,zIndex:null},this.setEventListeners(ht)};return e.prototype.getFullscreenLauncherName=function(ut){return ut.body.requestFullscreen?"requestFullscreen":ut.body.mozRequestFullScreen?"mozRequestFullScreen":ut.body.webkitRequestFullscreen?"webkitRequestFullscreen":ut.body.msRequestFullscreen?"msRequestFullscreen":null},e.prototype.getFullscreenCancelName=function(ut){return ut.exitFullscreen?"exitFullscreen":ut.mozCancelFullScreen?"mozCancelFullScreen":ut.webkitExitFullscreen?"webkitExitFullscreen":null},e.prototype.getFullscreenElementName=function(ut){return"fullscreenElement"in ut?"fullscreenElement":"webkitFullscreenElement"in ut?"webkitFullscreenElement":"msFullscreenElement"in ut?"msFullscreenElement":"mozFullScreenElement"in ut?"mozFullScreenElement":null},e.prototype.getNativeFullScreenElement=function(ut){return this.fullscreenElementName?ut[this.fullscreenElementName]:void 0},e.prototype.getFullScreenElement=function(ut){return this.fullscreenElement?this.fullscreenElement:this.getNativeFullScreenElement(ut)},e.prototype.launchIntoFullscreen=function(ut,ht){if(!this.getFullScreenElement(ut)){if(this.fullscreenLauncherName)return void ht[this.fullscreenLauncherName]();this.fullscreenElement=ht,this.onFullScreenChange(ut)}},e.prototype.exitFullScreen=function(ut,ht){if(!ht||!this.getNativeFullScreenElement(ut)||this.getNativeFullScreenElement(ut)===ht){if(this.fullscreenCancelName)return void(this.getNativeFullScreenElement(ut)&&ut[this.fullscreenCancelName]());if(this.fullscreenElement)try{var pt=this.fullscreenElement.parentNode,mt=this.fullscreenElement.nextSibling;pt.removeChild(this.fullscreenElement),pt.insertBefore(this.fullscreenElement,mt)}catch(ut){}finally{this.onFullScreenChange(ut)}}},e.prototype.onFullScreenChange=function(ut){return this.getFullScreenElement(ut)?void this.events.trigger("fullScreenEntered"):void this.events.trigger("fullScreenExited")},e.prototype.setEventListeners=function(ht){ut(ht).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",this.onFullScreenChange.bind(this,ht))},new e(ut({}),document)})),define("videoPlayer/Controller",["$","utils/fullScreenHelper"],(function(ut,ht){"use strict";var i=function(ht,pt,mt,ft,gt){this.loadedAssets=null,this.unmuteVideosWithAudio=!1,this.loadedSources=void 0,this.progressEvents={0:!1,25:!1,50:!1,75:!1,100:!1},this.assetsProvider=ht,this.events=ft,this.viewModel=mt,this.videoElement=gt,this.params={},this.isError=!1,ut.extend(!0,this.params,pt),this.setEventListeners()};return i.prototype.setEventListeners=function(){var pt=ut(this.videoElement);pt.on("timeupdate",function(){this.onVideoTimeUpdated(),this.videoElement.ended&&this.onVideoPlaybackEnded()}.bind(this)),pt.on("webkitendfullscreen",function(){this.onFullScreenExited()}.bind(this)),pt.on("error",function(ut){var ht=ut.target;if(ht===this.videoElement)this.onVideoError();else if("SOURCE"===ht.tagName){var pt=Array.prototype.indexOf.call(this.videoElement.querySelectorAll("source"),ht);this.onVideoSourceError(pt)}}.bind(this)),pt.on("canplay",function(){this.isError=!1}.bind(this)),this.viewModel.events.on("videoSourceError",function(ut){this.onVideoSourceError(ut.detail.sourceIndex)}.bind(this)),this.viewModel.events.on("refreshButtonClicked",function(){this.onRefreshButtonClicked()}.bind(this)),this.viewModel.events.on("closeButtonClicked",function(){this.onCloseButtonClicked()}.bind(this)),ht.events.on("fullScreenExited",function(){this.onFullScreenExited()}.bind(this)),ht.events.on("fullScreenEntered fullScreenExited",function(){this.onFullScreenChanged()}.bind(this))},i.prototype.onVideoPlaybackEnded=function(){--this.remainingLoopCount>0?(this.videoElement.currentTime=0,this.resetProgressEvents(),this.videoElement.play(),this.events.trigger("loopEnded")):(this.stop(),this.events.trigger("allLoopsEnded"))},i.prototype.onVideoTimeUpdated=function(){var ut=100*this.videoElement.currentTime/this.videoElement.duration;for(var pt in this.progressEvents){var mt=parseInt(pt,10);!this.progressEvents[pt]&&ut>=mt&&(this.progressEvents[pt]=!0,this.events.trigger("progress",{detail:{src:this.videoElement.currentSrc,value:mt,isFullScreen:ht.getFullScreenElement(document)===this.videoElement}}))}},i.prototype.onVideoError=function(){this.isError=!0,this.viewModel.isErrorPageVisible(!0),this.events.trigger("playbackError")},i.prototype.onVideoSourceError=function(ut){ut===this.viewModel.sources().length-1&&this.onVideoError()},i.prototype.onRefreshButtonClicked=function(){this.videoElement.load(),this.start()},i.prototype.onCloseButtonClicked=function(){this.events.trigger("playerExitRequested")},i.prototype.onFullScreenExited=function(){this.params.closeOnFullScreenExited&&this.events.trigger("playerExitRequested")},i.prototype.onFullScreenChanged=function(){if(!this.params.closeOnFullScreenExited&&4===this.videoElement.readyState){var ut=function(){this.videoElement.currentTime<1?(this.videoElement.currentTime+=1,this.videoElement.currentTime-=1):(this.videoElement.currentTime-=1,this.videoElement.currentTime+=1)}.bind(this);this.videoElement.paused?(this.videoElement.play(),ut(),this.videoElement.pause()):(ut(),this.videoElement.pause(),this.videoElement.play())}},i.prototype.hideInfoPages=function(){this.viewModel.isErrorPageVisible(!1)},i.prototype.start=function(ut){this.hideInfoPages(),this.resetProgressEvents(),this.play(this.params.initialLoopCount||1,this.params.startInFullScreen,ut)},i.prototype.play=function(ut,pt,mt){mt&&(this.setAssets(mt.assets),setTimeout(function(){this.videoElement.muted=!this.unmuteVideosWithAudio||!mt.hasAudio}.bind(this),0)),this.videoElement&&this.videoElement.play&&this.loadedAssets&&!this.viewModel.isUnsupportedPageVisible()&&((this.isError||JSON.stringify(this.loadedAssets)!==JSON.stringify(this.viewModel.sources()))&&(this.viewModel.sources(this.loadedAssets),this.videoElement.load()),this.remainingLoopCount=ut,this.videoElement.readyState>0&&(this.videoElement.currentTime=0),pt&&ht.launchIntoFullscreen(document,this.videoElement,!0),this.videoElement.play())},i.prototype.stop=function(){this.videoElement&&this.videoElement.pause&&(ht.exitFullScreen(document,this.videoElement,!0),this.videoElement.pause(),this.videoElement.readyState>0&&(this.videoElement.currentTime=0))},i.prototype.resetProgressEvents=function(){for(var ut in this.progressEvents)this.progressEvents[ut]=!1},i.prototype.hasSupportedAssets=function(ut){var ht=document.createElement("video");return!(!ut||!ht.canPlayType)&&ut.filter((function(ut){return""!==ht.canPlayType(ut.type)})).length>0},i.prototype.setAssets=function(ut,ht){this.loadedAssets=ut,this.viewModel.isUnsupportedPageVisible(!this.hasSupportedAssets(this.loadedAssets))},i.prototype.loadAssets=function(ut,ht,pt,mt){this.loadedAssets=null,this.assetsProvider.getAssets(ut,ht,function(ut){var ht=ut.assets;ht&&ht.length>0?(this.setAssets(ht),"function"==typeof pt&&pt()):"function"==typeof mt&&mt()}.bind(this),(function(){"function"==typeof mt&&mt()}))},i})),define("videoPlayer/component",["ko","$","videoPlayerView","utils/scene7.config","utils/scene7.DataProvider","videoPlayer/DataMapper","videoPlayer/AssetsProvider","videoPlayer/ViewModel","videoPlayer/Controller"],(function(ut,ht,pt,mt,ft,gt,vt,bt,yt){"use strict";return{viewModel:{createViewModel:function(ut,pt){var St=ht({}),wt=ht({}),xt=pt.element.querySelector(".asos-media-players .amp-video-player .amp-video-element");ut.messages&&ut.messages.unsupportedHeaderText&&(ut.messages.unsupportedHeaderText=ut.messages.unsupportedHeaderText.replace("[BrowserName]","Your browser"));var It=new bt(St,ut.messages),Pt=new mt(ut.scene7.imageServer,ut.scene7.videoServer),Tt=new ft(Pt),zt=new gt(Pt),Ct=new vt(Pt,Tt,zt),Et=new yt(Ct,ut.player,It,wt,xt),kt={start:Et.start.bind(Et),stop:Et.stop.bind(Et),loadAssets:Et.loadAssets.bind(Et),events:Et.events};return ut.api(kt),It}},template:pt,synchronous:!0}})),define("spinViewerView",[],(function(){return'<div class="asos-media-players amp-relative">\r\n    <div class="amp-spin-viewer amp-relative" data-bind=\'css: { "pannable": isPannable() }\'>\r\n        <div class="amp-spinner amp-relative">\r\n            <div class="amp-page amp-spin">\r\n                <div class="amp-page amp-hint" data-bind="fadeVisible: isHintVisible">\r\n                    <div class="amp-hint-container">\r\n                        <div class="amp-hint-gesture amp-first">\r\n                            <div class="amp-hint-gesture-img sprite drag"></div>\r\n                        </div>\r\n                        <div class="amp-clear"></div>\r\n                        <div class="amp-hint-gesture amp-first">\r\n                            <span data-bind="text: messages.hintDragText"></span>\r\n                        </div>\r\n                        <div class="amp-clear"></div>\r\n                    </div>\r\n                </div>\r\n                <div class="amp-page amp-overlay"></div>\r\n                \x3c!-- ko if: !touchDevice --\x3e\r\n                <span class="sr-only" aria-live="polite" data-bind="text: zoomLevelText"></span>\r\n                <button class="amp-zoom" data-bind="attr: { \'aria-describedby\': hintId }, click: handleClick, event: { keydown: handleKeyDown, keyup: handleKeyUp, blur: handleOnBlur, focus: handleOnFocus }, clickBubble: false">\r\n                    <span class="sprite" data-bind="css: { zoomPlus: zoomPlus, zoomMinus: zoomMinus }"></span>\r\n                </button>\r\n                <p class="zoom-hint" data-bind="text: messages.zoomHint, css: { showHint: showHint }, attr: { id: hintId }" aria-hidden="true"></p>\r\n                \x3c!-- /ko --\x3e\r\n                <div class="amp-page amp-images"></div>\r\n            </div>\r\n            <div class="amp-page amp-loading" data-bind="visible: isLoadingPageVisible">\r\n                <div class="amp-loading-img"></div>\r\n                <span data-bind="text: loadingPercentage() + \'%\'"></span>\r\n            </div>\r\n            <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\r\n                <div class="amp-message-container">\r\n                    <div class="amp-message-box">\r\n                        <h2 data-bind="html: messages.errorHeaderText"></h2>\r\n                        <p data-bind="html: messages.spinsetErrorMessageText"></p>\r\n                        <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>                '})),define("utils/sizeHelper",[],(function(){"use strict";function t(){}return t.prototype.getProportionalSize=function(ut,ht){var pt={width:ut.width,height:ut.height},mt=ht.width/ht.height,ft=ut.width/ut.height;return ft>mt?pt.width=pt.height*mt:mt>ft&&(pt.height=pt.width/mt),pt.width=Math.round(pt.width),pt.height=Math.round(pt.height),pt},t.prototype.resizeCanvas=function(ut,ht){var pt=document.createElement("canvas");pt.width=ht.width,pt.height=ht.height,pt.getContext("2d").drawImage(ut,0,0,ht.width,ht.height),ut.width=ht.width,ut.height=ht.height,ut.getContext("2d").drawImage(pt,0,0)},new t})),define("utils/imageProvider",["$"],(function(ut){"use strict";var e=function(){};return e.prototype.setImage=function(ht,pt,mt,ft,gt,vt){if(gt&&ut.support.cors)return pt.onload=mt,ut.ajax(ht,{success:function(ut){pt.src=ht},error:ft,cache:!vt});if(vt)ht+="&"+(new Date).getTime();else if(pt.complete&&pt.src===ht)return"function"==typeof mt&&mt(),null;return pt.onload=mt,pt.onerror=ft,pt.src=ht,null},new e})),define("utils/scene7.ImageLoader",["$","utils/sizeHelper","utils/imageProvider"],(function(ut,ht,pt){"use strict";var n=function(ut,ht){this.urlQueryStringPattern="wid=[width]&hei=[height]&size=[width],[height]&rect=[startH],[startW],[lengthH],[lengthW]&qlt=[qlt]",this.scene7Config=ut,this.canUseCanvas=document.createElement("canvas").getContext,this.useCors=ht,this.loadRequests=[]};return n.prototype.getPartitionFactors=function(ut,ht){return{horizontal:Math.max(Math.ceil(ut.width/this.scene7Config.maxImageSize.width),ht?this.scene7Config.imageMinPartitionFactors.horizontal:1),vertical:Math.max(Math.ceil(ut.height/this.scene7Config.maxImageSize.height),ht?this.scene7Config.imageMinPartitionFactors.vertical:1)}},n.prototype.getTile=function(ut,ht,mt,ft,gt,vt,bt,yt,St){var wt=new Image,xt=this.getTileUrl(ht,mt,ft,gt,vt,bt);return{xhr:pt.setImage(xt,wt,function(){wt.onload=null,this.loadRequests[ut].isActive&&"function"==typeof yt&&yt(wt)}.bind(this),function(){wt.onload=null,this.loadRequests[ut].isActive&&"function"==typeof St&&St()}.bind(this),this.useCors),image:wt}},n.prototype.addTile=function(ut,ht,pt,mt,ft,gt,vt,bt,yt,St,wt){this.loadRequests[ut].isActive&&this.loadRequests[ut].tiles.push(this.getTile(ut,pt,mt,gt,vt,bt,yt,function(pt){if(this.loadRequests[ut].isActive){var mt=(this.getTileBox(ft,gt,vt,bt),ht.querySelector('.tile[data-tile-hp="'+gt+'" ][data-tile-vp="'+vt+'"]')),yt=mt.querySelector("img");yt||((yt=new Image).style.width="100%",yt.style.height="100%",mt.appendChild(yt)),yt.src=pt.src,"function"==typeof St&&St()}}.bind(this),wt))},n.prototype.addTiles=function(ut,ht,pt,mt,ft,gt,vt,bt,yt,St){var wt=ut.length,u=function(){0===--wt&&"function"==typeof yt&&yt()};0===wt&&"function"==typeof yt&&yt();for(var xt=0;xt<ut.length;xt++)this.addTile(ht,pt,mt,ft,gt,ut[xt].horizontal,ut[xt].vertical,vt,bt,u,St)},n.prototype.loadFullImage=function(ut,mt,ft,gt,vt,bt,yt,St,wt){(gt.width>this.scene7Config.maxImageSize.width||gt.height>this.scene7Config.maxImageSize.height)&&(gt=ht.getProportionalSize(this.scene7Config.maxImageSize,gt));var xt=ft.querySelector(".fullImageContainer"),It=ft.querySelector(".partitionedImageContainer"),Pt=ft.querySelector(".fullImageContainer img"),Tt=!1;xt||((xt=document.createElement("div")).className="fullImageContainer",ft.insertBefore(xt,ft.firstChild)),Pt?Tt=!Pt.complete:((Pt=new Image).className="img",Pt.style.width="100%",Pt.style.height="100%",xt.appendChild(Pt)),xt.style.width=Math.floor(vt.width)+"px",xt.style.height=Math.floor(vt.height)+"px",yt&&(xt.style.position=yt.position,xt.style.top=yt.top,xt.style.left=yt.left),xt.setAttribute("data-url",mt),xt.setAttribute("data-target-qlt",bt),xt.setAttribute("data-target-width",Math.floor(gt.width)),xt.setAttribute("data-target-height",Math.floor(gt.height)),xt.setAttribute("data-output-width",Math.floor(vt.width)),xt.setAttribute("data-output-height",Math.floor(vt.height));var zt=this.getTileUrl(mt,gt,0,0,{vertical:1,horizontal:1},bt),Ct=pt.setImage(zt,Pt,function(){if(Pt.onload=null,this.loadRequests[ut].isActive){if(It)for(;It.lastChild;)It.removeChild(It.lastChild);"function"==typeof St&&St()}}.bind(this),function(){Pt.onload=null,this.loadRequests[ut].isActive&&"function"==typeof wt&&wt()}.bind(this),this.useCors,Tt);this.loadRequests[ut].tiles.push({image:Pt,xhr:Ct})},n.prototype.loadImageToContainer=function(ut,ht,pt,mt,ft,gt,vt,bt,yt,St,wt){vt=vt||{x:pt.width/2,y:pt.height/2},St=St||"";var xt,It,Pt=this.getPartitionFactors(pt,yt),Tt=(Pt.horizontal,Pt.vertical,{topLeft:{x:0,y:0},bottomRight:{x:mt.width-1,y:mt.height-1}}),zt=this.getTileDataForPoint(vt,mt,Pt),Ct=this.loadRequests.push({isActive:!0,tiles:[]})-1,Et=function(){this.addTiles([zt],Ct,kt,ut,pt,mt,Pt,St,function(){return!!this.loadRequests[Ct].isActive&&void this.addTiles(xt,Ct,kt,ut,pt,mt,Pt,St,function(){return!!this.loadRequests[Ct].isActive&&void this.addTiles(It,Ct,kt,ut,pt,mt,Pt,St,function(){this.loadRequests[Ct].isActive=!1,"function"==typeof ft&&ft()}.bind(this),function(){return!!this.loadRequests[Ct].isActive&&void("function"==typeof gt&&gt())}.bind(this))}.bind(this),function(){return!!this.loadRequests[Ct].isActive&&void("function"==typeof gt&&gt())}.bind(this))}.bind(this),function(){return!!this.loadRequests[Ct].isActive&&void("function"==typeof gt&&gt())}.bind(this))}.bind(this);if((bt=bt||Tt).topLeft.x=Math.max(Math.min(bt.topLeft.x,Tt.bottomRight.x),Tt.topLeft.x),bt.topLeft.y=Math.max(Math.min(bt.topLeft.y,Tt.bottomRight.y),Tt.topLeft.y),bt.bottomRight.x=Math.max(Math.min(bt.bottomRight.x,Tt.bottomRight.x),bt.topLeft.x),bt.bottomRight.y=Math.max(Math.min(bt.bottomRight.y,Tt.bottomRight.y),bt.topLeft.y),xt=this.getTilesDataForArea(bt,mt,[zt],zt,Pt),It=this.getTilesDataForArea(Tt,mt,[zt].concat(xt),zt,Pt),!this.canUseCanvas||1===Pt.vertical&&1===Pt.horizontal)this.loadFullImage(Ct,ut,ht,pt,mt,St,wt,ft,gt);else{var kt=ht.querySelector(".partitionedImageContainer");if(!kt){(kt=document.createElement("div")).className="partitionedImageContainer",kt.style.width=mt.width+"px",kt.style.height=mt.height+"px",kt.setAttribute("aria-hidden","true"),wt&&(kt.style.position=wt.position,kt.style.top=wt.top,kt.style.left=wt.left);for(var At=0;At<Pt.vertical;At++)for(var Vt=0;Vt<Pt.horizontal;Vt++){var _t=document.createElement("div");_t.className="tile",_t.style.float="left",_t.style.width=100/Pt.horizontal+"%",_t.style.height=100/Pt.vertical+"%",_t.setAttribute("data-tile-hp",Vt),_t.setAttribute("data-tile-vp",At),kt.appendChild(_t)}ht.appendChild(kt)}Et()}return Ct},n.prototype.getTilesDataForArea=function(ut,ht,pt,mt,ft){pt=pt||[],mt=mt||{horizontal:0,vertical:0};for(var gt=this.getTileDataForPoint(ut.topLeft,ht,ft),vt=this.getTileDataForPoint(ut.bottomRight,ht,ft),bt=[],c=function(ut){return ut.horizontal===yt&&ut.vertical===St},yt=gt.horizontal;yt<=vt.horizontal;yt++)for(var St=gt.vertical;St<=vt.vertical;St++)0===pt.filter(c).length&&bt.push({horizontal:yt,vertical:St});return bt.sort((function(ut,ht){return Math.sqrt(Math.pow(ut.horizontal-mt.horizontal,2)+Math.pow(ut.vertical-mt.vertical))>Math.sqrt(Math.pow(ht.horizontal-mt.horizontal,2)+Math.pow(ht.vertical-mt.vertical))?1:-1})),bt},n.prototype.getTileDataForPoint=function(ut,ht,pt){for(var mt,ft={horizontal:null,vertical:null},gt=0;gt<pt.horizontal&&null===ft.horizontal;gt++)mt=this.getTileBox(ht,gt,0,pt),ut.x>=mt.left&&ut.x<mt.left+mt.width&&(ft.horizontal=gt);for(var vt=0;vt<pt.vertical&&null===ft.vertical;vt++)mt=this.getTileBox(ht,0,vt,pt),ut.y>=mt.top&&ut.y<mt.top+mt.height&&(ft.vertical=vt);return ft},n.prototype.getTileBox=function(ut,ht,pt,mt){var ft=this.getPartPosition(ht,ut.width,mt.horizontal),gt=this.getPartPosition(pt,ut.height,mt.vertical);return{left:ft,top:gt,width:this.getPartPosition(ht+1,ut.width,mt.horizontal)-ft,height:this.getPartPosition(pt+1,ut.height,mt.vertical)-gt}},n.prototype.getPartPosition=function(ut,ht,pt){return Math.floor(ht*ut/pt)},n.prototype.getTileUrl=function(ut,ht,pt,mt,ft,gt){var vt=this.getTileBox(ht,pt,mt,ft),bt=ut.indexOf("?")>-1?"&":"?";return(ut+bt+this.urlQueryStringPattern).replace(/\[width\]/g,Math.floor(ht.width)).replace(/\[height\]/g,Math.floor(ht.height)).replace("[startH]",Math.floor(vt.left)).replace("[startW]",Math.floor(vt.top)).replace("[lengthH]",Math.floor(vt.width)).replace("[lengthW]",Math.floor(vt.height)).replace("[qlt]",gt)},n.prototype.cancelAllLoadRequests=function(){for(var ut=0;ut<this.loadRequests.length;ut++)this.cancelLoadRequest(ut)},n.prototype.cancelLoadRequest=function(ut){if("number"==typeof ut&&ut<this.loadRequests.length&&this.loadRequests[ut].isActive){var ht=this.loadRequests[ut];if(ht.isActive=!1,ht.tiles.length)for(var pt=ht.tiles[0].image.src,mt=ht.tiles.pop();mt;)mt.xhr?mt.xhr.abort():(mt.image.onload=null,mt.image.src=pt),mt=ht.tiles.pop()}},n})),define("spinViewer/DataProvider",[],(function(){"use strict";var t=function(ut,ht){this.scene7config=ut,this.scene7dataProvider=ht};return t.prototype.mapManifestData=function(ut){var ht={frameUrls:[],maxSize:{width:0,height:0}};if(ut.set.item.length>0){var pt=ut.set.item[0].set?ut.set.item.length:1;if(1===pt)ht.frameUrls[0]=ut.set.item.map(function(ut){return this.scene7config.imageUrlPattern.replace("[assetID]",ut.i.n)}.bind(this)),ht.maxSize.width=parseInt(ut.set.item[0].dx,10),ht.maxSize.height=parseInt(ut.set.item[0].dy,10);else{ut.set.item[0].set.item.length>0&&(ht.maxSize.width=parseInt(ut.set.item[0].set.item[0].dx,10),ht.maxSize.height=parseInt(ut.set.item[0].set.item[0].dy,10));for(var mt=0;pt>mt;mt++)ht.frameUrls[mt]=ut.set.item[mt].set.item.map(function(ut){return this.scene7config.imageUrlPattern.replace("[assetID]",ut.i.n)}.bind(this))}}return ht},t.prototype.getSpinsetDataForImageUrls=function(ut,ht,pt){for(var mt,ft="[baseUrl]?imageset={[imageSet]}&req=set,json",gt=[],vt=0;vt<ut.length;vt++)mt=ut[vt].split("?").shift(),ft=ft.replace("[baseUrl]",mt),gt.push(mt.split("/").pop());return ft=ft.replace("[imageSet]",gt.join(",")),this.scene7dataProvider.getManifestData(ft).then(function(ut){var pt=[];for(Array.isArray(ut.set.item)||(ut.set.item=[ut.set.item]),vt=0;vt<ut.set.item.length;vt++)pt.push(this.mapManifestData({set:{item:[ut.set.item[vt]]}}));return"function"==typeof ht&&ht(pt),pt}.bind(this)).fail((function(){"function"==typeof pt&&pt()}))},t.prototype.getSpinsetDataForImageUrl=function(ut,ht,pt){var mt=(ut=ut.split("?").shift())+"?req=set,json";return this.scene7dataProvider.getManifestData(mt).then(function(ut){return ut.set.item=[ut.set.item],"function"==typeof ht&&ht(ut),ut}.bind(this)).fail((function(){"function"==typeof pt&&pt()}))},t.prototype.getSpinsetDataForProduct=function(ut,ht,pt){var mt=this.scene7config.spinsetManifestFileUrlPattern.replace("[productID]",ut);return this.scene7dataProvider.getManifestData(mt).then(function(ut){var pt=this.mapManifestData(ut);return"function"==typeof ht&&ht(pt),pt}.bind(this)).fail((function(){"function"==typeof pt&&pt()}))},t})),define("spinViewer/AssetsProvider",[],(function(){"use strict";var t=function(ut){this.dataProvider=ut};return t.prototype.getAssets=function(ut,ht,pt){Array.isArray(ut)?this.dataProvider.getSpinsetDataForImageUrls(ut,ht,pt):isNaN(ut)?this.dataProvider.getSpinsetDataForImageUrl(ut,ht,pt):this.dataProvider.getSpinsetDataForProduct(ut,ht,pt)},t})),define("spinViewer/ViewModel",["ko"],(function(ut){return function e(ht,pt){function n(){return Object.keys(ft).filter((function(ut){return ft[ut]}))}function r(ut){Object.keys(ft).forEach((function(ht){ut!==ht&&-1!==gt.indexOf(ht)&&(ft[ht]=!1)}))}var mt,ft={};this.touchDevice="ontouchstart"in document.documentElement,this.events=ht,this.messages=pt,this.isPannable=ut.observable(!1),this.isLoadingPageVisible=ut.observable(!1),this.loadingPercentage=ut.observable(0),this.isErrorPageVisible=ut.observable(!1),this.isHintVisible=ut.observable(!1),this.zoomPlus=ut.observable(!0),this.zoomMinus=ut.observable(!1),this.showHint=ut.observable(!1),this.zoomLevelText=ut.observable(""),this.zoomLevel=ut.observable(0),this.updateLiveRegion=function(ut){clearTimeout(mt),this.zoomLevelText(ut),mt=setTimeout(function(){this.zoomLevelText("")}.bind(this),1e3)}.bind(this),this.hintId=Math.random().toString(36).substring(7),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.handleOnFocus=function(){this.showHint(!0)}.bind(this),this.handleOnBlur=function(){this.showHint(!1)}.bind(this),this.handleClick=function(){this.events.trigger("zoomCenter")}.bind(this);var gt=["arrowleft","arrowright","arrowup","arrowdown","a","d","w","s"];this.handleKeyDown=function(ut,ht){var pt=ht.key.toLowerCase();if(ft[pt]=!0,-1===gt.indexOf(pt))return!0;var mt=n().filter((function(ut){return-1===gt.indexOf(ut)}));mt.length>0&&r(pt);var vt=function s(){return n().filter((function(ut){return-1!==gt.indexOf(ut)}))}().join(",");this.events.trigger("panImage",vt)},this.handleKeyUp=function(ut,ht){var pt=ht.key.toLowerCase();return ft[pt]=!1,-1!==gt.indexOf(pt)&&r(),!0},this.touchDevice||(this.events.on("canZoomIn",function(){this.zoomPlus(!0),this.zoomMinus(!1),0===this.zoomLevel()?(this.updateLiveRegion(pt.zoomTwoHundred),this.zoomLevel(200)):(this.updateLiveRegion(pt.zoomOneHundred),this.zoomLevel(0))}.bind(this)),this.events.on("cantZoomIn",function(){this.zoomPlus(!1),this.zoomMinus(!0),this.updateLiveRegion(pt.zoomFourHundred),this.zoomLevel(400)}.bind(this)))}})),define("utils/ImageScaler",["$"],(function(ut){"use strict";var e=function(ht){this.options={},ut.extend(!0,this.options,ht)};return e.prototype.getScaledImageSize=function(ut){return{width:this.getScaledImageLength(this.options.baseSize.width,this.options.maxSize.width,ut),height:this.getScaledImageLength(this.options.baseSize.height,this.options.maxSize.height,ut)}},e.prototype.getScaledImageLength=function(ut,ht,pt){return pt?Math.pow(Math.pow(ut,1/pt)*ht/ut,pt):ut},e})),define("utils/ImageZoomer",["ko","$","utils/sizeHelper"],(function(ut,ht,pt){"use strict";var n=function(pt,mt,ft,gt){this.events=ht({}),this.imageLoader=pt,this.inputImageScaler=mt,this.outputImageScaler=ft,this.currentLevel=ut.observable(0),this.options={},ht.extend(!0,this.options,gt),this.options.zoomFactors=[0].concat(this.options.zoomFactors),this.updateCanZoomDummy=ut.observable(!1),this.currLoadRequestId=null,this.currentPosition={x:0,y:0},this.currentSize={width:0,height:0},this.canZoomIn=ut.computed(this.canZoomIn,this),this.canZoomOut=ut.computed(this.canZoomOut,this),this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded};return n.prototype.FULL_IMAGE_STATUS={NotLoaded:0,Loaded:2},n.prototype.init=function(){var ut=ht(this.options.container);this.containerSize={width:this.options.containerSize?this.options.containerSize.width:ut.width(),height:this.options.containerSize?this.options.containerSize.height:ut.height()},this.currentSize=this.getOutputImageSize(this.currentLevel()),this.currentPosition=this.getSanitizedPosition(this.currentPosition,this.currentSize),this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy())},n.prototype.getNextClosestLevel=function(ut){for(var ht=0,pt=0;pt<=this.options.zoomFactors.length;){var mt=this.currentSize,ft=this.getOutputImageSize(pt);if(ut&&(mt.width===ft.width||mt.height===ft.height)){ht=pt;break}if(mt.width<ft.width||mt.height<ft.height){ht=pt;break}pt++}return ht},n.prototype.resize=function(ut,ht,pt){var mt=this.getNextClosestLevel(!0);this.options.containerSize=ht.containerSize,this.options.outputBaseSize=ht.outputBaseSize,this.outputImageScaler.options.baseSize=ht.imageScalersOptions.outputImageScalerOptions.baseSize,this.outputImageScaler.options.maxSize=ht.imageScalersOptions.outputImageScalerOptions.maxSize,this.init(),ut&&this.zoom((function(){return mt}),null,pt)},n.prototype.canZoomIn=function(){this.updateCanZoomDummy();var ut=this.currentSize,ht=this.getOutputImageSize(this.options.zoomFactors.length-1);return ut.width<ht.width||ut.height<ht.height},n.prototype.canZoomOut=function(){this.updateCanZoomDummy();var ut=this.getOutputImageSize(0),ht=this.currentSize;return ut.width<ht.width||ut.height<ht.height},n.prototype.zoomIn=function(ut,ht,pt){return this.canZoomIn()?void this.zoom(this.getNextClosestLevel.bind(this,!1),ht,pt):ut?void this.zoomReset(pt):void("function"==typeof pt&&pt())},n.prototype.zoomOut=function(ut,ht){return this.canZoomOut()?void this.zoom(function(){return this.currentLevel()-1}.bind(this),ut,ht):void("function"==typeof ht&&ht())},n.prototype.zoomReset=function(ut,ht){if(ht){var pt=this.getOutputImageSize(0),mt=this.getZoomedImageBox(this.currentSize,this.currentPosition,pt);return this.currentSize=mt.size,this.currentPosition=mt.position,this.applyPosition(!0),this.currentLevel(0),void("function"==typeof ut&&setTimeout(ut,0))}this.zoom(function(){return 0}.bind(this),void 0,ut)},n.prototype.loadImage=function(ut,ht,pt,mt,ft,gt,vt,bt,yt,St,wt){ut&&(this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.currLoadRequestId=this.imageLoader.loadImageToContainer(ut,ht,pt,mt,function(){this.currLoadRequestId=null,"function"==typeof ft&&setTimeout(ft,0)}.bind(this),gt,vt,bt,yt,St,wt))},n.prototype.zoom=function(ut,ht,pt,mt){this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.fullImageStatus!==this.FULL_IMAGE_STATUS.Loaded&&(this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded);var ft=ut(),gt=(this.getInputImageSize(ft),this.getOutputImageSize(ft)),vt=this.getZoomedImageBox(this.currentSize,this.currentPosition,gt,ht),bt=ft>0;this.currentSize=vt.size,this.currentPosition=vt.position,this.applyPosition(!0),this.fullImageStatus===this.FULL_IMAGE_STATUS.NotLoaded&&bt&&(this.loadImage(this.options.baseUrl,this.options.container,this.getInputImageSize(this.options.zoomFactors.length-1),this.currentSize,function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.Loaded,this.applyPosition(),"function"==typeof pt&&pt()}.bind(this),function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded,"function"==typeof mt&&mt()}.bind(this),vt.focalPointOnSourceImage,this.getVisibleArea(vt.position),!0,this.options.zoomJpgQlt,{position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px"}),this.applyPosition(!0)),this.currentLevel(ft),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},n.prototype.getVisibleArea=function(ut){return{topLeft:{x:-ut.x,y:-ut.y},bottomRight:{x:this.containerSize.width-ut.x,y:this.containerSize.height-ut.y}}},n.prototype.getZoomedImageBox=function(ut,ht,pt,mt){mt||(mt={x:this.containerSize.width/2,y:this.containerSize.height/2}),mt=this.getSanitizedPointOnImage(mt,ut);var ft=this.getPointOnOutputImageFromContainer(mt,ut),gt=pt.width-ut.width,vt=pt.height-ut.height,bt=pt.width/ut.width,yt={x:ft.x*bt,y:ft.y*bt},St=gt*(ft.x/ut.width),wt=vt*(ft.y/ut.height);return{size:pt,position:this.getSanitizedPosition({x:ht.x-St,y:ht.y-wt},pt),focalPointOnSourceImage:yt}},n.prototype.moveBy=function(ut){this.canZoomOut()&&(ut.x||ut.y)&&(this.currentPosition=this.getSanitizedPosition({x:this.currentPosition.x+ut.x,y:this.currentPosition.y+ut.y},this.currentSize),this.applyPosition())},n.prototype.applyPosition=function(ut){var pt=ht(this.options.container),mt=Math.floor(this.currentSize.width),ft=Math.floor(this.currentSize.height),gt=pt.find(".fullImageContainer, .partitionedImageContainer");gt.css({position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px",width:mt+"px",height:ft+"px"}),gt.attr({"data-output-width":mt,"data-output-height":ft})},n.prototype.getInputImageSize=function(ut){var ht=this.options.zoomFactors[ut],pt=this.inputImageScaler.getScaledImageSize(ht);return pt.width<this.options.outputBaseSize.width||pt.height<this.options.outputBaseSize.height?this.options.outputBaseSize:pt},n.prototype.getOutputImageSize=function(ut){if(0===ut)return this.options.outputBaseSize;var ht=this.options.zoomFactors[ut],pt=this.outputImageScaler.getScaledImageSize(ht);return pt.width<this.options.outputBaseSize.width||pt.height<this.options.outputBaseSize.height?this.options.outputBaseSize:pt},n.prototype.setPlaceholderImage=function(ut){var pt=(this.getInputImageSize(0),this.getOutputImageSize(0)),mt=this.getZoomedImageBox(this.currentSize,this.currentPosition,pt);this.currentSize=mt.size,this.currentPosition=mt.position;var ft=ht(this.options.container).children(),gt=document.createElement("div");gt.className="fullImageContainer",ut.className="img",ut.style.width="100%",ut.style.height="100%",gt.appendChild(ut),this.options.container.appendChild(gt),this.applyPosition(!0),ft.remove()},n.prototype.getBezel=function(ut){return{horizontal:Math.max(this.containerSize.width-Math.floor(ut.width),0)/2,vertical:Math.max(this.containerSize.height-Math.floor(ut.height),0)/2}},n.prototype.getSanitizedPosition=function(ut,ht){var pt=this.getBezel(ht),mt={x:Math.floor(ut.x),y:Math.floor(ut.y)};return mt.x=Math.min(mt.x,pt.horizontal),mt.y=Math.min(mt.y,pt.vertical),mt.x=Math.max(mt.x,this.containerSize.width-Math.floor(ht.width)-pt.horizontal),mt.y=Math.max(mt.y,this.containerSize.height-Math.floor(ht.height)-pt.vertical),mt},n.prototype.getSanitizedPointOnImage=function(ut,ht){var pt=this.getBezel(ht),mt={x:ut.x,y:ut.y};return mt.x=Math.max(mt.x,pt.horizontal),mt.y=Math.max(mt.y,pt.vertical),mt.x=Math.min(mt.x,this.containerSize.width-pt.horizontal),mt.y=Math.min(mt.y,this.containerSize.height-pt.vertical),mt},n.prototype.getPointOnOutputImageFromContainer=function(ut){return{x:ut.x-this.currentPosition.x,y:ut.y-this.currentPosition.y}},n.prototype.getCurrentImageDisplaySize=function(){return this.currentSize},n.prototype.scale=function(ut,ht,pt,mt){pt||(pt={x:0,y:0});var ft={width:Math.max(ut.width*ht,this.options.outputBaseSize.width),height:Math.max(ut.height*ht,this.options.outputBaseSize.height)};if(!mt){var gt=this.getOutputImageSize(this.options.zoomFactors.length-1);ft.width=Math.min(gt.width,ft.width),ft.height=Math.min(gt.height,ft.height)}var vt=this.getZoomedImageBox(this.currentSize,this.currentPosition,ft,pt);this.currentPosition=vt.position,this.currentSize=vt.size,this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},n.prototype.setPartitionedImageVisibility=function(){return this.options.container.querySelector(".partitionedImageContainer")?this.currentSize.width===this.options.outputBaseSize.width?void(this.options.container.querySelector(".partitionedImageContainer").style.display="none"):void(this.options.container.querySelector(".partitionedImageContainer").style.display="block"):void 0},n})),function(ut,ht,pt,mt){"use strict";function s(ut,ht,pt){return setTimeout(l(ut,pt),ht)}function r(ut,ht,pt){return!!Array.isArray(ut)&&(o(ut,pt[ht],pt),!0)}function o(ut,ht,pt){var ft;if(ut)if(ut.forEach)ut.forEach(ht,pt);else if(ut.length!==mt)for(ft=0;ft<ut.length;)ht.call(pt,ut[ft],ft,ut),ft++;else for(ft in ut)ut.hasOwnProperty(ft)&&ht.call(pt,ut[ft],ft,ut)}function a(ht,pt,mt){var ft="DEPRECATED METHOD: "+pt+"\n"+mt+" AT \n";return function(){var pt=new Error("get-stack-trace"),mt=pt&&pt.stack?pt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",gt=ut.console&&(ut.console.warn||ut.console.log);return gt&&gt.call(ut.console,ft,mt),ht.apply(this,arguments)}}function c(ut,ht,pt){var mt,gt=ht.prototype;(mt=ut.prototype=Object.create(gt)).constructor=ut,mt._super=gt,pt&&ft(mt,pt)}function l(ut,ht){return function(){return ut.apply(ht,arguments)}}function d(ut,ht){return typeof ut==bt?ut.apply(ht&&ht[0]||mt,ht):ut}function u(ut,ht){return ut===mt?ht:ut}function h(ut,ht,pt){o(g(ht),(function(ht){ut.addEventListener(ht,pt,!1)}))}function p(ut,ht,pt){o(g(ht),(function(ht){ut.removeEventListener(ht,pt,!1)}))}function m(ut,ht){for(;ut;){if(ut==ht)return!0;ut=ut.parentNode}return!1}function f(ut,ht){return ut.indexOf(ht)>-1}function g(ut){return ut.trim().split(/\s+/g)}function v(ut,ht,pt){if(ut.indexOf&&!pt)return ut.indexOf(ht);for(var mt=0;mt<ut.length;){if(pt&&ut[mt][pt]==ht||!pt&&ut[mt]===ht)return mt;mt++}return-1}function b(ut){return Array.prototype.slice.call(ut,0)}function y(ut,ht,pt){for(var mt=[],ft=[],gt=0;gt<ut.length;){var vt=ht?ut[gt][ht]:ut[gt];v(ft,vt)<0&&mt.push(ut[gt]),ft[gt]=vt,gt++}return pt&&(mt=ht?mt.sort((function(ut,pt){return ut[ht]>pt[ht]})):mt.sort()),mt}function S(ut,ht){for(var pt,ft,vt=ht[0].toUpperCase()+ht.slice(1),bt=0;bt<gt.length;){if((ft=(pt=gt[bt])?pt+vt:ht)in ut)return ft;bt++}return mt}function I(ht){var pt=ht.ownerDocument||ht;return pt.defaultView||pt.parentWindow||ut}function P(ut,ht){var pt=this;this.manager=ut,this.callback=ht,this.element=ut.element,this.target=ut.options.inputTarget,this.domHandler=function(ht){d(ut.options.enable,[ut])&&pt.handler(ht)},this.init()}function T(ut,ht,pt){var mt=pt.pointers.length,ft=pt.changedPointers.length,gt=ht&Vt&&mt-ft==0,vt=ht&(Mt|Lt)&&mt-ft==0;pt.isFirst=!!gt,pt.isFinal=!!vt,gt&&(ut.session={}),pt.eventType=ht,function z(ut,ht){var pt=ut.session,mt=ht.pointers,ft=mt.length;pt.firstInput||(pt.firstInput=k(ht)),ft>1&&!pt.firstMultiple?pt.firstMultiple=k(ht):1===ft&&(pt.firstMultiple=!1);var gt=pt.firstInput,vt=pt.firstMultiple,bt=vt?vt.center:gt.center,yt=ht.center=A(mt);ht.timeStamp=wt(),ht.deltaTime=ht.timeStamp-gt.timeStamp,ht.angle=L(bt,yt),ht.distance=M(bt,yt),function C(ut,ht){var pt=ht.center,mt=ut.offsetDelta||{},ft=ut.prevDelta||{},gt=ut.prevInput||{};ht.eventType!==Vt&&gt.eventType!==Mt||(ft=ut.prevDelta={x:gt.deltaX||0,y:gt.deltaY||0},mt=ut.offsetDelta={x:pt.x,y:pt.y}),ht.deltaX=ft.x+(pt.x-mt.x),ht.deltaY=ft.y+(pt.y-mt.y)}(pt,ht),ht.offsetDirection=_(ht.deltaX,ht.deltaY);var xt=V(ht.deltaTime,ht.deltaX,ht.deltaY);ht.overallVelocityX=xt.x,ht.overallVelocityY=xt.y,ht.overallVelocity=St(xt.x)>St(xt.y)?xt.x:xt.y,ht.scale=vt?function R(ut,ht){return M(ht[0],ht[1],$t)/M(ut[0],ut[1],$t)}(vt.pointers,mt):1,ht.rotation=vt?function D(ut,ht){return L(ht[1],ht[0],$t)+L(ut[1],ut[0],$t)}(vt.pointers,mt):0,ht.maxPointers=pt.prevInput?ht.pointers.length>pt.prevInput.maxPointers?ht.pointers.length:pt.prevInput.maxPointers:ht.pointers.length,E(pt,ht);var It=ut.element;m(ht.srcEvent.target,It)&&(It=ht.srcEvent.target),ht.target=It}(ut,pt),ut.emit("hammer.input",pt),ut.recognize(pt),ut.session.prevInput=pt}function E(ut,ht){var pt,ft,gt,vt,bt=ut.lastInterval||ht,yt=ht.timeStamp-bt.timeStamp;if(ht.eventType!=Lt&&(yt>At||bt.velocity===mt)){var wt=ht.deltaX-bt.deltaX,xt=ht.deltaY-bt.deltaY,It=V(yt,wt,xt);ft=It.x,gt=It.y,pt=St(It.x)>St(It.y)?It.x:It.y,vt=_(wt,xt),ut.lastInterval=ht}else pt=bt.velocity,ft=bt.velocityX,gt=bt.velocityY,vt=bt.direction;ht.velocity=pt,ht.velocityX=ft,ht.velocityY=gt,ht.direction=vt}function k(ut){for(var ht=[],pt=0;pt<ut.pointers.length;)ht[pt]={clientX:yt(ut.pointers[pt].clientX),clientY:yt(ut.pointers[pt].clientY)},pt++;return{timeStamp:wt(),pointers:ht,center:A(ht),deltaX:ut.deltaX,deltaY:ut.deltaY}}function A(ut){var ht=ut.length;if(1===ht)return{x:yt(ut[0].clientX),y:yt(ut[0].clientY)};for(var pt=0,mt=0,ft=0;ht>ft;)pt+=ut[ft].clientX,mt+=ut[ft].clientY,ft++;return{x:yt(pt/ht),y:yt(mt/ht)}}function V(ut,ht,pt){return{x:ht/ut||0,y:pt/ut||0}}function _(ut,ht){return ut===ht?Dt:St(ut)>=St(ht)?0>ut?Rt:Ot:0>ht?Ft:Ut}function M(ut,ht,pt){pt||(pt=Gt);var mt=ht[pt[0]]-ut[pt[0]],ft=ht[pt[1]]-ut[pt[1]];return Math.sqrt(mt*mt+ft*ft)}function L(ut,ht,pt){pt||(pt=Gt);var mt=ht[pt[0]]-ut[pt[0]],ft=ht[pt[1]]-ut[pt[1]];return 180*Math.atan2(ft,mt)/Math.PI}function O(){this.evEl=Ht,this.evWin=Zt,this.pressed=!1,P.apply(this,arguments)}function F(){this.evEl=Yt,this.evWin=Jt,P.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function U(){this.evTarget=Kt,this.evWin=te,this.started=!1,P.apply(this,arguments)}function B(ut,ht){var pt=b(ut.touches),mt=b(ut.changedTouches);return ht&(Mt|Lt)&&(pt=y(pt.concat(mt),"identifier",!0)),[pt,mt]}function N(){this.evTarget=ie,this.targetIds={},P.apply(this,arguments)}function q(ut,ht){var pt=b(ut.touches),mt=this.targetIds;if(ht&(Vt|_t)&&1===pt.length)return mt[pt[0].identifier]=!0,[pt,pt];var ft,gt,vt=b(ut.changedTouches),bt=[],yt=this.target;if(gt=pt.filter((function(ut){return m(ut.target,yt)})),ht===Vt)for(ft=0;ft<gt.length;)mt[gt[ft].identifier]=!0,ft++;for(ft=0;ft<vt.length;)mt[vt[ft].identifier]&&bt.push(vt[ft]),ht&(Mt|Lt)&&delete mt[vt[ft].identifier],ft++;return bt.length?[y(gt.concat(bt),"identifier",!0),bt]:void 0}function G(){P.apply(this,arguments);var ut=l(this.handler,this);this.touch=new N(this.manager,ut),this.mouse=new O(this.manager,ut),this.primaryTouch=null,this.lastTouches=[]}function $(ut,ht){ut&Vt?(this.primaryTouch=ht.changedPointers[0].identifier,W.call(this,ht)):ut&(Mt|Lt)&&W.call(this,ht)}function W(ut){var ht=ut.changedPointers[0];if(ht.identifier===this.primaryTouch){var pt={x:ht.clientX,y:ht.clientY};this.lastTouches.push(pt);var mt=this.lastTouches;setTimeout((function(){var ut=mt.indexOf(pt);ut>-1&&mt.splice(ut,1)}),ne)}}function H(ut){for(var ht=ut.srcEvent.clientX,pt=ut.srcEvent.clientY,mt=0;mt<this.lastTouches.length;mt++){var ft=this.lastTouches[mt],gt=Math.abs(ht-ft.x),vt=Math.abs(pt-ft.y);if(se>=gt&&se>=vt)return!0}return!1}function Z(ut,ht){this.manager=ut,this.set(ht)}function X(ut){this.options=ft({},this.defaults,ut||{}),this.id=function w(){return Pt++}(),this.manager=null,this.options.enable=u(this.options.enable,!0),this.state=me,this.simultaneous={},this.requireFail=[]}function J(ut){return ut&ye?"cancel":ut&ve?"end":ut&ge?"move":ut&fe?"start":""}function Q(ut){return ut==Ut?"down":ut==Ft?"up":ut==Rt?"left":ut==Ot?"right":""}function K(ut,ht){var pt=ht.manager;return pt?pt.get(ut):ut}function tt(){X.apply(this,arguments)}function et(){tt.apply(this,arguments),this.pX=null,this.pY=null}function it(){tt.apply(this,arguments)}function nt(){X.apply(this,arguments),this._timer=null,this._input=null}function st(){tt.apply(this,arguments)}function rt(){tt.apply(this,arguments)}function ot(){X.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function at(ut,ht){return(ht=ht||{}).recognizers=u(ht.recognizers,at.defaults.preset),new ct(ut,ht)}function ct(ut,ht){this.options=ft({},at.defaults,ht||{}),this.options.inputTarget=this.options.inputTarget||ut,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ut,this.input=function x(ut){return new(ut.options.inputClass||(zt?F:Ct?N:Tt?G:O))(ut,T)}(this),this.touchAction=new Z(this,this.options.touchAction),lt(this,!0),o(this.options.recognizers,(function(ut){var ht=this.add(new ut[0](ut[1]));ut[2]&&ht.recognizeWith(ut[2]),ut[3]&&ht.requireFailure(ut[3])}),this)}function lt(ut,ht){var pt,mt=ut.element;mt.style&&(o(ut.options.cssProps,(function(ft,gt){pt=S(mt.style,gt),ht?(ut.oldCssProps[pt]=mt.style[pt],mt.style[pt]=ft):mt.style[pt]=ut.oldCssProps[pt]||""})),ht||(ut.oldCssProps={}))}function dt(ut,pt){var mt=ht.createEvent("Event");mt.initEvent(ut,!0,!0),mt.gesture=pt,pt.target.dispatchEvent(mt)}var ft,gt=["","webkit","Moz","MS","ms","o"],vt=ht.createElement("div"),bt="function",yt=Math.round,St=Math.abs,wt=Date.now;ft="function"!=typeof Object.assign?function(ut){if(ut===mt||null===ut)throw new TypeError("Cannot convert undefined or null to object");for(var ht=Object(ut),pt=1;pt<arguments.length;pt++){var ft=arguments[pt];if(ft!==mt&&null!==ft)for(var gt in ft)ft.hasOwnProperty(gt)&&(ht[gt]=ft[gt])}return ht}:Object.assign;var xt=a((function(ut,ht,pt){for(var ft=Object.keys(ht),gt=0;gt<ft.length;)(!pt||pt&&ut[ft[gt]]===mt)&&(ut[ft[gt]]=ht[ft[gt]]),gt++;return ut}),"extend","Use `assign`."),It=a((function(ut,ht){return xt(ut,ht,!0)}),"merge","Use `assign`."),Pt=1,Tt="ontouchstart"in ut,zt=S(ut,"PointerEvent")!==mt,Ct=Tt&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Et="touch",kt="mouse",At=25,Vt=1,_t=2,Mt=4,Lt=8,Dt=1,Rt=2,Ot=4,Ft=8,Ut=16,Bt=Rt|Ot,Nt=Ft|Ut,qt=Bt|Nt,Gt=["x","y"],$t=["clientX","clientY"];P.prototype={handler:function(){},init:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(I(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(I(this.element),this.evWin,this.domHandler)}};var Wt={mousedown:Vt,mousemove:_t,mouseup:Mt},Ht="mousedown",Zt="mousemove mouseup";c(O,P,{handler:function(ut){var ht=Wt[ut.type];ht&Vt&&0===ut.button&&(this.pressed=!0),ht&_t&&1!==ut.which&&(ht=Mt),this.pressed&&(ht&Mt&&(this.pressed=!1),this.callback(this.manager,ht,{pointers:[ut],changedPointers:[ut],pointerType:kt,srcEvent:ut}))}});var jt={pointerdown:Vt,pointermove:_t,pointerup:Mt,pointercancel:Lt,pointerout:Lt},Xt={2:Et,3:"pen",4:kt,5:"kinect"},Yt="pointerdown",Jt="pointermove pointerup pointercancel";ut.MSPointerEvent&&!ut.PointerEvent&&(Yt="MSPointerDown",Jt="MSPointerMove MSPointerUp MSPointerCancel"),c(F,P,{handler:function(ut){var ht=this.store,pt=!1,mt=ut.type.toLowerCase().replace("ms",""),ft=jt[mt],gt=Xt[ut.pointerType]||ut.pointerType,vt=gt==Et,bt=v(ht,ut.pointerId,"pointerId");ft&Vt&&(0===ut.button||vt)?0>bt&&(ht.push(ut),bt=ht.length-1):ft&(Mt|Lt)&&(pt=!0),0>bt||(ht[bt]=ut,this.callback(this.manager,ft,{pointers:ht,changedPointers:[ut],pointerType:gt,srcEvent:ut}),pt&&ht.splice(bt,1))}});var Qt={touchstart:Vt,touchmove:_t,touchend:Mt,touchcancel:Lt},Kt="touchstart",te="touchstart touchmove touchend touchcancel";c(U,P,{handler:function(ut){var ht=Qt[ut.type];if(ht===Vt&&(this.started=!0),this.started){var pt=B.call(this,ut,ht);ht&(Mt|Lt)&&pt[0].length-pt[1].length==0&&(this.started=!1),this.callback(this.manager,ht,{pointers:pt[0],changedPointers:pt[1],pointerType:Et,srcEvent:ut})}}});var ee={touchstart:Vt,touchmove:_t,touchend:Mt,touchcancel:Lt},ie="touchstart touchmove touchend touchcancel";c(N,P,{handler:function(ut){var ht=ee[ut.type],pt=q.call(this,ut,ht);pt&&this.callback(this.manager,ht,{pointers:pt[0],changedPointers:pt[1],pointerType:Et,srcEvent:ut})}});var ne=2500,se=25;c(G,P,{handler:function(ut,ht,pt){var mt=pt.pointerType==Et,ft=pt.pointerType==kt;if(!(ft&&pt.sourceCapabilities&&pt.sourceCapabilities.firesTouchEvents)){if(mt)$.call(this,ht,pt);else if(ft&&H.call(this,pt))return;this.callback(ut,ht,pt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var re=S(vt.style,"touchAction"),oe=re!==mt,ae="compute",ce="auto",le="manipulation",de="none",ue="pan-x",he="pan-y",pe=function Y(){if(!oe)return!1;var ht={},pt=ut.CSS&&ut.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(mt){ht[mt]=!pt||ut.CSS.supports("touch-action",mt)})),ht}();Z.prototype={set:function(ut){ut==ae&&(ut=this.compute()),oe&&this.manager.element.style&&pe[ut]&&(this.manager.element.style[re]=ut),this.actions=ut.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ut=[];return o(this.manager.recognizers,(function(ht){d(ht.options.enable,[ht])&&(ut=ut.concat(ht.getTouchAction()))})),function j(ut){if(f(ut,de))return de;var ht=f(ut,ue),pt=f(ut,he);return ht&&pt?de:ht||pt?ht?ue:he:f(ut,le)?le:ce}(ut.join(" "))},preventDefaults:function(ut){var ht=ut.srcEvent,pt=ut.offsetDirection;if(!this.manager.session.prevented){var mt=this.actions,ft=f(mt,de)&&!pe[de],gt=f(mt,he)&&!pe[he],vt=f(mt,ue)&&!pe[ue];if(ft){var bt=1===ut.pointers.length,yt=ut.distance<2,St=ut.deltaTime<250;if(bt&&yt&&St)return}return vt&&gt?void 0:ft||gt&&pt&Bt||vt&&pt&Nt?this.preventSrc(ht):void 0}ht.preventDefault()},preventSrc:function(ut){this.manager.session.prevented=!0,ut.preventDefault()}};var me=1,fe=2,ge=4,ve=8,be=ve,ye=16,Se=32;X.prototype={defaults:{},set:function(ut){return ft(this.options,ut),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ut){if(r(ut,"recognizeWith",this))return this;var ht=this.simultaneous;return ht[(ut=K(ut,this)).id]||(ht[ut.id]=ut,ut.recognizeWith(this)),this},dropRecognizeWith:function(ut){return r(ut,"dropRecognizeWith",this)||(ut=K(ut,this),delete this.simultaneous[ut.id]),this},requireFailure:function(ut){if(r(ut,"requireFailure",this))return this;var ht=this.requireFail;return-1===v(ht,ut=K(ut,this))&&(ht.push(ut),ut.requireFailure(this)),this},dropRequireFailure:function(ut){if(r(ut,"dropRequireFailure",this))return this;ut=K(ut,this);var ht=v(this.requireFail,ut);return ht>-1&&this.requireFail.splice(ht,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ut){return!!this.simultaneous[ut.id]},emit:function(ut){function e(pt){ht.manager.emit(pt,ut)}var ht=this,pt=this.state;ve>pt&&e(ht.options.event+J(pt)),e(ht.options.event),ut.additionalEvent&&e(ut.additionalEvent),pt>=ve&&e(ht.options.event+J(pt))},tryEmit:function(ut){return this.canEmit()?this.emit(ut):void(this.state=Se)},canEmit:function(){for(var ut=0;ut<this.requireFail.length;){if(!(this.requireFail[ut].state&(Se|me)))return!1;ut++}return!0},recognize:function(ut){var ht=ft({},ut);return d(this.options.enable,[this,ht])?(this.state&(be|ye|Se)&&(this.state=me),this.state=this.process(ht),void(this.state&(fe|ge|ve|ye)&&this.tryEmit(ht))):(this.reset(),void(this.state=Se))},process:function(ut){},getTouchAction:function(){},reset:function(){}},c(tt,X,{defaults:{pointers:1},attrTest:function(ut){var ht=this.options.pointers;return 0===ht||ut.pointers.length===ht},process:function(ut){var ht=this.state,pt=ut.eventType,mt=ht&(fe|ge),ft=this.attrTest(ut);return mt&&(pt&Lt||!ft)?ht|ye:mt||ft?pt&Mt?ht|ve:ht&fe?ht|ge:fe:Se}}),c(et,tt,{defaults:{event:"pan",threshold:10,pointers:1,direction:qt},getTouchAction:function(){var ut=this.options.direction,ht=[];return ut&Bt&&ht.push(he),ut&Nt&&ht.push(ue),ht},directionTest:function(ut){var ht=this.options,pt=!0,mt=ut.distance,ft=ut.direction,gt=ut.deltaX,vt=ut.deltaY;return ft&ht.direction||(ht.direction&Bt?(ft=0===gt?Dt:0>gt?Rt:Ot,pt=gt!=this.pX,mt=Math.abs(ut.deltaX)):(ft=0===vt?Dt:0>vt?Ft:Ut,pt=vt!=this.pY,mt=Math.abs(ut.deltaY))),ut.direction=ft,pt&&mt>ht.threshold&&ft&ht.direction},attrTest:function(ut){return tt.prototype.attrTest.call(this,ut)&&(this.state&fe||!(this.state&fe)&&this.directionTest(ut))},emit:function(ut){this.pX=ut.deltaX,this.pY=ut.deltaY;var ht=Q(ut.direction);ht&&(ut.additionalEvent=this.options.event+ht),this._super.emit.call(this,ut)}}),c(it,tt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[de]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.scale-1)>this.options.threshold||this.state&fe)},emit:function(ut){if(1!==ut.scale){var ht=ut.scale<1?"in":"out";ut.additionalEvent=this.options.event+ht}this._super.emit.call(this,ut)}}),c(nt,X,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ce]},process:function(ut){var ht=this.options,pt=ut.pointers.length===ht.pointers,mt=ut.distance<ht.threshold,ft=ut.deltaTime>ht.time;if(this._input=ut,!mt||!pt||ut.eventType&(Mt|Lt)&&!ft)this.reset();else if(ut.eventType&Vt)this.reset(),this._timer=s((function(){this.state=be,this.tryEmit()}),ht.time,this);else if(ut.eventType&Mt)return be;return Se},reset:function(){clearTimeout(this._timer)},emit:function(ut){this.state===be&&(ut&&ut.eventType&Mt?this.manager.emit(this.options.event+"up",ut):(this._input.timeStamp=wt(),this.manager.emit(this.options.event,this._input)))}}),c(st,tt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[de]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.rotation)>this.options.threshold||this.state&fe)}}),c(rt,tt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Bt|Nt,pointers:1},getTouchAction:function(){return et.prototype.getTouchAction.call(this)},attrTest:function(ut){var ht,pt=this.options.direction;return pt&(Bt|Nt)?ht=ut.overallVelocity:pt&Bt?ht=ut.overallVelocityX:pt&Nt&&(ht=ut.overallVelocityY),this._super.attrTest.call(this,ut)&&pt&ut.offsetDirection&&ut.distance>this.options.threshold&&ut.maxPointers==this.options.pointers&&St(ht)>this.options.velocity&&ut.eventType&Mt},emit:function(ut){var ht=Q(ut.offsetDirection);ht&&this.manager.emit(this.options.event+ht,ut),this.manager.emit(this.options.event,ut)}}),c(ot,X,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[le]},process:function(ut){var ht=this.options,pt=ut.pointers.length===ht.pointers,mt=ut.distance<ht.threshold,ft=ut.deltaTime<ht.time;if(this.reset(),ut.eventType&Vt&&0===this.count)return this.failTimeout();if(mt&&ft&&pt){if(ut.eventType!=Mt)return this.failTimeout();var gt=!this.pTime||ut.timeStamp-this.pTime<ht.interval,vt=!this.pCenter||M(this.pCenter,ut.center)<ht.posThreshold;if(this.pTime=ut.timeStamp,this.pCenter=ut.center,vt&&gt?this.count+=1:this.count=1,this._input=ut,0===this.count%ht.taps)return this.hasRequireFailures()?(this._timer=s((function(){this.state=be,this.tryEmit()}),ht.interval,this),fe):be}return Se},failTimeout:function(){return this._timer=s((function(){this.state=Se}),this.options.interval,this),Se},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==be&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),at.VERSION="2.0.7",at.defaults={domEvents:!1,touchAction:ae,enable:!0,inputTarget:null,inputClass:null,preset:[[st,{enable:!1}],[it,{enable:!1},["rotate"]],[rt,{direction:Bt}],[et,{direction:Bt},["swipe"]],[ot],[ot,{event:"doubletap",taps:2},["tap"]],[nt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ct.prototype={set:function(ut){return ft(this.options,ut),ut.touchAction&&this.touchAction.update(),ut.inputTarget&&(this.input.destroy(),this.input.target=ut.inputTarget,this.input.init()),this},stop:function(ut){this.session.stopped=ut?2:1},recognize:function(ut){var ht=this.session;if(!ht.stopped){this.touchAction.preventDefaults(ut);var pt,mt=this.recognizers,ft=ht.curRecognizer;(!ft||ft&&ft.state&be)&&(ft=ht.curRecognizer=null);for(var gt=0;gt<mt.length;)pt=mt[gt],2===ht.stopped||ft&&pt!=ft&&!pt.canRecognizeWith(ft)?pt.reset():pt.recognize(ut),!ft&&pt.state&(fe|ge|ve)&&(ft=ht.curRecognizer=pt),gt++}},get:function(ut){if(ut instanceof X)return ut;for(var ht=this.recognizers,pt=0;pt<ht.length;pt++)if(ht[pt].options.event==ut)return ht[pt];return null},add:function(ut){if(r(ut,"add",this))return this;var ht=this.get(ut.options.event);return ht&&this.remove(ht),this.recognizers.push(ut),ut.manager=this,this.touchAction.update(),ut},remove:function(ut){if(r(ut,"remove",this))return this;if(ut=this.get(ut)){var ht=this.recognizers,pt=v(ht,ut);-1!==pt&&(ht.splice(pt,1),this.touchAction.update())}return this},on:function(ut,ht){if(ut!==mt&&ht!==mt){var pt=this.handlers;return o(g(ut),(function(ut){pt[ut]=pt[ut]||[],pt[ut].push(ht)})),this}},off:function(ut,ht){if(ut!==mt){var pt=this.handlers;return o(g(ut),(function(ut){ht?pt[ut]&&pt[ut].splice(v(pt[ut],ht),1):delete pt[ut]})),this}},emit:function(ut,ht){this.options.domEvents&&dt(ut,ht);var pt=this.handlers[ut]&&this.handlers[ut].slice();if(pt&&pt.length){ht.type=ut,ht.preventDefault=function(){ht.srcEvent.preventDefault()};for(var mt=0;mt<pt.length;)pt[mt](ht),mt++}},destroy:function(){this.element&&lt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ft(at,{INPUT_START:Vt,INPUT_MOVE:_t,INPUT_END:Mt,INPUT_CANCEL:Lt,STATE_POSSIBLE:me,STATE_BEGAN:fe,STATE_CHANGED:ge,STATE_ENDED:ve,STATE_RECOGNIZED:be,STATE_CANCELLED:ye,STATE_FAILED:Se,DIRECTION_NONE:Dt,DIRECTION_LEFT:Rt,DIRECTION_RIGHT:Ot,DIRECTION_UP:Ft,DIRECTION_DOWN:Ut,DIRECTION_HORIZONTAL:Bt,DIRECTION_VERTICAL:Nt,DIRECTION_ALL:qt,Manager:ct,Input:P,TouchAction:Z,TouchInput:N,MouseInput:O,PointerEventInput:F,TouchMouseInput:G,SingleTouchInput:U,Recognizer:X,AttrRecognizer:tt,Tap:ot,Pan:et,Swipe:rt,Pinch:it,Rotate:st,Press:nt,on:h,off:p,each:o,merge:It,extend:xt,assign:ft,inherit:c,bindFn:l,prefixed:S}),(void 0!==ut?ut:"undefined"!=typeof self?self:{}).Hammer=at,"function"==typeof define&&define.amd?define("hammer",[],(function(){return at})):"undefined"!=typeof module&&module.exports?module.exports=at:ut.Hammer=at}(window,document),define("spinViewer/Controller",["ko","$","utils/deviceHelper","utils/sizeHelper","utils/ImageScaler","utils/ImageZoomer","hammer"],(function(ut,ht,pt,mt,ft,gt,vt){"use strict";var a=function(mt,ft,gt,vt,bt,yt){this.assetsProvider=mt,this.imageLoader=ft,this.loadedAssets=null,this.events=yt,this.containers=bt,this.params={showHint:!1,spinSpeed:1,maxPixelRatio:1.5,hintDisplayTime:3e3,preloadingTimeout:0,handleLoadingErrors:!0,framesCachingQueueInterval:35,useInitialAnimation:!1,animationFramesCount:-1,animationIntervalStart:40,animationIntervalPeak:5},this.viewModel=vt,this.updateZoomerDummy=ut.observable(!1),this.initState=this.INIT_STATE.NotInitialized,this.frames=[[]],this.lastInitArguments=null,this.currentRowIndex=ut.observable(0),this.currentFrameIndex=ut.observable(),ht.extend(!0,this.params,gt),this.params.devicePixelRatio=Math.min(pt.getDevicePixelRatio(this.containers.window),this.params.maxPixelRatio),this.isPannable=ut.computed(this.isPannable,this),this.hasError=ut.observable(!1),this.getCurrentZoomer=ut.computed(this.getCurrentZoomer,this),this.setEventListeners(),this.viewModel.isPannable(this.isPannable())};return a.prototype.MIN_GESTURE_RECOGNIZE_DISTANCE=10,a.prototype.INIT_STATE={NotInitialized:0,Initializing:1,Initialized:2},a.prototype.init=function(ut,ht){return this.initState!==this.INIT_STATE.Initializing?(ht&&ht.initImage&&(ht=ht.initImage.image),this.lastInitArguments=arguments,this.updateSpinContainerSize(),this.targetSize=this.getContainerInitialTargetSize(),ht?(this.setInitialImage(ht),this.initState=this.INIT_STATE.Initialized,void this.showFrame(0,0,!0)):this.initState!==this.INIT_STATE.Initialized?(this.initState=this.INIT_STATE.Initializing,void this.preloadImages(0,0)):void this.resize(function(){this.showFrame(0,0,!0)}.bind(this))):void 0},a.prototype.isVisible=function(){return"none"!==window.getComputedStyle(this.containers.spin).display},a.prototype.setInitialImage=function(ut){var ht=this.getZoomer(0,0);ht.options.baseUrl=this.loadedAssets.frameUrls[0][0],ht.zoomReset(null,!0),ut.className="img",ht.setPlaceholderImage(ut)},a.prototype.updateSpinContainerSize=function(){this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.spinContainerSize={width:this.spinContainerRect.width,height:this.spinContainerRect.height}},a.prototype.isPannable=function(){var ut=this.getCurrentZoomer();return ut&&ut.canZoomOut()},a.prototype.zoomIn=function(ut,ht,pt){var mt=this.getCurrentZoomer();return mt&&(ut||mt.canZoomIn())?(this.events.trigger("zoomedIn"),this.imageLoader.cancelAllLoadRequests(),mt.zoomIn(ut,ht,pt),void(mt.canZoomIn()?this.viewModel.events.trigger("canZoomIn"):this.viewModel.events.trigger("cantZoomIn"))):void("function"==typeof pt&&pt())},a.prototype.zoomReset=function(ut){var ht=this.getCurrentZoomer();return ht?(this.imageLoader.cancelAllLoadRequests(),void ht.zoomReset(ut)):void("function"==typeof ut&&ut())},a.prototype.zoomOut=function(ut,ht){var pt=this.getCurrentZoomer();return pt&&pt.canZoomOut()?(this.imageLoader.cancelAllLoadRequests(),void pt.zoomOut(focalPointInContainer,ht)):void("function"==typeof ht&&ht())},a.prototype.getEventPositionRelativeToTarget=function(ut,ht){return{x:(ut.center?ut.center.x:ut.clientX)-ht.left,y:(ut.center?ut.center.y:ut.clientY)-ht.top}},a.prototype.resize=function(ut){if(this.isVisible()){var ht=this.frames.length*this.frames[0].length,n=function(){--ht||"function"==typeof ut&&ut()};if(this.updateSpinContainerSize(),!ht)return void("function"==typeof ut&&ut());for(var pt=0;pt<this.frames.length;pt++)for(var mt=0;mt<this.frames[pt].length;mt++){var ft=this.getOutputBaseSize();this.frames[pt][mt].resize(!0,{containerSize:this.spinContainerSize,outputBaseSize:ft,imageScalersOptions:this.getImageScalersOptions(ft)},n)}}},a.prototype.animationIntervalEasing=function(ut,ht){var pt=this.params.animationIntervalPeak-this.params.animationIntervalStart,mt=(Math.sin(2*Math.PI*ut/ht-Math.PI/2)+1)/2;return this.params.animationIntervalStart+mt*pt},a.prototype.refresh=function(){this.init.apply(this,this.lastInitArguments)},a.prototype.animateSpin=function(ut,ht,pt,mt){var ft=ut,gt=0,vt=ht>ut?ht-ut:this.frames[this.currentRowIndex()].length+ht-ut,bt=function(){return this.showFrame(this.currentRowIndex(),ft,!0),ft===ht?void("function"==typeof mt&&mt()):(ft++,gt++,ft>=this.frames[this.currentRowIndex()].length&&(ft=0),void setTimeout(bt,pt(gt,vt)))}.bind(this);bt()},a.prototype.getZoomer=function(ut,ht){var pt,mt=this.getOutputBaseSize(),ft=this.getImageScalersOptions(mt);return this.frames[ut]=this.frames[ut]||[],(pt=this.frames[ut][ht])||(pt=this.createZoomer(),this.frames[ut][ht]=pt,this.updateZoomerDummy(!this.updateZoomerDummy())),pt.inputImageScaler.options.baseSize=ft.inputImageScalerOptions.baseSize,pt.inputImageScaler.options.maxSize=ft.inputImageScalerOptions.maxSize,pt.resize(!1,{containerSize:this.spinContainerSize,outputBaseSize:mt,imageScalersOptions:ft}),pt},a.prototype.getImageScalersOptions=function(ut){var ht={width:this.loadedAssets.maxSize.width,height:this.loadedAssets.maxSize.height};return{inputImageScalerOptions:{baseSize:{width:Math.min(this.loadedAssets.maxSize.width,this.targetSize.width*this.params.devicePixelRatio),height:Math.min(this.loadedAssets.maxSize.height,this.targetSize.height*this.params.devicePixelRatio)},maxSize:ht},outputImageScalerOptions:{baseSize:ut,maxSize:{width:Math.max(ut.width,this.loadedAssets.maxSize.width/this.params.devicePixelRatio),height:Math.max(ut.height,this.loadedAssets.maxSize.height/this.params.devicePixelRatio)}}}},a.prototype.createZoomer=function(ut){var ht=document.createElement("div"),pt=this.getOutputBaseSize(),mt=this.getImageScalersOptions(pt),vt=new ft(mt.inputImageScalerOptions),bt=new ft(mt.outputImageScalerOptions);return ht.className="amp-frame",new gt(this.imageLoader,vt,bt,{baseUrl:ut,zoomFactors:this.params.zoomFactors,container:ht,containerSize:this.spinContainerSize,outputBaseSize:pt,devicePixelRatio:this.params.devicePixelRatio,baseJpgQlt:this.params.baseJpgQlt,zoomJpgQlt:this.params.zoomJpgQlt})},a.prototype.getContainerInitialTargetSize=function(){var ut=mt.getProportionalSize({width:this.spinContainerSize.width,height:this.spinContainerSize.height},this.loadedAssets.maxSize);return this.params.initialSize&&(ut.width=this.params.initialSize.width,ut.height=this.loadedAssets.maxSize.height*ut.width/this.loadedAssets.maxSize.width),ut},a.prototype.getOutputBaseSize=function(){return mt.getProportionalSize(this.spinContainerSize,this.loadedAssets.maxSize)},a.prototype.preloadImages=function(ut,ht,pt){this.viewModel.loadingPercentage(0),this.hasError(!1);var mt,ft=null,gt=!1,vt=[],bt=null,l=function(){gt=!0,yt--,St--,yt||(clearTimeout(ft),ft=null,clearInterval(bt),bt=null,this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized)},u=function(ut,ht,pt){pt.applyPosition(),yt--,mt>1&&vt.push({rowIndex:ut,frameIndex:ht})},h=function(ut,ht,pt){pt.loadImage(this.loadedAssets.frameUrls[ut][ht],pt.options.container,pt.inputImageScaler.options.baseSize,pt.options.outputBaseSize,u.bind(this,ut,ht,pt),this.params.handleLoadingErrors?l.bind(this):u.bind(this,ut,ht,pt),null,null,1===mt,this.params.baseJpgQlt)},yt=mt=this.loadedAssets.frameUrls.length*this.loadedAssets.frameUrls[0].length,St=mt;mt>1&&this.viewModel.isLoadingPageVisible(!0),bt=setInterval(function(ut){var ht=vt.pop();return ht?(this.showFrame(ht.rowIndex,ht.frameIndex,!0),St--,void this.viewModel.loadingPercentage(Math.floor(100*(mt-St)/mt))):void(yt||(clearInterval(bt),bt=null,"function"==typeof ut&&ut()))}.bind(this,function(){if(clearTimeout(ft),ft=null,this.hasError(gt),gt)return this.events.trigger("allImagesLoaded",!1),void(this.initState=this.INIT_STATE.NotInitialized);this.events.trigger("allImagesLoaded",!0);var pt=this.frames[ut].length,mt=ht,vt=(pt+ht-1)%pt;return!this.params.showHint||window.sessionStorage&&window.sessionStorage.getItem("spinViewerHintDisplayed")||(this.viewModel.isHintVisible(!0),setTimeout(function(){this.viewModel.isHintVisible(!1),window.sessionStorage&&window.sessionStorage.setItem("spinViewerHintDisplayed",!0)}.bind(this),this.params.hintDisplayTime)),this.params.useInitialAnimation?(mt=(pt+ht-this.params.animationFramesCount)%pt,vt=ht,this.showFrame(ut,mt,!0),this.viewModel.isLoadingPageVisible(!1),void this.animateSpin(mt,vt,this.animationIntervalEasing.bind(this),function(){this.initState=this.INIT_STATE.Initialized,this.showFrame(ut,ht,!0)}.bind(this))):(this.viewModel.isLoadingPageVisible(!1),this.initState=this.INIT_STATE.Initialized,void this.showFrame(ut,ht,!0))}.bind(this)),this.params.framesCachingQueueInterval),this.imageLoader.cancelAllLoadRequests(),this.params.handleLoadingErrors&&this.params.preloadingTimeout&&(ft=setTimeout(function(){clearInterval(bt),bt=null,this.imageLoader.cancelAllLoadRequests(),this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized}.bind(this),this.params.preloadingTimeout));for(var wt=0;wt<this.loadedAssets.frameUrls.length;wt++)for(var xt=0;xt<this.loadedAssets.frameUrls[wt].length;xt++){var It=this.getZoomer(wt,xt);It.options.baseUrl=this.loadedAssets.frameUrls[wt][xt],h.call(this,wt,xt,It)}},a.prototype.getCurrentZoomer=function(){return this.updateZoomerDummy(),this.currentRowIndex()<this.frames.length&&this.frames[this.currentRowIndex()]&&this.currentFrameIndex()<this.frames[this.currentRowIndex()].length?this.frames[this.currentRowIndex()][this.currentFrameIndex()]:null},a.prototype.getCurrentFrame=function(){return{rowIndex:this.currentRowIndex(),frameIndex:this.currentFrameIndex(),zoomer:this.getCurrentZoomer()}},a.prototype.showFrame=function(ut,ht,pt){if((pt||this.initState===this.INIT_STATE.Initialized)&&(ut!=this.currentRowIndex()||ht!=this.currentFrameIndex())){this.currentRowIndex(ut),this.currentFrameIndex(ht);for(var mt=this.getCurrentFrame();this.containers.images.lastChild;)this.containers.images.removeChild(this.containers.images.lastChild);this.containers.images.appendChild(mt.zoomer.options.container),this.events.trigger("frameShown",mt)}},a.prototype.loadFullImage=function(ut,ht){ut.fullImageStatus=ut.FULL_IMAGE_STATUS.Loading;var pt=(ut.getCurrentImageDisplaySize(),ut.getOutputImageSize(ut.options.zoomFactors.length-1)),mt=ut.getZoomedImageBox(ut.currentSize,ut.currentPosition,pt,ht);ut.loadImage(this.loadedAssets.frameUrls[this.currentRowIndex()][this.currentFrameIndex()],ut.options.container,ut.getInputImageSize(ut.options.zoomFactors.length-1),pt,(function(){ut.applyPosition(),ut.fullImageStatus=ut.FULL_IMAGE_STATUS.Loaded}),(function(){ut.fullImageStatus!==ut.FULL_IMAGE_STATUS.Loaded&&(ut.fullImageStatus=ut.FULL_IMAGE_STATUS.NotLoaded)}),mt.focalPointOnSourceImage,null,!0,this.params.zoomJpgQlt)},a.prototype.zoomCenter=function(){this.zoomIn(!0)},a.prototype.setEventListeners=function(){this.viewModel.events.on("refreshButtonClicked",function(){this.refresh(),this.events.trigger("refreshButtonClicked")}.bind(this)),this.viewModel.events.on("zoomCenter",this.zoomCenter.bind(this)),ht(window).resize(function(){if(this.initState===this.INIT_STATE.Initialized){var ut=this.containers.spin.getBoundingClientRect();ut.width===this.spinContainerRect.width&&ut.height===this.spinContainerRect.height||this.resize()}}.bind(this));var ut,pt,mt=new vt(this.containers.root),ft=mt.get("pinch"),gt=mt.get("pan"),bt=mt.get("doubletap"),yt=0,St=0,wt=null,xt=function(ut,ht){var pt=this.getCurrentZoomer();if(pt.canZoomOut())pt.moveBy(ht);else if(this.frames.length>1||this.frames[this.currentRowIndex()].length>1){var mt=this.getRemoteRowIndex(yt,this.getMatrixShift(this.params.reverseVerticalDirection,ut.y,this.frames.length,this.spinContainerSize.height)),ft=this.getRemoteFrameIndex(St,this.getMatrixShift(this.params.reverseHorizontalDirection,ut.x,this.frames[0].length,this.spinContainerSize.width));mt===this.currentRowIndex()&&ft===this.currentFrameIndex()||(this.events.trigger("spun"),this.showFrame(mt,ft))}}.bind(this),It=function(){gt.set({threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE}),gt.set({direction:this.isPannable()?vt.DIRECTION_ALL:vt.DIRECTION_HORIZONTAL}),gt.set({enable:this.isPannable()||this.frames[this.currentRowIndex()].length>1})}.bind(this),Pt=function(ht){if(this.initState===this.INIT_STATE.Initialized){ht.preventDefault(),ht.stopPropagation();var pt=this.getCurrentZoomer(),mt=1+.1*(ht.detail<0||ht.wheelDelta>0?1:-1);this.spinContainerRect=this.containers.spin.getBoundingClientRect(),pt.fullImageStatus===pt.FULL_IMAGE_STATUS.NotLoaded&&this.loadFullImage.call(this,pt,this.getEventPositionRelativeToTarget(ht,this.spinContainerRect)),ut=pt.getCurrentImageDisplaySize(),pt.scale(ut,mt,this.getEventPositionRelativeToTarget(ht,this.spinContainerRect),false)}}.bind(this);It(),bt.set({interval:500,time:500,threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE,posThreshold:100});this.viewModel.events.on("panImage",(function(ut,ht){var pt={x:0,y:0},mt=ht.split(",");-1===mt.indexOf("arrowup")&&-1===mt.indexOf("w")||(pt.y=30),-1===mt.indexOf("arrowdown")&&-1===mt.indexOf("s")||(pt.y=-30),-1===mt.indexOf("arrowleft")&&-1===mt.indexOf("a")||(pt.x=30),-1===mt.indexOf("arrowright")&&-1===mt.indexOf("d")||(pt.x=-30),xt(pt,pt)})),this.isPannable.subscribe(function(ut){this.viewModel.isPannable(ut),It()}.bind(this)),mt.on("hammer.input",function(ut){return ut.distance<this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(wt=null),null===wt&&ut.distance>=this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(wt=!this.isPannable()&&1===ut.pointers.length&&(ut.direction&vt.DIRECTION_VERTICAL)>0),wt?void mt.stop():void ft.set({enable:ut.pointers.length>1})}.bind(this)),mt.on("tap",function(ut){this.initState===this.INIT_STATE.Initialized&&"mouse"===ut.pointerType&&(ut.target&&-1===ut.target.className.indexOf("amp-overlay")||(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(ut,this.spinContainerRect))))}.bind(this)),mt.on("doubletap",function(ut){ut.preventDefault(),ut.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&"mouse"!==ut.pointerType&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(ut,this.spinContainerRect)))}.bind(this)),mt.on("panstart",function(ut){pt=ut,St=this.currentFrameIndex(),yt=this.currentRowIndex()}.bind(this)),mt.on("pan",function(ut){if(this.initState===this.INIT_STATE.Initialized){ut.preventDefault(),ut.srcEvent.stopPropagation(),St=St||this.currentFrameIndex(),yt=yt||this.currentRowIndex(),pt=pt||ut;var ht={x:ut.deltaX-pt.deltaX,y:ut.deltaY-pt.deltaY},mt={x:ut.deltaX,y:ut.deltaY};pt=ut,xt(mt,ht)}}.bind(this)),mt.on("panend",function(ut){pt=ut,St=this.currentFrameIndex(),yt=this.currentRowIndex()}.bind(this)),mt.on("pinchstart",function(ht){if(this.initState===this.INIT_STATE.Initialized){var pt=this.getCurrentZoomer();pt.fullImageStatus===pt.FULL_IMAGE_STATUS.NotLoaded&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.loadFullImage.call(this,pt,this.getEventPositionRelativeToTarget(ht,this.spinContainerRect))),ut=pt.getCurrentImageDisplaySize(),gt.set({enable:!1})}}.bind(this)),mt.on("pinch",function(ht){ht.preventDefault(),ht.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&this.getCurrentZoomer().scale(ut,ht.scale,this.getEventPositionRelativeToTarget(ht,this.spinContainerRect),false)}.bind(this)),mt.on("pinchend",function(){this.initState===this.INIT_STATE.Initialized&&It()}.bind(this)),this.containers.spin.addEventListener("mousewheel",Pt),this.containers.spin.addEventListener("DOMMouseScroll",Pt),this.hasError.subscribe(function(ut){this.viewModel.isErrorPageVisible(ut)}.bind(this))},a.prototype.getMatrixShift=function(ut,ht,pt,mt){var ft=(ut?-1:1)*this.params.spinSpeed*ht*pt/mt;return ft>0?Math.floor(ft):Math.ceil(ft)},a.prototype.getRemoteFrameIndex=function(ut,ht){var pt=(ut+ht)%this.frames[0].length;return 0>pt&&(pt=this.frames[0].length+pt),pt},a.prototype.getRemoteRowIndex=function(ut,ht){var pt=(ut+ht)%this.frames.length;return 0>pt&&(pt=this.frames.length+pt),pt},a.prototype.loadAssets=function(ut,ht,pt){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=null,this.assetsProvider.getAssets(ut,function(ut){return ut.maxSize.width&&ut.maxSize.height?(this.loadedAssets=ut,void("function"==typeof ht&&ht(ut))):void("function"==typeof pt&&pt())}.bind(this),pt)},a.prototype.setAssets=function(ut){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=ut},a})),define("bindings/fadeVisible",["ko","$"],(function(ut,ht){"use strict";function i(){}return i.prototype.init=function(pt,mt){var ft=mt();ht(pt).toggle(ut.unwrap(ft))},i.prototype.update=function(pt,mt){var ft=mt();ut.unwrap(ft)?ht(pt).fadeIn():ht(pt).fadeOut()},ut.bindingHandlers.fadeVisible=new i,ut.bindingHandlers.fadeVisible})),define("spinViewer/component",["$","spinViewerView","utils/scene7.config","utils/scene7.ImageLoader","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider","spinViewer/ViewModel","spinViewer/Controller","bindings/fadeVisible"],(function(ut,ht,pt,mt,ft,gt,vt,bt,yt){"use strict";return{viewModel:{createViewModel:function(ht,St){var wt=ut({}),xt=ut({}),It={window,root:St.element,spin:St.element.querySelector(".amp-spin"),images:St.element.querySelector(".amp-spin .amp-images")},Pt=new pt(ht.scene7.imageServer,ht.scene7.videoServer),Tt=new ft(Pt),zt=new gt(Pt,Tt),Ct=new vt(zt),Et=new mt(Pt,ht.viewer.useCors),kt=new bt(wt,ht.messages);ht.viewer.zoomFactors.container&&(ht.viewer.zoomFactors=ht.viewer.zoomFactors.container);var At=new yt(Ct,Et,ht.viewer,kt,It,xt),Vt={setAssets:At.setAssets.bind(At),loadAssets:At.loadAssets.bind(At),init:At.init.bind(At),zoomIn:At.zoomIn.bind(At),zoomOut:At.zoomOut.bind(At),zoomReset:At.zoomReset.bind(At),events:At.events};return ht.api(Vt),kt}},template:ht,synchronous:!0}})),define("Asos.Utils.MediaPlayers",["videoPlayer/component","videoPlayer/DataMapper","videoPlayer/AssetsProvider","spinViewer/component","utils/scene7.config","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider"],(function(ut,ht,pt,mt,ft,gt,vt,bt){"use strict";function c(){this.videoPlayer=ut,this.spinViewer=mt}return c.prototype.getSpinViewerAssetsProvider=function(ut){var ht=new ft(ut),pt=new gt(ht),mt=new vt(ht,pt);return new bt(mt)},c.prototype.getVideoPlayerAssetsProvider=function(ut){var mt=new ft(null,ut),vt=new gt(mt),bt=new ht(mt);return new pt(mt,vt,bt)},new c})),define("ProductUtils/Window",[],(function(){return window})),define("ProductUtils/MergeJson",[],(function(){return function(ut,ht){var pt=JSON.parse(JSON.stringify(ut)),mt=JSON.parse(JSON.stringify(ht));for(var ft in mt)try{pt[ft]=mt[ft]}catch(ut){console.warn("couldn't merge JSONS: "+ut)}return pt}})),define("ProductUtils/StockPrice",["ProductUtils/Window","ProductUtils/MergeJson"],(function(ut,ht){return function(){this.getStockPrice=function(ht,pt,mt){null!=ht&&ut.asos.pdp.getStockPrice().then(function(ut){this.successRequest.call(this,ut,{callback:pt,products:ht})}.bind(this)).catch(mt)},this.successRequest=function(ut,ht){var pt=this.combineData(ht.products,ut);ht.callback(pt)},this.combineData=function(ut,ht){var pt,mt=void 0!==ut.products,ft=this.createVariantMap(ut,mt);if(mt){for(var gt={},vt=0;vt<ut.products.length;vt++)gt[ut.products[vt].id]=vt;var bt=[];bt.length=ht.length;for(var yt=0;yt<ht.length;yt++){bt[gt[ht[yt].productId]]=ht[yt]}for(var St=0;St<ut.products.length;St++)ut.products[St]=this.mergeJsons(ut.products[St],bt[St]);pt=ut;for(var wt=[],xt=0;xt<ut.products.length;xt++)wt.push(this.mapVariantData(ut.products[xt],pt.products[xt],ft[ut.products[xt].productId]));return pt.products=wt,pt}return ft=ft[ut.id],pt=this.mergeJsons(ut,ht[0]),this.mapVariantData(ut,pt,ft)},this.mapVariantData=function(ut,ht,pt){for(var mt=!1,ft=0;ft<ut.variants.length;ft++)mt||(mt=ht.variants[ft].isInStock),ht.variants[ft].variantId=ht.variants[ft].id,ht.variants[ft].sku=pt[ht.variants[ft].id].sku,ht.variants[ft].size=pt[ht.variants[ft].id].size,ht.variants[ft].sizeOrder=pt[ht.variants[ft].id].sizeOrder,ht.variants[ft].colour=pt[ht.variants[ft].id].colour,ht.variants[ft].colourWayId=pt[ht.variants[ft].id].colourWayId,ht.variants[ft].isPrimary=pt[ht.variants[ft].id].isPrimary,ht.variants[ft].sizeId=pt[ht.variants[ft].id].sizeId,ht.variants[ft].productImage=void 0!==ut.productImage?ut.productImage.url:"";return ht.isInStock=mt,ht},this.createVariantMap=function(ut,ht){var pt=[];if(ht)for(var mt=0;mt<ut.products.length;mt++)pt[ut.products[mt].id]=[],pt=this.loopVariants(ut.products[mt],pt);else pt[ut.id]=[],pt=this.loopVariants(ut,pt);return pt},this.loopVariants=function(ut,ht){for(var pt=0;pt<ut.variants.length;pt++){var mt=ut.variants[pt].variantId;ht[ut.id][mt]=ut.variants[pt]}return ht},this.mergeJsons=ht}})),define("Providers/SdkProvider",["Promise"],(function(ut){function e(ht){return function(){return new ut((function(ut){var i=function(){ut(window.asos.sdk[ht])};window.asos.sdk&&window.asos.sdk[ht]?i():window.asos.eventBus.once(ht+"-sdk-ready",(function(){i()}))}))}}return{getSavedItems:e("savedItems"),getBag:e("bag"),getIdentity:e("identity"),getFeatures:e("features")}})),define("Providers/FeaturesProvider",["Providers/SdkProvider","Promise"],(function(ut,ht){var pt,mt,ft=new ht((function(ut){pt=ut})),gt=new ht((function(ut){mt=ut})),u=function(){return{isEnabled:function(){return!1},getVariables:function(){return null}}},h=function(){},p=function(){};return ut.getFeatures().then((function(ut){ut.onReady().then((function(){u=ut.getFeature,h=ut.track,p=ut.activate,pt(),setTimeout(mt,0)}))})),{getFeature:function i(ut,ht,pt){return u(ut,ht,pt)},onReady:function r(){return ft},onComplete:function o(){return gt},track:function n(ut,ht,pt){return h(ut,ht,pt)},activate:function s(ut,ht,pt){return p(ut,ht,pt)}}})),define("ProductUtils/NewRelicLogger",["PageConfig"],(function(ut){var e=function(){var ht;this.init=function(ut){ht=ut},this.logError=function(pt,mt){window.newrelic&&(mt.pageVersion=ut.version,mt.pageUrl=window.location.href,mt.pageType=ht,mt.codebase="Knockout",window.newrelic.addPageAction(pt.message,mt))}};return e.prototype.PAGE_TYPE={PRD:"ProductPage.SingleProduct",GRP:"ProductPage.MixAndMatch"},e.prototype.ERROR_TYPE={AjaxError:"Ajax Error",ParseError:"Parse Error",UserActionFailed:"User Action Failed"},new e})),define("asos-web-seo-path",[],(function(){"use strict";function t(ht){return Object.values(ht).map((function(ht){var pt=ut.find((function(ut){return ut[0]===ht}));return pt?pt[1]:ht})).join("")}function i(ut){return function e(ut){return Object.values(ut.normalize("NFD")).map((function(ut){return ut.match(/[0-9A-Za-z \-/.]/g)?ut:void 0})).join("").normalize("NFC")}(ut.trim()).replace(/\//g,"-").replace(/\s/g,"-").replace(/-+/g,"-").replace(/\./g,"").replace(/^-/,"").replace(/-$/,"").toLowerCase()}function n(ut,ht,pt){var mt=ut,ft=ht;return pt&&"ru-ru"===pt.toLowerCase()&&(mt=t(ut),ft=t(ht)),{romanProductName:mt,romanBrandName:ft}}var ut=[["А","A"],["а","a"],["Б","B"],["б","b"],["В","V"],["в","v"],["Г","G"],["г","g"],["Д","D"],["д","d"],["Е","E"],["е","e"],["Ё","Yo"],["ё","yo"],["Ж","Zh"],["ж","zh"],["З","Z"],["з","z"],["И","I"],["и","i"],["Й","J"],["й","j"],["К","K"],["к","k"],["Л","L"],["л","l"],["М","M"],["м","m"],["Н","N"],["н","n"],["О","O"],["о","o"],["П","P"],["п","p"],["Р","R"],["р","r"],["С","S"],["с","s"],["Т","T"],["т","t"],["У","U"],["у","u"],["Ф","F"],["ф","f"],["Х","H"],["х","h"],["Ц","Ts"],["ц","ts"],["Ч","Ch"],["ч","ch"],["Ш","Sh"],["ш","sh"],["Щ","Sch"],["щ","sch"],["Ъ",""],["ъ",""],["Ы","Y"],["ы","y"],["Ь",""],["ь",""],["Э","E"],["э","e"],["Ю","Yu"],["ю","yu"],["Я","Ya"],["я","ya"]];return function s(ut){return function(ht,pt,mt){if("function"!=typeof"".normalize)return"";if(!ht)return ut&&ut.error("createSeoPath - productName was not passed in"),"";var ft=n(ht,pt,mt),gt=ft.romanProductName,vt=ft.romanBrandName,bt=i(gt),yt=i(vt);return"".concat(yt,"/").concat(bt)}}})),define("ProductUtils/UrlUtils",["PageConfig","ProductUtils/NewRelicLogger","asos-web-seo-path","ProductUtils/Window"],(function(ut,ht,pt,mt){return function(){var ft=pt();this.formatUrl=function(ut){return ut?"http"===ut.substring(0,4)?ut.replace("http:","https:"):"/"===ut.substring(0,1)?ut:"//"+ut:ut},this.getUrlParam=function(ut,ht){ht||(ht=mt.location.href),ut=ut.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var pt=new RegExp("[\\?&]"+ut+"=([^&#]*)","i").exec(ht);return null===pt?null:decodeURIComponent(pt[1].replace(/\+/g," "))},this.getVariantFromUrl=function(ut,ht){var pt=ut.split("?")[0];if((pt=null!=pt?pt.split("/prd/"):null).length>0&&(pt=parseInt(pt[1])),pt||(pt=parseInt(this.getUrlParam("iid",ut))),!pt)return null;for(var mt=0;mt<ht.length;mt++)if(ht[mt].variantId===pt)return ht[mt];return null},this.getProductUrl=function(pt,mt,gt){if(!gt)return ht.logError(new TypeError("ProductId was not provided")),ut.siteDomain;var vt="";return pt&&mt?vt="/"+ft(pt,mt,ut.language):ht.logError(new TypeError("missing brand name or product name, returning generic link"),{productId:gt}),ut.siteDomain+vt+"/prd/"+gt}}})),define("ProductUtils/FeatureTracking",["Providers/FeaturesProvider","ProductUtils/UrlUtils","ProductUtils/Window"],(function(ut,ht,pt){return{onPageLoadStart:function(){var mt,ft=pt.asos.pdp.config.featuresCtaTracking,gt=(new ht).getUrlParam("ctaRef"),vt=gt&&gt.split("_")[0];vt&&ft&&ft.map((function(ut){vt.toLowerCase()!==ut.matchCta.toLowerCase()||mt||(mt=ut)})),mt&&ut.onReady().then((function(){ut.track(mt.trackingKey)}))}}})),define("Models/VariantDecorator",[],(function(){function t(ut,ht){for(var pt=0;pt<ut.length;pt++)if(ht(ut[pt]))return pt}return function(){this.getData=function(ut,ht){ht=void 0!==ht&&ht;var pt=void 0!==ut.productImage?[ut.productImage]:ut.images,mt={};if(pt)for(var ft=0;ft<pt.length;ft++){var gt=pt[ft];if(gt.colourWayId)void 0===mt[gt.colourWayId]&&(mt[gt.colourWayId]=gt.colour)}var vt=ut.variants;vt.sort((function(ut,ht){var pt=ht.colour.localeCompare(ut.colour);return 0===pt?ht.sizeOrder-ut.sizeOrder:pt}));for(var bt,yt=ut.productId?ut.productId:ut.id,St=vt.length,wt={},xt={productId:yt,colours:[],isInStock:!1,price:ut.productPrice},It=0;St--;){var Pt=vt[St];Pt.productId=yt,Pt.ratings=ut.ratings,Pt.brandName=ut.brandName,void 0===xt.hasDifferentPrices&&(ht||Pt.isInStock)&&(void 0===bt?bt=Pt.price.current:Pt.price.current.value!==bt.value&&(xt.hasDifferentPrices=!0));var Tt=Pt.isInStock;Pt.colourName=mt[Pt.colourWayId];var zt=wt[Pt.colour];void 0===zt&&(xt.colours.push({colour:Pt.colour,colourName:Pt.colourName,variants:[],colourWayId:Pt.colourWayId}),zt=wt[Pt.colour]={index:It,variantsInStock:0},It++),Tt&&(zt.variantsInStock++,xt.isInStock||(xt.isInStock=!0)),xt.colours[zt.index].variants.push(Pt),(void 0===zt.lowestPrice||zt.lowestPrice.value>Pt.price.current.value)&&(zt.lowestPrice=Pt.price.current)}for(var Ct=Object.keys(wt),Et=Ct.length-1;Et>=0;Et--){var kt=Ct[Et],At=wt[kt],Vt=t(xt.colours,(function(ut){return ut.colour===kt}));ht||0!==At.variantsInStock?xt.colours[Vt].price=At.lowestPrice:xt.colours.splice(Vt,1)}return xt}}})),define("text",{load:function(ut){throw new Error("Dynamic load not allowed: "+ut)}}),define("text!Components/product-image/product-image.html",[],(function(){return'<div class="grid-row">\n  <img class="mix-match-item-thumbnail" data-bind="attr: {\n        alt: \'\',\n        src: source,\n        srcset: sourceSet,\n        sizes: size + \'px\'\n        }" />\n</div>\n'})),define("ProductUtils/ImagePresets",["PageConfig"],(function(ut){return{getImageSource:function e(ht,pt,mt){return ht+ut.imagePresets[mt][pt]},getImageSourceSet:function i(ht,pt,mt){return Object.keys(ut.imagePresets[mt]).filter((function(ut){return ut>=pt})).map((function(pt){return ht+ut.imagePresets[mt][pt]+" "+pt+"w"})).join(",")}}})),define("Components/product-image/product-image",["text!./product-image.html","ProductUtils/ImagePresets"],(function(ut,ht){return{viewModel:function i(ut){this.imgUrl=ut.imgUrl,this.size=ut.size,this.state=ut.state,this.productId=ut.productId,this.context=ut.context,this.productData=ut.productData,this.source=ht.getImageSource(this.imgUrl,this.size,ut.type),this.sourceSet=ht.getImageSourceSet(this.imgUrl,this.size,ut.type)},template:ut}})),define("text!Components/social-share/social-share.html",[],(function(){return'<button\n    class="link social-share-icon"\n    id="social-share-button"\n    data-bind="click: toggleShareIcons, clickBubble: false, attr: { \'aria-expanded\': isVisible() ? \'true\' : \'false\', \'aria-label\': state.resources.pdp_cta_social_share }"\n    aria-controls="share-bar"\n>\n    <span class="product-share-icon"></span>\n</button>\n<div class="share-bar-wrap" data-bind="visible: isVisible">\n    <div class="triangle-up"></div>\n    <ul id="share-bar" aria-labelledby="social-share-button">\n        \x3c!-- ko if : isRussia --\x3e\n        <li tabindex="-1"><a data-bind="attr: { href: vkLink }, click: handleClick" data-id="vk" aria-label="vk" class="product-vk-icon"></a></li>\n        \x3c!-- /ko --\x3e\n        <li tabindex="-1"><a data-bind="attr: { href: facebookLink }, click: handleClick" data-id="facebook" aria-label="facebook" class="product-facebook-icon"></a></li>\n        <li tabindex="-1"><a data-bind="attr: { href: pinterestLink }, click: handleClick" data-id="pinterest" aria-label="pinterest" class="product-pinterest-icon"></a></li>\n        \x3c!-- ko if : isMobile --\x3e\n        <li tabindex="-1"><a data-bind="attr: { href: whatsappLink }, click: handleClick" data-id="whatsapp" aria-label="whatsapp" class="product-whatsapp-icon"></a></li>\n        <li tabindex="-1"><a data-bind="attr: { href: emailLink }, click: fireAnalytics" data-id="email" aria-label="email" class="product-email-icon"></a></li>\n        \x3c!-- /ko --\x3e\n    </ul>\n</div>\n'})),define("ProductUtils/Analytics/Utils/Common",["ProductUtils/UrlUtils"],(function(ut){function r(ut,ht){return/.*;;;;evar/i.test(ut)?Array.isArray(ht)?ht.forEach((function(ht){ut=ut+"|"+ht})):ut=ut+"|"+ht:Array.isArray(ht)?ht.forEach((function(ht){ut=ut+"|"+ht})):ut=ut+";;;;"+ht,ut}var ht=new ut;return{getChannel:function e(){var ut=ht.getUrlParam("SearchQuery"),pt=ht.getUrlParam("cid");if(pt)return pt;if(null!==ut)return"search";var mt=ht.getUrlParam("ctaref");if(mt){if(/bag/i.test(mt))return"basket page";if(/saved items/i.test(mt))return"saved items";if(/wishlists/i.test(mt))return"wishlists"}return"product page"},getLinkTrackEvents:function i(ut){return ut.map((function(ut){return ut.split("=")[0]}))},getGlobalEvars:function n(){return["eVar1","eVar6","eVar10","eVar15","eVar17","eVar18","eVar19","eVar20","eVar29","eVar30","eVar45","eVar47","eVar60","eVar61","eVar69","eVar112","eVar113"]},addMerchEVarToProducts:function s(ut,ht,pt){return(ut||"").split(",;").map((function(ut){if(pt){var mt=ut.split(";;;;")[0];return";"===mt[0]&&(mt=mt.substr(1)),mt===String(pt)?r(ut,ht):ut}return r(ut,ht)})).join(",;")},getProductAreaAttribute:function a(ut){return{oosproduct:"oos product page",main:"product page"}[ut.toLowerCase()]},getAsosFulfilsPrefix:function o(ut,ht){return ut&&"asos"!==ut&&ht!==ut?"afs - ":""}}})),define("ProductUtils/calculateDiscount",[],(function(){return function(ut,ht){return Math.floor((1e3*ht-1e3*ut)/(10*ht)).toString()}})),define("ProductUtils/Analytics/Utils/GetAndPersistValue",[],(function(){return function(ut){var ht=window.s.getAndPersistValue(null,ut);return"no value"===ht||""===ht?null:ht}})),define("ProductUtils/Analytics/AddToBag",["PageConfig","ProductUtils/Analytics/Utils/Common","ProductUtils/calculateDiscount","ProductUtils/Analytics/Utils/GetAndPersistValue"],(function(ut,ht,pt,mt){return function(ft){function a(){!function r(ut,pt,mt,ft,gt,vt){ut.events=gt.join(","),pt.linkTrackVars=mt.setLinkTrackVars(vt),pt.linkTrackEvents=mt.setLinkTrackEvents(ht.getLinkTrackEvents(gt)),ut.tl(!0,"o",ft,pt)}(gt,vt,bt,St,xt,It)}for(var gt=window.s,vt={},bt=ft.commons,yt=ft.context.toLowerCase(),St="add to bag",wt=[],xt=[],It=["products","prop38","eVar66","eVar67","prop75","eVar91","eVar92","eVar151","eVar152"].concat(ht.getGlobalEvars()),Pt=0;Pt<ft.variants.length;Pt++)wt.push(ft.variants[Pt].variantId);gt.products=";"+wt.join(",;");var Tt=ht.getProductAreaAttribute(ft.addToBagType);if(gt.eVar92=Tt,gt.products=ht.addMerchEVarToProducts(gt.products,"eVar6="+gt.eVar6),gt.products=ht.addMerchEVarToProducts(gt.products,"eVar13="+Tt),"mix&match"===ut.pageType){"main"===ft.addToBagType&&(gt.products=ht.addMerchEVarToProducts(gt.products,"eVar182=mix & match"));for(var zt=0;zt<ft.variants.length;zt++)gt.products=ht.addMerchEVarToProducts(gt.products,"eVar195=mix&match rating and review impression "+Boolean(ft.variants[zt].ratings),ft.variants[zt].variantId)}else{for(var Ct="asos",Et="primary",kt=0,At=null;kt<ft.variants.length;kt++)(At=ft.variants[kt]).source&&(Et=At.source.id),At.seller&&(Ct=At.seller.id.toLowerCase());if(ft.variants.length){var Vt=ht.getAsosFulfilsPrefix(Ct,Et.toLowerCase());gt.products=ht.addMerchEVarToProducts(gt.products,"eVar211="+Vt+Et.toLowerCase(),At.variantId),gt.eVar212&&(gt.products=ht.addMerchEVarToProducts(gt.products,"eVar213="+gt.eVar212)),gt.products=ht.addMerchEVarToProducts(gt.products,"eVar215="+Vt+Ct.toLowerCase(),At.variantId)}ft.saveCount&&ft.saveCount.isShowing&&(gt.products=ht.addMerchEVarToProducts(gt.products,"eVar228="+ft.saveCount.value))}if(ft.variants.length&&(gt.products=ht.addMerchEVarToProducts(gt.products,"eVar184="+ft.variants[0].sizeGuideOpened()+"-"+ft.variants[0].brandName)),"addtobagerror"===yt?(St="add to bag error",xt.push("event149"),gt.prop38=ft.errorId+"|"+ft.errorCode):(xt.push("event150="+ft.variants.length),xt.push("event151="+function s(ut){return ut.reduce((function(ut,ht){return ut+(void 0===ht.price.current?ht.price:ht.price.current.value)}),0)}(ft.variants)),xt.push("scAdd"),xt.push("scOpen")),"product page"===Tt){if(ft.variants.length){if(ft.ratings&&Object.keys(ft.ratings).length){var _t=(ft.ratings.averageOverallRating/5).toFixed(2),Mt=ft.ratings.totalReviewCount;if(gt.products=ht.addMerchEVarToProducts(gt.products,["eVar189="+_t,"eVar190="+Mt]),xt.push("event257="+_t),xt.push("event258="+Mt),ft.ratings.percentageRecommended){var Lt=ft.ratings.percentageRecommended;gt.products=ht.addMerchEVarToProducts(gt.products,"eVar191="+Lt),xt.push("event259="+Lt)}if(ft.ratings.mostRecent){var Dt=(ft.ratings.mostRecent.rating/5).toFixed(2);gt.products=ht.addMerchEVarToProducts(gt.products,"eVar202="+Dt),xt.push("event274="+Dt)}if(ft.ratings.subRatings&&ft.ratings.subRatings.length){var Rt=ft.ratings.subRatings[0],Ot=(Rt.percentage/100).toFixed(2);gt.products=ht.addMerchEVarToProducts(gt.products,"eVar192="+Rt.id+" "+Ot),xt.push("event260="+Ot)}}else if(ft.ratings&&"product"===ut.pageType){var Ft="value not in response";gt.products=ht.addMerchEVarToProducts(gt.products,["eVar189="+Ft,"eVar190="+Ft,"eVar191="+Ft,"eVar192="+Ft,"eVar202="+Ft])}if(ft.variants[0].priceObj.rrp)var Ut=ft.variants[0].priceObj.rrp.value;var Bt=ft.variants[0].priceObj.current.value;if(Ut)gt.eVar161=pt(Bt,Ut);else{var Nt=ft.variants[0].priceObj.previous.value;gt.eVar161=pt(Bt,Nt)}ft.variants[0].sellingFast&&(gt.products=ht.addMerchEVarToProducts(gt.products,"eVar151=selling fast"))}if(gt.eVar230){var qt=mt("gpv_eVar243");gt.products=ht.addMerchEVarToProducts(gt.products,"eVar243="+qt)}gt.gpv_eVar234&&(gt.products=ht.addMerchEVarToProducts(gt.products,"eVar234="+gt.gpv_eVar234)),It=It.concat(["prop36","eVar50","eVar51","eVar150","eVar161","eVar231"]),a()}else a()}})),define("ProductUtils/Analytics/PageInteraction",["Promise","Providers/FeaturesProvider","ProductUtils/Analytics/Utils/Common","ProductUtils/Window"],(function(ut,ht,pt,mt){return function(ft){function r(ut){St.events=bt.join(","),gt.linkTrackVars=vt.setLinkTrackVars(["prop15","eVar183"].concat(pt.getGlobalEvars())),gt.linkTrackEvents=vt.setLinkTrackEvents(pt.getLinkTrackEvents(bt)),St.tl(!0,"o",ut,gt)}function p(ut){var ht=ut.filter((function(ut){return ut.id===ft.eventData.productIID||void 0}));return ht.length>0?ht[0].variants:[]}function g(){wt.then((function(ut){ut&&(St.prop15=yt,r(yt))}))}var gt={},vt=ft.commons,bt=[],yt=ft.eventData.context.toLowerCase(),St=mt.s,wt=new ut((function(ut){ht.onReady().then((function(){var pt=ht.getFeature("pdp-track-product-image-interactions");ut(pt.isEnabled())}))}));ft.eventData.productIID&&(St.products=";"+ft.eventData.productIID),bt.push("event18");var xt={socialshare:function o(){var ut="social share intent";ft.eventData.socialPlatform&&(ut=ut.concat("|"+ft.eventData.socialPlatform)),St.prop15=ut,r("social share")},launchsizeguide:function u(){St.prop15="launch size guide",bt.push("event103"),r("size guide click")},freedeliveryandreturns:function d(){St.prop15="free delivery and returns",bt.push("event95"),r("free delivery and returns click")},shippingrestrictions:function l(){void 0===mt.trackingShippingRestrictionsClick&&(mt.trackingShippingRestrictionsClick=1,St.prop15="shipping restrictions",r("shipping restrictions click"))},showmore:function a(){void 0===mt.trackingEventMore&&(mt.trackingEventMore=1,St.prop15="show more",r("show more click"))},showless:function c(){void 0===mt.trackingEventLess&&(mt.trackingEventLess=1,St.prop15="show less",r("show less click"))},openmodal:function m(){var ut=mt.asos.pdp.config.product.products,ht=function h(ut){return ut.filter((function(ut){return!0===ut.isInStock})).length}(p(ut)),pt=p(ut).length,gt=0===pt?"0":(100*(ht/pt)).toFixed(2)+"%|";ft.eventData.modalType&&"mixAndMatch"===ft.eventData.modalType&&(St.prop15="mix and match|open modal",St.eVar31=p(ut).length+"|"+ht+"|"+gt+"null|null|null|null|null|null"),r("mix and match modal click")},chevronclick:function f(){wt.then((function(ut){ut&&void 0===mt.trackingChangeThumbnail&&(mt.trackingChangeThumbnail=1,St.prop15="product chevron click",r("product chevron click"))}))},"360launch":g,"360zoom":g,thumbnailclick:g,video:function v(){wt.then((function(ut){ut&&(St.prop15="video progress "+ft.eventData.videoEvent,r(yt))}))},ingredientsbuttonclick:function b(){St.prop15="ingredients list",r(yt)}};xt[yt]()}})),define("ProductUtils/Analytics/Utils/PageLoad",["ProductUtils/Window","Promise"],(function(ut,ht){return new ht((function(ht){ut.asos.eventBus.addListener("pageLoadAnalyticsFired",(function(){ht()}))}))})),define("ProductUtils/Analytics/CustomLinkEvent",["ProductUtils/Analytics/Utils/Common","ProductUtils/Window","ProductUtils/Analytics/Utils/PageLoad","PageConfig"],(function(ut,ht,pt,mt){return function(ft){function r(ht,mt,ft){pt.then((function(){bt.events=mt.join(",");var pt={linkTrackVars:gt.setLinkTrackVars(ft.concat(ut.getGlobalEvars())),linkTrackEvents:gt.setLinkTrackEvents(ut.getLinkTrackEvents(mt))};bt.tl(!0,"o",ht,pt)}))}var gt=ft.commons,vt=ft.eventName.toLowerCase(),bt=ht.s,yt={fireflexfulfilmentanalyticsevent:function o(){var ht="primary",pt="asos",gt=[],vt=ft.variant.source,yt=ft.variant.seller,St=!1;if(vt&&(ht=vt.id.toLowerCase(),-1===gt.indexOf("event288")&&(gt.push("event288"),St=!0)),yt&&(pt=yt.id.toLowerCase(),-1===gt.indexOf("event288")&&(gt.push("event288"),St=!0)),"mix&match"===mt.pageType||vt||yt||-1!==gt.indexOf("event303")||(gt.push("event303"),St=!0),St){var wt=ut.getAsosFulfilsPrefix(pt,ht);bt.eVar210=ft.variant.id+":"+wt+ht,bt.eVar214=ft.variant.id+":"+wt+pt,r("sourcing location messaging Impression",gt,["eVar210","eVar212","eVar214"])}}};yt[vt]()}})),define("ProductUtils/Analytics",["ProductUtils/Analytics/AddToBag","ProductUtils/Analytics/PageInteraction","ProductUtils/Analytics/CustomLinkEvent","Providers/FeaturesProvider","ProductUtils/Window"],(function(ut,ht,pt,mt,ft){function r(){return mt.onReady().then((function(){return mt.getFeature("pdp-save-count").isEnabled()}))}return new function(){var mt;window.CommonAnalytics&&(mt=new window.CommonAnalytics),this.firePageInteraction=function(ut){ht({eventData:ut,commons:mt})},this.normalizeError=function(ut,ht){var pt=[{errorCode:null,errorMessage:ht}];return ut.message=Array.isArray(ut.message)?ut.message:pt,ut},this.addVariants=function(ht,pt,gt,vt,bt){ht=void 0===ht.length?[ht]:ht,void 0===gt&&(gt="main"),r().then((function(yt){pt?ut({context:"addToBagError",addToBagType:gt,variants:ht,errorCode:pt.message[0].errorCode,errorId:pt.message[0].errorMessage,commons:mt,ratings:vt,saveCount:yt?bt:null}):(ut({context:"addToBag",addToBagType:gt,variants:ht,commons:mt,ratings:vt,saveCount:yt?bt:null}),ft.asos.eventBus.emit("fireAddToBagMarketingEvent",ht))}))},this.fireFlexFulfilmentAnalyticsEvent=function(ut){pt({commons:mt,eventName:"fireFlexFulfilmentAnalyticsEvent",variant:ut})}}})),define("Components/social-share/social-share",["ko","text!./social-share.html","PageConfig","ProductUtils/Analytics","ProductUtils/NewRelicLogger"],(function(ut,ht,pt,mt,ft){return{viewModel:function r(ht){function r(ut){for(var ht=[],pt=Object.keys(ut),mt=0;mt<pt.length;mt++){var ft=pt[mt];ht.push(ft+"="+encodeURIComponent(ut[ft]))}return ht.join("&")}this.isVisible=ut.observable(!1),this.isMobile="mobile"===pt.platform,this.isRussia="ru"===pt.storeCode.toLowerCase();var gt,vt,bt,yt=ht.data,St=yt.images[0].url,wt=document.querySelector("link[rel=canonical]").href;this.facebookLink="https://www.facebook.com/sharer/sharer.php?"+r({u:wt+"?ctaref=product_share_facebook"}),this.vkLink="http://vk.com/share.php?"+r({url:wt+"?ctaref=product_share_vk"}),this.pinterestLink="https://pinterest.com/pin/create/button/?"+r({url:wt+"?ctaref=product_share_pinterest",media:St,description:yt.name}),this.whatsappLink="https://wa.me/?"+r({text:yt.name+" "+wt+"?ctaref=product_share_whatsapp"}),this.emailLink="mailto:?"+r({subject:yt.name,body:yt.name+" "+wt+"?ctaref=product_share_email"}),this.setClickListener=function(ut){document.addEventListener("click",gt=function(ht){-1===ut.indexOf(ht.target)&&(this.isVisible(!1),document.removeEventListener("click",gt))}.bind(this))}.bind(this),this.setKeydownListener=function(ut,ht,pt){document.addEventListener("keydown",vt=function(mt){27===mt.keyCode&&(ut.focus(),this.isVisible(!1),document.removeEventListener("keydown",vt)),("Tab"===mt.key||9===mt.keyCode)&&(mt.shiftKey?document.activeElement===ht&&(pt.focus(),mt.preventDefault()):document.activeElement===pt&&(ht.focus(),mt.preventDefault()))}.bind(this))}.bind(this),this.fireAnalytics=function(ut,ht){var pt,ft=yt.id+"";return ht&&(pt=ht.target.dataset.id),mt.firePageInteraction({context:"socialShare",socialPlatform:pt,productIID:ft}),!0},this.handleClick=function(ut,ht){this.fireAnalytics(ut,ht),window.open(ht.target.href,"SocialShareWindow","width=700,height=600,resizable,scrollbars=yes,status=1")},this.openSocialShare=function(){var ut=document.activeElement,ht=Array.prototype.slice.call(ut.parentElement.querySelectorAll("#share-bar, #share-bar a")),pt=ht.slice(1),mt=pt[0],ft=pt[pt.length-1];return this.isVisible()?(this.isVisible(!1),void ut.focus()):(bt||(bt=!0,this.fireAnalytics()),this.setClickListener(ht),this.setKeydownListener(ut,mt,ft),this.isVisible(!0),void mt.focus())}.bind(this),this.toggleShareIcons=function(){navigator.share&&this.isMobile?navigator.share({title:yt.name,text:yt.name,url:wt+"?ctaref=product_share_native"}).then(function(){this.fireAnalytics()}.bind(this)).catch(function(ut){ft.logError(ut),this.openSocialShare()}.bind(this)):this.openSocialShare()}.bind(this)},template:ht}})),define("Components/content/content",[],(function(){return{viewModel:function t(ut){this.state=ut.state,this.product=ut.data}}})),define("text!Components/product-gallery/product-gallery.html",[],(function(){return'\x3c!-- ko if: !isMobile--\x3e\n    <div class="gallery-aside-wrapper">\n        \x3c!-- ko if: !preventThumbnailDescription --\x3e\n            <p id="thumbnailsDescription" data-bind="text: state.resources.pdp_media_gallery_thumbnail_instruction"></p>\n        \x3c!-- /ko --\x3e\n\n        <ul class="thumbnails" data-bind="attr: { \'aria-label\': galleryText.thumbnailLabel }" aria-describedby="thumbnailsDescription">\n            \x3c!-- ko foreach: galleryItems--\x3e\n                \x3c!-- ko if: $index() > 0  --\x3e\n                    <li class="image-thumbnail" data-bind="css: { active: $parent.thumbIndex() === $index() }, attr: { \'aria-current\': $parent.thumbIndex() === $index() }">\n                        <button data-bind="click: $parent.selectThumbnail.bind($data, $index())">\n                            <img class="gallery-image" data-bind="attr: imageSources().thumbnail"/>\n                        </button>\n                    </li>\n                \x3c!-- /ko --\x3e\n            \x3c!-- /ko --\x3e\n        </ul>\n\n        \x3c!-- ko if : showInteractiveButtons --\x3e\n            <div class="interactives">\n                <button class="catwalk" data-bind="visible: isVideoButtonVisible(), event: { blur: onVideoButtonBlur }, click: onVideoButtonActivated, attr: { \'aria-current\': isVideoVisible, \'aria-label\': state.resources.pdp_media_video_player_label }">\n                    <span class="interactive-icon product-play" data-bind="css: { \'product-play-filled\': isVideoVisible }"></span>\n                    <span class="interactive-text" data-bind="text: state.resources.pdp_misc_video, css: { \'active\': isVideoVisible }"></span>\n                </button>\n                <button class="spinset" data-bind="visible: isSpinViewerButtonVisible(), click: onSpinViewerButtonActivated, attr: { \'aria-current\': isSpinViewerVisible, \'aria-pressed\': isSpinViewerPressed, \'aria-label\': state.resources.pdp_media_spinset_label }">\n                    <span class="interactive-icon product-360" data-bind="css: { \'product-360-selected\': isSpinViewerVisible }"></span>\n                    <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: state.resources[\'pdp_misc_spinset\']"></span>\n                </button>\n            </div>\n        \x3c!--/ko --\x3e\n\n        \x3c!-- ko if : product && isInStock --\x3e\n            <div class="social-share social-share-gallery" data-bind=\'component: { name: "social-share", params: { state: state, data: product } }\'></div>\n        \x3c!-- /ko --\x3e\n    </div>\n\x3c!-- /ko --\x3e\n\n<div\n    id="product-gallery"\n    class="product-carousel"\n    role="region"\n    tabindex="-1"\n    data-bind="\n        attr: {\n            \'aria-label\': galleryText.carouselLabel, \n            \'id\': productGalleryId\n        }"\n>\n    <div class="gallery-live-region" aria-live="polite">\n        \x3c!-- ko if: ariaLiveText --\x3e\n            <span data-bind="text: ariaLiveText"></span>\n        \x3c!-- /ko --\x3e\n    </div>\n    <div class="window" data-bind="swipe">\n        <div class="selling-fast" data-bind="visible: showSellingFastLabel">\n            <span class="selling-fast__label" data-bind="text: state.resources.pdp_misc_selling_fast"></span>\n        </div>\n        \x3c!-- ko if: !isMixMatch--\x3e\n            <div id="image-overlay-slot"></div>\n        \x3c!-- /ko --\x3e\n        <div class="gallery-images" data-bind="foreach: galleryItems, css: { animate : animate() }, style: { width : galleryWidth, marginLeft : galleryPosition }">\n            <div class="image-container" data-bind="style: { width : $parent.itemWidth, display: $parent.showCarouselControls() ? \'block\' : \'none\'}, css: { \'zoomable\': $parent.imageData(), \'hide-image\': $parent.thumbIndex() !== $index() }, attr: { \'data-gallery-index\': $index, \'aria-hidden\': $parent.thumbIndex() !== $index() }">\n                <div class="asos-media spinset imageviewer" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: $parent.playerParams.scene7, viewer: { zoomFactors: $parent.zoomFactors, baseJpgQlt: 80, zoomJpgQlt: 90, handleLoadingErrors: false, showHint: false, maxPixelRatio: 3 }, api: $parent.imageViewerApis()[$index()], messages: $parent.playerParams.messages } }, visible: $parent.imageViewersVisibility()[$index()]\'></div>\n                <img class="gallery-image" data-bind="attr: imageSources().hero, event: { onload: window.asos.performance.markAndMeasure(\'pdp:gallery_image_\'+$index()+\'_displayed\')}"/>\n            </div>\n        </div>\n        \x3c!-- ko if: showCarouselControls --\x3e\n            <button\n                class="arrow-button arrow-button-right"\n                aria-controls="product-gallery"\n                aria-label="pdp_media_gallery_carousel_next"\n                data-bind="\n                    click:moveRight,\n                    markAndMeasure: \'pdp:gallery_swiping_right_interactive\',\n                    attr: {\n                        \'aria-label\': state.resources.pdp_media_gallery_carousel_next,\n                        \'aria-controls\': productGalleryId\n                    }"\n            >\n                <span aria-hidden="true" class="product-chevron-right-large-outlined"></span>\n            </button>\n            <button\n                class="arrow-button arrow-button-left"\n                aria-controls="product-gallery"\n                aria-label="pdp_media_gallery_carousel_previous"\n                data-bind="\n                    click: moveLeft,\n                    markAndMeasure: \'pdp:gallery_swiping_left_interactive\',\n                    attr: {\n                        \'aria-label\': state.resources.pdp_media_gallery_carousel_previous,\n                        \'aria-controls\': productGalleryId\n                    }"\n            >\n                <span aria-hidden="true" class="product-chevron-left-large-outlined"></span>\n            </button>\n            \x3c!-- ko if: isMobile--\x3e\n                <div class="carousel-bullets">\n                    <ul id="mobile-gallery-bullets" data-bind="foreach: galleryItems, attr: { \'aria-label\': selectImageAlt }">\n                        \x3c!-- ko if: $index() > 0 --\x3e\n                            <li data-bind="css: { active: $parent.thumbIndex() === $index() }">\n                                <button aria-describedby="mobile-gallery-bullets" data-bind="click: $parent.selectThumbnail.bind($data, $index()), attr: { \'aria-current\': ($parent.thumbIndex() === $index()).toString() }"></button>\n                            </li>\n                        \x3c!-- /ko --\x3e\n                    </ul>\n                </div>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n    </div>\n    <div class="asos-media catwalk" style="display: none" data-bind=\'component: { name: "asos-video-player-prod", params: { scene7: playerParams.scene7, player: { startInFullScreen: startVideoInFullScreen, closeOnFullScreenExited: closeVideoOnFullScreenExited, initialLoopCount: 2 }, api: videoPlayerApi, messages: playerParams.messages } }, visible: isVideoVisible\'></div>\n    <div class="asos-media spinset spinviewer" style="display: none" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: playerParams.scene7, viewer: { spinSpeed: spinSpeed, zoomFactors: zoomFactors, reverseVerticalDirection: false, reverseHorizontalDirection: false, baseJpgQlt: 80, zoomJpgQlt: 90, showHint: showSpinViewerContainerHint, useInitialAnimation: true, animationIntervalStart: 100, animationIntervalPeak: 100, animationFramesCount: 5, preloadingTimeout: 30000 }, api: spinViewerApi, messages: playerParams.messages } }, visible: isSpinViewerVisible, css: { "zoomable": isSpinViewerLoadedWithoutErrors }\'></div>\n</div>\n\n\x3c!-- ko if: isMobile--\x3e\n    <div class="gallery-aside-wrapper">\n        <div class="interactives">\n            <div id="looks-button-portal"></div>\n            \x3c!-- ko if : showInteractiveButtons --\x3e\n                <button class="catwalk" data-bind="visible: isVideoButtonVisible(), click: onVideoButtonActivated, attr: { \'aria-current\': isVideoVisible, \'aria-label\': state.resources.pdp_media_video_player_label }">\n                    <span class="interactive-icon product-play" data-bind="css: { \'product-play-filled\': isVideoVisible }"></span>\n                    <span class="interactive-text" data-bind="text: state.resources.pdp_misc_video, css: { \'active\': isVideoVisible }"></span>\n                </button>\n                <button class="spinset" data-bind="visible: isSpinViewerButtonVisible(), click: onSpinViewerButtonActivated, attr: { \'aria-current\': isSpinViewerVisible, \'aria-pressed\': isSpinViewerPressed, \'aria-label\': state.resources.pdp_media_spinset_label }">\n                    <span class="interactive-icon product-360" data-bind="css: { \'product-returns\': isSpinViewerVisible }"></span>\n                    <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: spinViewerLabelText"></span>\n                </button>\n            \x3c!--/ko --\x3e\n        </div>\n    </div>\n\x3c!-- /ko --\x3e\n'})),define("ProductUtils/Browser",["ko","ProductUtils/Window"],(function(ut,ht){function i(){vt(gt.large.matches?ft:gt.medium.matches?mt:pt)}var pt="SMALL_VIEWPORT",mt="MEDIUM_VIEWPORT",ft="LARGE_VIEWPORT",gt={medium:ht.matchMedia("(min-width: 720px)"),large:ht.matchMedia("(min-width: 1024px)")},vt=ut.observable();return gt.medium.addListener(i),gt.large.addListener(i),i(),{isOnline:function n(){return!ht.navigator||ht.navigator.onLine},viewportSize:vt,isUpToViewport:function s(ht){return ut.computed((function(){var ut=!1;switch(ht){case pt:ut=vt()===pt;break;case mt:ut=[pt,mt].indexOf(vt())>-1;break;case ft:ut=[pt,mt,ft].indexOf(vt())>-1}return ut}))},viewports:{SMALL_VIEWPORT:pt,MEDIUM_VIEWPORT:mt,LARGE_VIEWPORT:ft}}})),define("Components/product-gallery/product-gallery",["ko","$","text!./product-gallery.html","PageConfig","hammer","Asos.Utils.MediaPlayers","ProductUtils/Analytics","ProductUtils/UrlUtils","ProductUtils/Browser","ProductUtils/ImagePresets","ProductUtils/Window"],(function(ut,ht,pt,mt,ft,gt,vt,bt,yt,St,wt){return{viewModel:function u(ht){var pt=ht.state;this.product=ht.data.product,this.productGalleryId="product-gallery"+(ht.data.product?"":"-modal");var xt=ht.data.images;this.galleryItems=ut.observableArray(),this.galleryWidth=ut.observable(),this.itemWidth=ut.observable(),this.itemWidthValue=ut.observable(),this.galleryPosition=ut.observable(),this.galleryIndex=ut.observable(0),this.animate=ut.observable(!1),this.thumbIndex=ut.observable(0),this.isInStock=ut.observable(!1),this.isMobile="mobile"===mt.platform,this.ariaLiveText=ut.observable(""),this.isSmallViewport=yt.isUpToViewport(yt.viewports.SMALL_VIEWPORT),this.preventThumbnailDescription=ht.data.preventThumbnailDescription,this.isMixMatch=ht.data.isMixMatch;var It=new bt,Pt={imageChanged:!1,thumbnailClick:!1,imageViewerZoomIn:!1,spinViewerInit:!1,spinViewerSpin:!1,spinViewerZoomIn:!1,videoPlayerInit:!1,videoProgress:{50:!1,100:!1}};this.checkIfInStockAndSetFlag=function(){this.isInStock(!pt.productData||pt.productData.isInStock)},this.getVisibleImages=function(ht){var pt=ht.filter((function(ut){return!0===ut.isVisible}));if(!pt[0].colourWayId||null===pt[0].colourWayId){var mt=ut.utils.arrayFirst(ht,(function(ut){return ut.isPrimary}));if(mt||(mt=ut.utils.arrayFirst(ht,(function(ut){return ut.colourWayId&&null!==ut.colourWayId}))),mt){var ft=pt.indexOf(mt);ft>=0&&pt.splice(ft,1),pt.splice(0,0,mt)}}return pt};var Tt,zt=this.getVisibleImages(xt);this.appendImageSources=function(ht){return ht.map(function(ht,pt){var mt=function(){var ut=0===pt?this.colourOptionImage().url:ht.url;return{thumbnail:{sizes:"40px",alt:this.getThumbnailAlt(pt+1),src:St.getImageSource(ut,40,"thumbnail"),srcset:St.getImageSourceSet(ut,40,"thumbnail")},hero:{sizes:"(max-width: 720px) 100vw, (min-width: 720px) 513px",alt:this.getImageAlt(pt+1),src:St.getImageSource(ut,513,"hero"),srcset:St.getImageSourceSet(ut,513,"hero")}}}.bind(this);return ht.imageSources=0===pt?ut.computed(mt):mt,ht}.bind(this))}.bind(this),this.getThumbnailAlt=function(ut){return pt.resources.pdp_media_gallery_thumbnail_count.replace("%{index}",ut).replace("%{total}",zt.length)}.bind(this),this.getImageAlt=function(ut){return(this.product?this.product.name:ht.data.productName)+", "+pt.resources.pdp_misc_count.replace("%{index}",ut).replace("%{total}",zt.length)}.bind(this),this.selectImageAlt=pt.resources.pdp_media_gallery_select_image,pt.mainImage=this.colourOptionImage=ut.observable(zt[0]),this.init=function(){this.galleryItems(this.shuffleLastImage(this.appendImageSources(zt))),this.galleryWidth(this.getGalleryWidth()),this.itemWidth(this.getItemWidth()),this.setSwipe(),this.setImageViewers(),this.setGalleryPosition(1)},this.setGalleryPosition=function(ut){this.galleryIndex(ut),0===ut?this.thumbIndex(this.galleryItems().length-1):this.thumbIndex(ut),this.galleryPosition("-"+100*Math.abs(this.galleryIndex())+"%")},this.getItemWidth=function(){return 100/this.galleryItems().length+"%"},this.getGalleryWidth=function(){return 100*this.galleryItems().length+"%"},this.shuffleLastImage=function(ut){var ht=ut,pt=ut[ut.length-1];return ht.unshift(pt),ht},this.moveLeft=function(){return this.resetImageViewer(),0===this.galleryIndex()?(this.animate(!1),this.setGalleryPosition(this.galleryItems().length-1),setTimeout(function(){this.animate(!0),this.setGalleryPosition(this.galleryItems().length-2),Pt.imageChanged||(vt.firePageInteraction({context:"chevronClick",productIID:ht.data.id}),Pt.imageChanged=!0)}.bind(this),10),!1):(this.animate(!0),this.setGalleryPosition(this.galleryIndex()-1),Pt.imageChanged||(vt.firePageInteraction({context:"chevronClick",productIID:ht.data.id}),Pt.imageChanged=!0),!1)},this.moveRight=function(){return this.resetImageViewer(),this.galleryIndex()===this.galleryItems().length-1?(this.animate(!1),this.setGalleryPosition(0),setTimeout(function(){this.animate(!0),this.setGalleryPosition(1),Pt.imageChanged||(vt.firePageInteraction({context:"chevronClick",productIID:ht.data.id}),Pt.imageChanged=!0)}.bind(this),10),!1):(this.animate(!0),this.setGalleryPosition(this.galleryIndex()+1),Pt.imageChanged||(vt.firePageInteraction({context:"chevronClick",productIID:ht.data.id}),Pt.imageChanged=!0),!1)},this.selectThumbnail=function(ut,pt){this.exitVideo(),this.exitSpinViewer(),this.resetImageViewer(),this.animate(!1),this.setGalleryPosition(ut),!0===pt||Pt.thumbnailClick||(vt.firePageInteraction({context:"thumbnailClick",productIID:ht.data.id}),Pt.thumbnailClick=!0)}.bind(this),this.trySetColour=function(ut){var ht=function i(ut){for(var ht=-1,pt=0;pt<xt.length;pt++)if(xt[pt].colourWayId===ut){ht=pt;break}return ht}(ut);if(-1!==ht){this.colourOptionImage(xt[ht]),this.exitVideo(),this.exitSpinViewer(),this.setGalleryPosition(1),this.imageViewersVisibility()[1]&&this.initImageViewer(1)}},wt.asos.eventBus.addListener("setProductImage",function(ut){this.trySetColour(ut)}.bind(this)),this.trySetProductImage=function(ut){for(var ht=1,pt=0;pt<xt.length;pt++)if(xt[pt].productId===ut){ht=pt+1;break}this.setGalleryPosition(ht)},this.videoPlayerApi=ut.observable(),this.exitVideo=function(){if(this.isVideoVisible(!1),this.videoPlayerApi()&&this.videoPlayerApi().stop)try{this.videoPlayerApi().stop(),wt.asos.eventBus.emit("videoPlaybackStopped")}catch(ut){console.warn("could not stop video: "+ut)}},this.keydownEventListener=function(){var ut;document.addEventListener("keydown",(ut=function(ht){("Escape"===ht.key||27===ht.keyCode)&&(this.exitVideo(),document.removeEventListener("keydown",ut))}).bind(this))},this.keydownEventListener(),document.body.addEventListener("modalClosed",function(){this.exitVideo()}.bind(this)),this.startVideoInFullScreen=this.isMobile,this.closeVideoOnFullScreenExited=this.isMobile,this.canDisplayVideoButton=ut.observable(!1),this.isVideoVisible=ut.observable(!1),this.playerParams=ht.data.playerParams,this.isVideoButtonVisible=ut.computed(function(){return this.canDisplayVideoButton()&&this.isInStock()}.bind(this)),this.playerParams.messages={errorHeaderText:pt.resources.pdp_media_video_player_error_header,errorMessageText:pt.resources.pdp_media_video_player_error_message,spinsetErrorMessageText:pt.resources.pdp_media_spinset_error_message,refreshButtonText:pt.resources.pdp_media_video_player_refresh_button,unsupportedHeaderText:pt.resources.pdp_media_video_player_unsupported_header,unsupportedMessageText:pt.resources.pdp_media_video_player_unsupported_message,closeButtonText:pt.resources.pdp_media_video_player_close_button,hintDragText:pt.resources.pdp_media_spinset_hint_drag,hintTapText:pt.resources.pdp_media_spinset_hint_tap,zoomHint:pt.resources.pdp_media_gallery_zoom_hint,zoomOneHundred:pt.resources.pdp_media_gallery_zoom_one_hundred,zoomTwoHundred:pt.resources.pdp_media_gallery_zoom_two_hundred,zoomFourHundred:pt.resources.pdp_media_gallery_zoom_four_hundred},this.onVideoButtonActivated=function(){Pt.videoFirstPlaybackCompleted=!1,this.isVideoVisible()||(this.resetImageViewer(),this.isVideoVisible(!0),this.exitSpinViewer(),this.videoPlayerApi().start(Tt),wt.asos.eventBus.emit("videoPlaybackStarted"),this.ariaLiveText(pt.resources.accessibility_pdp_video_playing),Pt.videoPlayerInit||(vt.firePageInteraction({context:"video",productIID:ht.data.id,videoEvent:"start"}),Pt.videoPlayerInit=!0))},this.onVideoButtonBlur=function(){this.ariaLiveText("")},this.videoPlayerApi.subscribe(function(ut){ut.events.on("playerExitRequested allLoopsEnded",function(){this.exitVideo()}.bind(this)),ut.events.on("progress",(function(ut,pt){if(pt.detail.value)for(var mt in Pt.videoProgress){var ft=parseInt(mt,10);!Pt.videoProgress[mt]&&pt.detail.value>=ft&&(Pt.videoProgress[mt]=!0,vt.firePageInteraction({context:"video",productIID:ht.data.id,videoEvent:mt}))}}));var pt={formats:["mp4"],preferredFPS:25,preferredBitrates:{720:12e3}};ht.data.useProductIdForVideos?ut.loadAssets(ht.data.id,pt,function(){this.canDisplayVideoButton(!0),this.checkIfInStockAndSetFlag()}.bind(this)):ht.data.media&&ht.data.media.catwalkUrl&&gt.getVideoPlayerAssetsProvider(ht.data.playerParams.scene7.videoServer).getAssets(It.formatUrl(ht.data.media.catwalkUrl),pt).then(function(ut){Tt=ut,this.canDisplayVideoButton(!0),this.checkIfInStockAndSetFlag()}.bind(this))}.bind(this)),this.spinViewerApi=ut.observable(),this.exitSpinViewer=function(){this.spinViewerApi()&&this.spinViewerApi().zoomReset(),this.isSpinViewerVisible(!1)},this.spinSpeed=this.isMobile?1.5:3,this.showSpinViewerContainerHint=!this.isMobile,this.zoomFactors=[.5,1],this.isSpinViewerButtonVisible=ut.observable(!1),this.isSpinViewerVisible=ut.observable(!1),this.isSpinViewerPressed=ut.computed(function(){return this.isMobile?this.isSpinViewerVisible().toString():void 0}.bind(this)),this.isSpinViewerLoadedWithoutErrors=ut.observable(!1),this.spinViewerLabelText=ut.observable(pt.resources.pdp_misc_spinset),this.onSpinViewerButtonActivated=function(){this.spinViewerLabelText(pt.resources.pdp_misc_gallery),this.isSpinViewerVisible()?this.isMobile&&(this.spinViewerLabelText(pt.resources.pdp_misc_spinset),this.exitSpinViewer()):(this.resetImageViewer(),this.exitVideo(),this.isSpinViewerVisible(!0),this.spinViewerApi().init(),Pt.spinViewerInit||(vt.firePageInteraction({context:"360Launch",productIID:ht.data.id}),Pt.spinViewerInit=!0))},this.spinViewerApi.subscribe(function(ut){if(ht.data.media&&ht.data.media.threeSixtyUrl&&ht.data.media.threeSixtyUrl.length>0){ut.events.on("zoomedIn",(function(){Pt.spinViewerZoomIn||(vt.firePageInteraction({context:"360Zoom",productIID:ht.data.id}),Pt.spinViewerZoomIn=!0)})),ut.events.on("allImagesLoaded",function(ut,ht){ht&&this.isSpinViewerLoadedWithoutErrors(ht)}.bind(this));var mt=ht.data.id;ut.loadAssets(mt,function(){this.isSpinViewerButtonVisible(!pt.productData||pt.productData.isInStock)}.bind(this))}}.bind(this)),this.showCarouselControls=ut.computed(function(){return!this.isVideoVisible()&&!this.isSpinViewerVisible()}.bind(this)),this.imageData=ut.observable(),this.imageViewerApis=ut.observableArray([]),this.imageViewersVisibility=ut.observableArray([]),this.areAllImageViewerApisReady=function(){for(var ut=0;ut<this.imageViewerApis().length;ut++)if(!this.imageViewerApis()[ut]())return!1;return!0},this.initImageViewer=function(ut){var pt=this.imageViewersVisibility(),mt=this.imageData(),ft=this.imageViewerApis()[ut](),gt=ht.data.rootElement.querySelector('.image-container[data-gallery-index="'+ut+'"] img.gallery-image');if(gt.complete){if(gt.complete&&ft&&mt){pt[ut]=!0,this.imageViewersVisibility(pt);var vt=gt.cloneNode();vt.style.visibility="visible",ft.setAssets(mt[this.getImageIndexFromGalleryIndex(ut)]),ft.init(null,vt),gt.style.visibility="hidden"}}else gt.onload=this.initImageViewer.bind(this,ut)},this.loadImagesMetadata=function(ut){gt.getSpinViewerAssetsProvider(ht.data.playerParams.scene7.imageServer).getAssets(ut,function(ut){this.imageData(ut),this.checkIfInStockAndSetFlag()}.bind(this))},this.imageData.subscribe(function(ut){if(ut)for(var ht=0;ht<this.imageViewerApis().length;ht++)this.initImageViewer(ht)}.bind(this)),this.onImageViewerApiReady=function(ut){var pt=ht.data.rootElement.querySelector('[data-gallery-index="'+ut+'"]');this.imageData()&&this.initImageViewer(ut,pt)},this.getImageIndexFromGalleryIndex=function(ht){var pt=1===ht?this.colourOptionImage():this.galleryItems()[ht],mt=ut.utils.arrayFirst(xt,(function(ut){return ut.url===pt.url}));return xt.indexOf(mt)},this.setImageViewers=function(){for(var ht,pt=this.galleryItems(),mt=[],ft=0;ft<xt.length;ft++)mt.push(xt[ft].url);for(ft=0;ft<pt.length;ft++)ht=ut.observable(),this.imageViewerApis.push(ht),this.imageViewersVisibility.push(!1),ht.subscribe(this.onImageViewerApiReady.bind(this,ft));this.loadImagesMetadata(mt)},this.resetImageViewer=function(){var ut=this.imageViewerApis()[this.galleryIndex()]&&this.imageViewerApis()[this.galleryIndex()]();ut&&ut.zoomReset()},this.setSwipe=function(){if(window.addEventListener){var ut=document.querySelector(".product-gallery .window"),ht=new ft(ut,{inputClass:ft.TouchInput});ht.on("swipeleft",function(){this.moveRight()}.bind(this)),ht.on("swiperight",function(){this.moveLeft()}.bind(this))}},this.showSellingFastLabel=ut.computed(function(){var ut=!this.isVideoVisible()&&!this.isSpinViewerVisible();return this.isInStock()&&ht.state.sellingFast&&ut}.bind(this)),this.galleryText={thumbnailLabel:pt.resources.pdp_media_gallery_thumbnail_label,carouselLabel:pt.resources.pdp_media_gallery_carousel_label},this.showInteractiveButtons=ut.computed(function(){return!!this.isInStock&&(this.isVideoButtonVisible()||this.isSpinViewerButtonVisible())}.bind(this)),this.init(),wt.asos.eventBus.emit("GalleryInitialised")},template:pt}})),define("ProductUtils/ScrollTo",["$","ko"],(function(ut,ht){return this.scrollToElement=function(ht,pt){var mt=ut(ht);mt.length>0&&ut("html, body").animate({scrollTop:mt.offset().top+pt+"px"},"fast")},this.scrollToTop=function(){ut("html, body").animate({scrollTop:"0px"},"fast")},ht.bindingHandlers.scrollTo={init:function(pt,mt){var ft=mt(),gt=ht.unwrap(ft),vt=gt,bt=0;"object"==typeof gt&&(vt=gt.selector,gt.topPadding&&(bt=gt.topPadding)),ut(pt).click(function(){this.scrollToElement(vt,bt)}.bind(this))}},ht.bindingHandlers.scrollToTop={init:function(ht){ut(ht).click(function(){this.scrollToTop()}.bind(this))}},this})),define("ProductUtils/Performance",["ko"],(function(ut){ut.bindingHandlers.markAndMeasure={init:function(ht,pt){var mt=ut.unwrap(pt());window.asos.performance.markAndMeasure(mt)}}})),define("Pages/FullProduct",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","ProductUtils/FeatureTracking","Models/VariantDecorator","Components/product-image/product-image","Components/social-share/social-share","Components/content/content","Components/product-gallery/product-gallery","PageConfig","ProductUtils/NewRelicLogger","Components/product-gallery/product-gallery","ProductUtils/ScrollTo","ProductUtils/Performance"],(function(ut,ht,pt,mt,ft,gt,vt,bt,yt,St,wt,xt){return this.init=function(){function n(){zt||(Tt.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},Pt,this.state),ut.components.register("product-gallery",St),ut.components.register("product-image",vt),ut.components.register("social-share",bt),ut.components.register("asos-video-player-prod",pt.videoPlayer),ut.components.register("asos-spin-viewer-prod",pt.spinViewer),zt=!0)}xt.init(xt.PAGE_TYPE.PRD),ft.onPageLoadStart();var mt=window.asos.pdp.config.product,gt=window.asos.pdp.config.translations,yt=window.asos.pdp.config.ratings,It=window.asos.pdp.config.product.saveCount,Pt="string"==typeof mt?JSON.parse(mt):mt,Tt=new ht;this.isMobile="mobile"===wt.platform,Pt||xt.logError(new Error(xt.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"}),this.state={resources:gt,features:window.asos.pdp.config.features,gender:Pt.gender,sellingFast:Pt.sellingFast,ratings:yt,saveCount:It,hasVariantsWithIngredients:Pt.hasVariantsWithIngredients};var zt=!1;document.addEventListener("DOMContentLoaded",function(){n.call(this)}.bind(this)),document.getElementById("gallery-content")&&n.call(this)},this.init})),window.location.href.includes("/prd/")&&require(["Pages/FullProduct"],(function(ut){ut()})),define("text!Components/product-price/product-price.html",[],(function(){return'<div class="grid-row rendered price-container" data-testid="product-price">\n  <span class="sr-in-doc-flow" aria-live="polite" data-bind="text: getAriaLabel()"></span>\n  <div aria-hidden="true">\n    <div class="current-price">\n      <span data-testid="current-price" data-bind="text: priceText, markAndMeasure: \'pdp:price_displayed\', css: { discounted: isDiscountedPrice }" class="current-price-text"></span>\n      \x3c!-- ko if: showGermanVatMessage --\x3e\n      <span data-testid="german-vat-message" data-bind="text: i18n.pdp_misc_vat_message" class="product-german-vat"></span>\n      \x3c!-- /ko --\x3e\n    </div>\n    <div>\n      \x3c!-- ko if: showLowestPrice30Days() --\x3e\n      <span data-bind="text: lowestPrice30DaysText" class="previous-price-text"></span>\n      <span data-bind="text: lowestPrice30DaysPercentage, css: { discounted: lowestPrice30DaysPercentageHighlight }" class="previous-price-text"></span>\n      \x3c!-- /ko --\x3e\n    </div>\n    <div>\n      \x3c!-- ko if: showRrpPrice() --\x3e\n      <span data-bind="text: rrpPriceText" class="previous-price-text"></span>\n      \x3c!-- /ko --\x3e\n      \x3c!-- ko if: showPrevPrice() --\x3e\n      <span data-bind="text: prevPriceText" class="previous-price-text"></span>\n      \x3c!-- /ko --\x3e\n      \x3c!-- ko if: isDiscountedPrice --\x3e\n      <span data-bind="text: \'(\' + discountText() + \')\', visible: !!discountText()" class="price-discount-percent"></span>\n      \x3c!-- /ko --\x3e\n    </div>\n  </div>\n</div>\n'})),define("ProductUtils/Discount",["ko","Providers/FeaturesProvider","ProductUtils/calculateDiscount"],(function(ut,ht,pt){function n(ut,ht){return"-"+pt(ut,ht)+"%"}var mt=ut.observable(!1),ft=[];return ht.onReady().then((function(){mt(ht.getFeature("all-show-discount-label").isEnabled())})),mt.subscribe((function(ut){ut&&ft.forEach((function(ut){ut.observable(n(ut.currentPrice,ut.previousPrice))}))})),{getDiscountText:function s(ut,ht,pt){return mt()?void ut(n(ht,pt)):(ft.push({observable:ut,currentPrice:ht,previousPrice:pt}),ut(""))}}})),define("Components/product-price/product-price",["ko","text!./product-price.html","ProductUtils/Discount","PageConfig"],(function(ut,ht,pt,mt){function r(ut){return null!=ut}return{viewModel:function o(ht){var ft=["FR","DE","ROE","NL","SE","DK","IT","PL","ES","ROW"].indexOf(mt.countryCode)>-1,gt=ht.state,vt=gt.productData;this.i18n=gt.resources,this.showGermanVatMessage=!!ht.showGermanVatMessage;var bt=ut.observable(vt.price);this.showLowestPrice30Days=ut.computed((function(){return!(!ft||!bt())&&(r(bt().lowestPriceInLast30DaysText)&&r(bt().lowestPriceInLast30DaysValue))})),this.lowestPrice30DaysText=ut.computed(function(){return this.showLowestPrice30Days()?this.i18n.lowest_price_last_thirty_days+" "+bt().lowestPriceInLast30DaysText:""}.bind(this)),this.lowestPrice30DaysPercentage=ut.computed(function(){return this.showLowestPrice30Days()?function s(ut){if(isNaN(ut))return"";var ht=-ut;return"("+(ht>0?"+":"")+ht+"%)"}(bt().lowestPriceInLast30DaysPercentage):""}.bind(this)),this.lowestPrice30DaysPercentageHighlight=ut.computed(function(){return this.showLowestPrice30Days()?bt().lowestPriceInLast30DaysPercentage>0:void 0}.bind(this)),this.showRrpPrice=ut.computed((function(){return!!bt()&&bt().isOutletPrice})),this.rrpPrice=ut.computed(function(){return this.showRrpPrice()?bt().rrp:void 0}.bind(this)),this.rrpPriceText=ut.computed(function(){if(!this.rrpPrice())return"";var ut=this.rrpPrice().text;return ut?this.i18n.pdp_price_rrp+" "+ut:""}.bind(this)),this.showPrevPrice=ut.computed(function(){return!!bt()&&(bt().isMarkedDown&&!bt().isOutletPrice)}.bind(this)),this.prevPrice=ut.computed(function(){return this.showPrevPrice()?bt().previous:void 0}.bind(this)),this.prevPriceText=ut.computed(function(){return this.showPrevPrice()?this.i18n.was_pricing_label+" "+this.prevPrice().text:""}.bind(this)),this.showFromLabel=ut.computed((function(){return!(!vt.hasDifferentPrices||gt.selectedSize()&&gt.selectedColour())})),this.price=ut.computed((function(){return bt()?bt().current:void 0})),this.priceText=ut.computed(function(){if(void 0===this.price())return"";var ut="";return(this.showPrevPrice()||this.showRrpPrice())&&(ut=this.i18n.now_pricing_label+" "),this.showFromLabel()&&(ut=this.i18n.pdp_misc_from+" "),ut+this.price().text}.bind(this)),this.isDiscountedPrice=ut.computed(function(){return this.showPrevPrice()||this.showRrpPrice()}.bind(this)),this.discountText=ut.observable("");var yt=function(){this.showRrpPrice()&&this.rrpPrice()?pt.getDiscountText(this.discountText,this.price().value,this.rrpPrice().value):this.showPrevPrice()&&this.prevPrice()&&pt.getDiscountText(this.discountText,this.price().value,this.prevPrice().value)}.bind(this);this.getAriaLabel=ut.computed(function(){var ut=this.priceText();return this.showGermanVatMessage&&(ut=ut.concat(" ",this.i18n.pdp_misc_vat_message_longform||this.i18n.pdp_misc_vat_message)),this.showLowestPrice30Days()&&(ut=ut.concat(". "+this.lowestPrice30DaysText()+" "+this.lowestPrice30DaysPercentage())),this.showPrevPrice()&&(ut=ut.concat(". "+this.prevPriceText())),this.showRrpPrice()&&(ut=ut.concat(". "+(this.i18n.pdp_price_rrp_longform||this.i18n.pdp_price_rrp)," ",this.rrpPrice().text)),this.isDiscountedPrice()&&this.discountText()&&(ut=ut.concat(". ("+this.discountText()+")")),ut}.bind(this)),gt.selectedSize.subscribe(function(ut){bt(ut?ut.price:vt.price),yt()}.bind(this)),yt()},template:ht}})),define("text!Components/add-item/add-item.html",[],(function(){return'<div class="add-item" data-bind="visible: isVisible">\n    <div class="is-add-item-saving" data-bind="visible: isBusy"></div>\n    <span class="aria-live" role="status" aria-live="polite" data-bind="{ text: ariaLiveText }" data-testid="ariaLiveRegion"></span>\n    <button data-bind="click: addToBag, css : buttonCss, attr: { \'id\': isMixMatch ? null : \'product-add-button\', \'aria-label\': resources.pdp_cta_add_to_bag, disabled: isBusy }, markAndMeasure: \'pdp:add_to_bag_interactive\'" data-testid="add-button">\n        <span class="product-tick" data-bind="visible: showProductTick"></span>\n        <span data-bind="text: buttonText"></span>\n    </button>\n</div>\n'})),define("ProductUtils/Analytics/Utils/GetProductBeaconsMapFromStorage",[],(function(){return function(){var ut;try{ut=JSON.parse(sessionStorage.getItem("productBeaconsMap"))||{}}catch(ht){ut={}}return ut}})),define("ProductUtils/Analytics/Utils/SponsoredAdsBeacons",["ProductUtils/Analytics/Utils/GetProductBeaconsMapFromStorage"],(function(ut){var ht="productBeaconsMap";return{sendBeacon:function e(pt,mt){var ft=ut(),gt=ft[pt];if(gt){var vt=gt[mt];vt&&(navigator.sendBeacon(vt),delete gt[mt],0===Object.keys(gt).length&&delete ft[pt],sessionStorage.setItem(ht,JSON.stringify(ft)))}}}})),define("ProductUtils/Bag",["ProductUtils/Analytics","ProductUtils/NewRelicLogger","Providers/SdkProvider","ProductUtils/Analytics/Utils/SponsoredAdsBeacons"],(function(ut,ht,pt,mt){return function(ft,gt){function o(ut,ht){for(var pt in ht)ht.hasOwnProperty(pt)&&(ut[pt]=ht[pt]);return ut}function a(ut){return{productId:ut.productId,colour:ut.colourName,sizeId:ut.sizeId,variantId:ut.variantId,price:ut.price.current.value,priceObj:ut.price,sellingFast:ft.state.sellingFast,ratings:!!ut.ratings,sizeGuideOpened:ft.state.sizeGuideOpened,brandName:ut.brandName,source:ut.source,seller:ut.seller,sku:ut.sku}}return this.error="",void 0!==ft&&(this.error=ft.state.resources.pdp_status_error_max_items),this.addItems=function(ut,ht){pt.getBag().then(function(pt){var mt;if(ut.length>1){var ft=this.formatAddProducts(ut);mt=pt.addVariants(ft),this.watchPromise(mt,ht,ft,gt)}else{var vt=void 0!==ut[0]?ut[0]:ut;vt.colourName=void 0===vt.colourName?vt.colour:vt.colourName;var bt=a(vt);mt=pt.addVariant(bt),this.watchPromise(mt,ht,bt,gt)}}.bind(this))},this.formatErrorMessage=function(ut){var ht=ut.userMessage||"";return ut.hasOwnProperty("messageContext")&&ut.messageContext&&ut.messageContext.length>0&&(ht=ht.replace(/{(\d)}/g,(function(ht,pt){var mt=ut.messageContext[parseInt(pt,10)];return mt||"..."}))),ht},this.watchPromise=function(pt,gt,vt,bt){pt.then((function(){ut.addVariants(vt,!1,bt,ft.state.ratings,ft.state.saveCount);var ht=void 0!==vt[0]?vt[0]:vt;return mt.sendBeacon(ht.productId,"onBasketChangeBeacon"),gt({success:!0,error:""})}),function(pt){pt=ut.normalizeError(pt,ft.state.resources.pdp_status_add_to_bag_failure),ut.addVariants(vt,pt,bt,ft.state.ratings,ft.state.saveCount);var mt,yt={action:"AddToBag"};yt=o(yt,vt),yt=o(yt,pt),yt=o(yt,pt.message[0]),ht.logError(new Error(ht.ERROR_TYPE.UserActionFailed),yt),mt="LegacyQuantityLimitReached"===pt.message[0].errorCode?this.error:this.formatErrorMessage(pt.message[0]),gt({success:!1,error:mt})}.bind(this))},this.formatAddProducts=function(ut){for(var ht=[],pt=0;pt<ut.length;pt++){var mt=a(ut[pt]);mt.colourName=void 0===mt.colourName?mt.colour:mt.colourName,ht.push(mt)}return ht},this}})),define("Components/add-item/add-item",["$","ko","text!./add-item.html","ProductUtils/Bag","ProductUtils/ScrollTo","ProductUtils/Window","PageConfig"],(function(ut,ht,pt,mt,ft,gt,vt){return{viewModel:function a(ut){this.isVisible=ut.state.productData.isInStock,this.imgUrl=ut.productImage,this.scrollToTop=ut.scrollToTop,this.url=ut.url,this.productId=ut.state.productData.productId,this.isMixMatch=ut.isMixMatch,this.resources=ut.state.resources,this.selectedColour=ut.state.selectedColour,this.selectedSize=ut.state.selectedSize,this.noColourSelected=ut.state.showNoColourSelectedWarning,this.noSizeSelected=ut.state.showNoSizeSelectedWarning,this.focusColourSelect=ut.state.focusColourSelect,this.focusSizeSelect=ut.state.focusSizeSelect,this.preventFocusScroll=ut.state.preventFocusScroll,this.addedToBag=ht.observable(!1),this.showProductTick=ht.observable(!1),this.failedToAdd=ut.state.showAddToBagError,this.failedToAddMessage=ut.state.addToBagErrorMessage,this.showTryAgain=ht.observable(!!ut.showTryAgain&&ut.showTryAgain),this.buttonText=ht.observable(this.resources.pdp_cta_add_to_bag),this.isBusy=ht.observable(!1),this.ariaLiveText=ht.computed((function(){var ut=this.failedToAddMessage();return ut||(this.addedToBag()?this.resources.pdp_status_add_to_bag_success:"")}),this),this.buttonCss=ht.computed(function(){return this.failedToAdd()&&this.showTryAgain()?"failed":""}.bind(this)),this.selectedSize.subscribe(function(ut){this.failedToAdd(!1),void 0!==ut&&this.noSizeSelected()&&this.noSizeSelected(!1)}.bind(this)),this.selectedColour.subscribe(function(ut){this.failedToAdd(!1),void 0!==ut&&this.noColourSelected()&&this.noColourSelected(!1)}.bind(this));var pt,gt=new mt(ut,ut.initiator);this.isValid=function(){return void 0===this.selectedColour()?(this.noColourSelected(!0),!1):void 0!==this.selectedSize()||(this.noSizeSelected(!0),!1)}.bind(this),this.addToBag=function(){this.isBusy()||(this.revertState(),this.isValid()&&(this.isBusy(!0),gt.addItems(this.selectedSize(),this.addToBagResult)))},this.focusUnSelected=function(){void 0===this.selectedColour()?this.focusColourSelect(!0):void 0===this.selectedSize()&&this.focusSizeSelect(!0)}.bind(this),this.addToBagResult=function(ut){this.isBusy(!1),ut.success?(this.addedToBag(!0),this.showProductTick(!0),this.buttonText(this.resources.pdp_status_add_to_bag_success),this.scrollToTop&&"mobile"!==vt.platform&&ft.scrollToTop(),pt&&clearTimeout(pt),pt=setTimeout(this.revertState,5e3)):(this.showTryAgain()&&this.buttonText(this.resources.pdp_status_error_add_item_try_again),this.failedToAdd(!0),this.failedToAddMessage(ut.error||this.resources.pdp_status_add_to_bag_failure))}.bind(this),this.revertState=function(){this.buttonText(this.resources.pdp_cta_add_to_bag),this.addedToBag(!1),this.showProductTick(!1),this.failedToAdd(!1),this.failedToAddMessage(""),this.isBusy(!1)}.bind(this)},template:pt}})),define("text!Components/size-guide/size-guide.html",[],(function(){return'\x3c!-- ko if: render() --\x3e\n<div class="size-guide-button">\n    <button data-testid="size-guide-button" class="link" data-bind="click: openSizeGuide($element), text: text"></button>\n</div>\n\x3c!-- /ko --\x3e\n'})),define("Components/size-guide/size-guide",["ko","text!./size-guide.html","ProductUtils/Window","ProductUtils/Analytics"],(function(ut,ht,pt,mt){return{viewModel:function s(ut){function e(){mt.firePageInteraction({context:"launchSizeGuide",productIID:ut.id})}this.text=ut.dictionary.pdp_size_guide_link,this.render=ut.visible,this.openSizeGuide=function(ht){return function(){e(),pt.asos.eventBus.emit("sizeGuideOpen",{url:ut.url,focusOnClose:ht})}}},template:ht}})),define("text!Components/mix-and-match/mix-and-match.html",[],(function(){return'<div class="product-hero">\n  \x3c!-- ko if: shouldShowProp65 --\x3e\n  <div class="warning-prop65">\n    <div class="iconContainer">\n      <span class="product-warning-prop65 icon"></span>\n    </div>\n    <p data-bind="text: state.resources.prop65_mandm_message_text"></p>\n  </div>\n  \x3c!-- /ko --\x3e\n\n  <div class="separator"></div>\n</div>\n\n<ul>\n  \x3c!-- ko foreach: products --\x3e\n  <li class="item">\n    <a data-bind="attr: { \n          href: $parent.getProductLink($data), \n          \'aria-label\': $parent.productDetailsText \n    }, \n    click: $parent.navigateToFullProduct.bind($data, $index()), $element)\n    ">\n      <div class="product-image" data-bind="component: {\n        name: \'product-image\', \n        params: {\n          imgUrl: productImage.url,\n          type: \'thumbnail\',\n          size: 75\n        }\n      }">\n      </div>\n    </a>\n    <div class="product-info">\n      \x3c!--Product title--\x3e\n      <a\n        data-bind="attr: { href: $parent.getProductLink($data) }, click: $parent.navigateToFullProduct.bind($data, $index())">\n        <div class="product-title" data-bind="text: name"></div>\n        <div class="product-price"\n          data-bind=\'component: { name: "product-price", params: {state: $parent.getState($index()), showGermanVatMessage: $parent.options.showGermanVatMessage }}\'>\n        </div>\n        <div class="mm-rating" data-bind="attr: {id: \'overall-rating-portal-\' + $data.id}"></div>\n      </a>\n      <div data-bind="attr: {id: \'payment-promo-portal-\' + $data.id}"></div>\n      \x3c!-- ko if: $parent.variantIsOOS($index()) --\x3e\n      <span class="out-of-stock" data-bind="text: $parent.state.resources.pdp_status_mix_and_match_out_of_stock"></span>\n      \x3c!-- /ko --\x3e\n      \x3c!-- ko if: !$parent.variantIsOOS($index()) --\x3e\n      <div class="product-colour" data-bind=\'component:{\n        name: "product-colour",\n        params: {\n            isMixAndMatch: true,\n            useShortSelectColourLabel: true,state: $parent.getState($index()),\n            data: $data}\n        }\'></div>\n      \x3c!-- /ko --\x3e\n    </div>\n    \x3c!-- ko if: $parent.variantIsOOS($index()) --\x3e\n    <div class="save-for-later-portal oos" data-bind="attr: {id: \'save-for-later-portal-\' + $data.id}"></div>\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko if: !$parent.variantIsOOS($index()) --\x3e\n    <div data-bind=\'component:{\n      name: "product-size",\n      params: {\n          hideLabels: false,\n          hideLowInStock: false,\n          hideOnOutOfStock: true,\n          showSizeGuide: true,\n          isMixMatch: true,\n          isMobile: $parent.isMobile,\n          doNotSelectDefaultSize: !$parent.isMobile,\n          displayOnlyAsDropDown: !$parent.isMobile,\n          state: $parent.getState($index()),\n          data: $data,\n          context: "mixmatch",\n          selectorIndex: $index(),\n          sizeGuideOpened: $parent.state.sizeGuideOpened\n          }\n      }\'>\n    </div>\n\n    <div data-bind=\'component:{name: "add-item",\n      params:{\n          state: $parent.getState($index()),\n          initiator : "main",\n          isMixMatch: true,\n      }}\'></div>\n    <div class="save-for-later-portal" data-bind="attr: {id: \'save-for-later-portal-\' + $data.id}"></div>\n    \n    <div class="basic-error-box"\n      data-bind="visible: $parent.getState($index()).showAddToBagError, html: $parent.getState($index()).addToBagErrorMessage"\n      style="display: none"></div>\n    \x3c!-- /ko --\x3e\n    <div data-bind="attr: {id: \'delivery-and-returns-portal-\' + ($index())}, template: { afterRender: function() {\n      if($index() === $parent.products.length - 1) {\n          window.asos.pdp.deliveryAndReturnsPortalReady = true; window.asos.eventBus.emit(\'deliveryAndReturnsPortalReady\');\n      }\n    }}" style="float: left; width: 100%">\n    </div>\n    \x3c!-- ko if: ($index() !== $parent.products.length - 1)--\x3e\n    <div class="separator"></div>\n    \x3c!-- /ko --\x3e\n  </li>\n  \x3c!-- /ko --\x3e\n</ul>'})),define("ProductUtils/Cookies",[],(function(){var e=function(ut){var ht=function(ut,ht,pt){var mt={};if(ut)for(var ft=ut.split(ht),gt=0;gt<ft.length;gt++){var vt=ft[gt].indexOf(pt);mt[ft[gt].substr(0,vt).trim()]=ft[gt].substr(vt+1)}return mt}(document.cookie,";","="),pt=ht[ut]||"";return unescape(pt)};return function(){this.getXSiteOrigin=function(){var ut=e("x-site-origin");return ut||null}}})),define("ProductUtils/Ajax",["$","uuid","ProductUtils/Cookies","ProductUtils/NewRelicLogger","ProductUtils/UrlUtils"],(function(ut,ht,pt,mt,ft){return function(){this.execute=function(ht){var gt,vt,bt="ProductPage",yt=new pt,St=new ft;ht.callerContext?bt+="."+ht.callerContext:bt=!1,vt=void 0!==ht.retryCount?ht.retryCount:null,gt=void 0!==ht.authorization?ht.authorization:null,void 0===ht.cache&&(ht.cache=!0);var wt=function r(ut,ht){if(!ht)return ut;var pt="";return Object.keys(ht).sort().forEach((function(mt){var ft=ht[mt];null!=ft&&(ut.indexOf(mt+"=")>-1||(pt+="&"+mt+"="+ft))})),-1===ut.indexOf("?")&&(pt="?"+pt.slice(1)),ut+pt}(ht.url,ht.storeParams),xt={},It=St.getUrlParam("x-site-origin")||yt.getXSiteOrigin();return It&&(xt["x-site-origin"]=It),ut.ajax({cache:ht.cache,url:wt,data:xt,tryCount:0,retryLimit:vt,dataType:ht.dataType,jsonpCallback:ht.jsonpCallback,beforeSend:function(ut){this.addRequestHeaders(ut,bt,gt)}.bind(this),success:function(ut){this.successRequest(ht.successCallback,ut,ht.callbackArgs)}.bind(this),error:function(pt){return mt.logError(new Error(mt.ERROR_TYPE.AjaxError),{apiName:ht.apiName,requestUrl:wt,status:pt.status,caller:ht.callerContext,response:pt.response,xSiteOrigin:It,requestHeaders:pt.headers,responseHeaders:pt.getAllResponseHeaders()}),null!==this.retryLimit&&this.tryCount<=this.retryLimit?(this.tryCount++,void ut.ajax(this)):void this.errorRequest(ht.errorCallback,pt,ht.callbackArgs)}.bind(this)})},this.addRequestHeaders=function(ut,pt,mt){if(ut.headers={},!1!==pt){var ft=ht();ut.setRequestHeader("asos-c-name",pt),ut.setRequestHeader("asos-cid",ft),ut.headers["asos-c-name"]=pt,ut.headers["asos-cid"]=ft}null!==mt&&(ut.setRequestHeader("Authorization",mt),ut.headers.Authorization=mt)},this.successRequest=function(ut,ht,pt){ut&&ut(ht,pt)},this.errorRequest=function(ut,ht,pt){ut&&ut(ht,pt)}}})),define("Components/mix-and-match/mix-and-match",["ko","text!./mix-and-match.html","ProductUtils/Analytics","ProductUtils/UrlUtils","ProductUtils/Window","ProductUtils/Ajax","ProductUtils/NewRelicLogger","PageConfig"],(function(ut,ht,pt,mt,ft,gt,vt,bt){return{viewModel:function c(ht){this.context=ht.data,this.products=ht.data.products,this.state=ht.state,this.options=ht.options,this.isMobile="mobile"===bt.platform,this.showNoSizesSelectedWarning=ht.state.showNoSizesSelectedWarning,this.showAddToBagError=ht.state.showAddToBagError,this.addToBagErrorMessage=this.state.addToBagErrorMessage,this.variants=[],this.isCaliforniaLocated=ut.observable(!1),this.productDetailsText=this.state.resources.pdp_description_product_details_title;for(var vt="Asos.PDP.Prop65.Should.Show",yt=new mt,St=this.products.length;St--;)this.variants.push(this.context.States[St].selectedSize);this.getState=function(ut){return this.context.States[ut]}.bind(this),this.variantIsOOS=function(ut){return!this.getState(ut).productData.isInStock}.bind(this),this.allVariantsOOS=function(){return 0===this.products.filter((function(ut){return!0===ut.isInStock})).length},this.checkSetCaliforniaRegion=function(){var ut=ft.sessionStorage.getItem(vt);return"true"===ut||"false"===ut?void this.isCaliforniaLocated("true"===ut):(this.ajax=new gt,void this.ajax.execute({url:ft.asos.pdp.config.storeApiPath,apiName:"Fashion",callerContext:"Store",storeParams:{keyStoreDataversion:bt.keyStoreDataversion},successCallback:this.regionCheckSuccessCallback}))}.bind(this),this.regionCheckSuccessCallback=function(ut){var ht=!!ut&&ut.some((function(ut){return"US-CA"===ut.region}));ft.sessionStorage.setItem(vt,ht),this.isCaliforniaLocated(ht)}.bind(this),this.shouldShowProp65=ut.computed(function(){return"US"===bt.storeCode&&(!!this.context.hasVariantsWithProp65Risk&&(!this.allVariantsOOS()&&(this.checkSetCaliforniaRegion(),this.isCaliforniaLocated())))}.bind(this)),this.showOverlay=function(ut,ht){pt.firePageInteraction({context:"openModal",modalType:"mixAndMatch",productIID:this.products[ut].id}),ft.asos.eventBus.emit("productModalOpen",ht,this.products[ut].id)}.bind(this),this.getProductLink=function(ut){return yt.getProductUrl(ut.name,this.context.brandName,ut.id)+this.getQueryString()}.bind(this),this.navigateToFullProduct=function(ut){var ht=this.getProductLink(this.products[ut]);this.navigateTo(ht)}.bind(this),this.navigateTo=function(ut){window.location=ut},this.getQueryString=function(){return document.location.search}},template:ht}})),define("text!Components/product-colour/product-colour.html",[],(function(){return'\x3c!-- ko if: render && (colourDropdownVisible() || isMixAndMatch) --\x3e\n<section>\n    <div class="colour-size colour-component">\n        <div class="grid-row colour-section">\n            <label for="colourSelect" class="disabled" data-bind="\n                text: colourLabel,\n                attr: {\n                    \'for\': colourSelectorId\n                }\n            "></label>\n            \x3c!-- ko if: isMixAndMatch --\x3e\n                <span class="product-colour" data-bind="visible: colourLabelVisible(), text: selectedColourLabel(), css: { disabled: isDisabled }"></span>\n            \x3c!-- /ko --\x3e\n            <div class="colour-size-select" data-testid="colour-size-select" data-bind="visible: colourDropdownVisible()">\n                <select id="colourSelect"\n                        data-id="colourSelect"\n                        data-bind="optionsCaption: selectColourText,\n                        disable: isDisabled,\n                        options: data,\n                        optionsAfterRender: setColourOptionText,\n                        value: colour,\n                        css:{ required : noColourSelected()},\n                        attr: {\n                            \'id\': colourSelectorId,\n                            \'data-id\': colourSelectorId,\n                            \'aria-describedby\': noColourSelected() ? \'selectColourError\' : null,\n                            \'aria-invalid\': noColourSelected() ? true : null\n                        }"></select>\n                \x3c!-- ko if: noColourSelected() --\x3e\n                <span id="selectColourError" class="error basic-error-box" data-bind="text:selectColourPrompt"></span>\n                \x3c!-- /ko --\x3e\n            </div>\n        </div>\n    </div>\n</section>\n\x3c!-- /ko --\x3e'})),define("Components/product-colour/product-colour",["ko","text!./product-colour.html","PageConfig","ProductUtils/Window"],(function(ut,ht,pt,mt){return{viewModel:function s(ht){var ft=ht.state,gt="undefined"!==ht.hideOnOutOfStock&&ht.hideOnOutOfStock;this.render=!(gt&&!ft.productData.isInStock),this.noColourSelected=ht.state.showNoColourSelectedWarning,this.focusColourSelect=ht.state.focusColourSelect,this.preventFocusScroll=ht.state.preventFocusScroll,this.isMixAndMatch=ht.isMixAndMatch,this.data=ut.observableArray(),this.colour=ft.selectedColour,this.colour.subscribe((function(ut){mt.asos.eventBus.emit("colourChosen",ut&&ut.colour)})),this.useShortSelectColourLabel=ht.useShortSelectColourLabel,this.selectColourPrompt=ft.resources.pdp_select_colour_message,this.colourLabel=ft.resources.pdp_misc_colour+":",this.isMobile="mobile"===pt.platform,this.notAvailableText=ft.resources.pdp_status_not_available,this.selectorIndex=ht.selectorIndex,this.context=ht.context,this.colourSelectorId="colour-select-"+ft.productData.productId,this.useShortSelectColourLabel?this.selectColourText=ft.resources.pdp_select_colour_label:this.selectColourText=ft.resources.pdp_select_colour_from_label,this.lowInStockText=ft.resources.pdp_status_low_in_stock;var vt=ht.state.productData;this.isDisabled=!ht.state.productData.isInStock;var bt=vt.colours;this.focusColourSelect.subscribe(function(ut){ut&&(document.getElementById(this.colourSelectorId).focus({preventScroll:!!this.preventFocusScroll()}),this.preventFocusScroll(!1),this.focusColourSelect(!1))}.bind(this)),this.noColourSelected.subscribe(function(ut){ut&&this.focusColourSelect(!0)}.bind(this)),this.data(bt),this.selectColourText=this.selectColourText.replace("%{count}",this.data().length),this.colourDropdownVisible=ut.computed(function(){return this.data().length>1}.bind(this)),this.colourLabelVisible=ut.computed(function(){return!this.colourDropdownVisible()}.bind(this)),this.setColourOptionText=function(ut,ht){ht&&(vt.hasDifferentPrices?ut.text=ht.colour+" "+ht.price.text:ut.text=ht.colour)},this.selectedColourLabel=ut.computed(function(){return this.colour()?this.colour().colour:""}.bind(this)),this.setDefaultColour=function(){1===this.data().length&&this.colour(this.data()[0])},this.setDefaultColour(),this.setVariantColour=function(ut,ht){for(var pt=0;pt<ut.length;pt++)if(ut[pt].colourWayId===ht){this.colour(ut[pt]);break}},ht.state.defaultVariant&&this.setVariantColour(this.data(),ht.state.defaultVariant.colourWayId)},template:ht}})),define("text!Components/product-size/product-size.html",[],(function(){return'\x3c!-- ko if: render() --\x3e\n<section>\n    <div class="colour-size size-component">\n        <div class="size-section" data-bind="visible: sizeSectionVisible()">\n            <div style="display: table; width: 100%">\n                <label\n                    for="sizeSelectorId"\n                    style="display: table-cell; vertical-align: bottom"\n                    data-bind="\n                        text: sizeLabel,\n                        visible: sizeDropdownVisible(),\n                        disable: isDisabled,\n                        attr: {\n                            \'for\': sizeSelectorId\n                        }"\n                ></label>\n                <div style="display: table-cell; vertical-align: top; width: 100%">\n                    <div data-testid="size-guide" class="size-guide" style="float: right;" data-bind=\'component: { name: "size-guide", params: { sizeGuideOpened: sizeGuideOpened, dictionary: sizeGuideDictionary , url: sizeGuideLink, visible: state.showSizeGuide, id:id}}\'></div>\n                </div>\n            </div>\n            \x3c!-- ko if: !isOneSize --\x3e\n            <span class="product-size" data-bind="visible: sizeLabelVisible(), text: selectedSizeLabel(), css: { disabled: isDisabled }"></span>\n            \x3c!-- /ko --\x3e\n            <div class="colour-size-select" data-testid="colour-size-select" data-bind="visible: sizeDropdownVisible(), markAndMeasure: \'pdp:size_selector_interactive\'">\n                <select\n                    id="sizeSelectorId"\n                    data-id="sizeSelect"\n                    data-bind="options: variants,\n                        optionsAfterRender: disableSizeIfOutOfStock,\n                        optionsText: \'Size\',\n                        optionsCaption: selectSizeText,\n                        value: size,\n                        disable: isDisabled || sizeDropdownDisabled(),\n                        css:{ required : noSizeSelected() },\n                        attr: {\n                            \'id\': sizeSelectorId,\n                            \'aria-label\': selectSizeText,\n                            \'aria-describedby\': noSizeSelected() ? \'selectSizeError\' : null,\n                            \'aria-invalid\': noSizeSelected()\n                        }"></select>\n                \x3c!-- ko if: noSizeSelected() --\x3e\n                <span id="selectSizeError" class="error basic-error-box" data-bind="text:selectSizePrompt"></span>\n                \x3c!-- /ko --\x3e\n            </div>\n        </div>\n        <div class="grid-row low-in-stock" data-testid="lowInStock" data-bind="visible: isLowInStock() && !hideLowInStock">\n            <span class="clock"></span><span data-bind="text:lowInStockText"></span>\n        </div>\n    </div>\n</section>\n\x3c!-- /ko --\x3e\n'})),define("Components/product-size/product-size",["ko","text!./product-size.html","ProductUtils/Analytics","ProductUtils/Window"],(function(ut,ht,pt,mt){return{viewModel:function s(ht){var ft=ht.data,gt=ht.state,vt="undefined"!==ht.hideOnOutOfStock&&ht.hideOnOutOfStock;this.state=gt,this.noSizeSelected=ht.state.showNoSizeSelectedWarning,this.focusSizeSelect=ht.state.focusSizeSelect,this.preventFocusScroll=ht.state.preventFocusScroll,this.sizeGuideOpened=ht.isMixMatch?ht.sizeGuideOpened:ht.state.sizeGuideOpened,this.sizeGuideDictionary=ht.state.resources,this.sizeGuideLink=ft.sizeGuide,this.colour=gt.selectedColour,this.size=gt.selectedSize,this.alwaysDisplaySizeLabel=!1,this.isLowInStock=ut.observable(!1),this.hideLabels=ht.hideLabels,this.hideLowInStock=ht.hideLowInStock,this.displayOnlyAsDropDown=ht.displayOnlyAsDropDown||!1,this.doNotSelectDefaultSize=ht.doNotSelectDefaultSize||this.displayOnlyAsDropDown,this.id=ft.id,this.isOneSize=ft.isOneSize;var bt=[];this.size.subscribe(function(){var ut=this.size(),ft=null!=ut&&!0===ut.isLowInStock;ut&&-1===bt.indexOf(ut)&&(pt.fireFlexFulfilmentAnalyticsEvent(ut),bt.push(ut));var gt=ht.isMixMatch?ht.selectorIndex:null,vt={variantId:null,productId:this.id,mixAndMatchProductIndex:gt};ut&&(vt={variantId:ut.variantId,productId:ut.productId,mixAndMatchProductIndex:gt,source:ut.source,seller:ut.seller}),mt.asos.eventBus.emit("sizeChanged",vt),this.isLowInStock(ft)}.bind(this)),this.isDesktopMixMatch=ht.isMixMatch&&!ht.isMobile,this.selectorIndex=ht.selectorIndex,this.context=ht.context,this.sizeSelectorId=this.context+"-size-select-"+this.selectorIndex,this.variants=ut.computed(function(){return void 0===this.colour()?[]:this.colour().variants}.bind(this)),gt.showSizeGuide||(gt.showSizeGuide=ut.observable(!1)),gt.showSizeGuide(!0===ht.showSizeGuide&&ft.sizeGuideVisible),this.selectSizePrompt=gt.resources.pdp_select_colour_size_message,this.sizeLabel=gt.resources.pdp_misc_size+":",this.outOfStockText=gt.resources.pdp_status_out_of_stock,this.notAvailableText=gt.resources.pdp_status_not_available,this.selectSizeText=gt.resources.pdp_select_size_label,this.lowInStockText=gt.resources.pdp_status_low_in_stock;var yt=ht.state.productData;this.isDisabled=!ht.state.productData.isInStock;for(var St=yt.colours,wt=0,xt=St.length-1;xt>=0;xt--){var It=St[xt];It.variants.length>wt&&(wt=It.variants.length)}this.focusSizeSelect.subscribe(function(ut){var ht=document.getElementById(this.sizeSelectorId);ut&&(ht.focus({preventScroll:!!this.preventFocusScroll()}),this.preventFocusScroll(!1),this.focusSizeSelect(!1))}.bind(this)),this.noSizeSelected.subscribe(function(ut){this.focusSizeSelect(ut)}.bind(this)),!this.displayOnlyAsDropDown&&!ft.isNoSize&&St.length>1&&1===wt&&(this.alwaysDisplaySizeLabel=!0),this.colour.subscribe(function(ut){void 0===ut||1!==this.colour().variants.length||this.displayOnlyAsDropDown?this.setDefaultSize():this.size(this.colour().variants[0])}.bind(this)),this.sizeDropdownVisible=ut.computed(function(){if(this.alwaysDisplaySizeLabel)return!1;if(this.displayOnlyAsDropDown)return!0;if(ft.isNoSize)return!1;var ut=void 0===this.colour(),ht=ut?0:this.colour().variants.length;return ut||ht>1}.bind(this)),this.sizeLabelVisible=ut.computed(function(){return!!this.alwaysDisplaySizeLabel||!this.displayOnlyAsDropDown&&!ft.isNoSize&&!this.sizeDropdownVisible()}.bind(this)),this.sizeSectionVisible=ut.computed(function(){return this.sizeLabelVisible()||this.sizeDropdownVisible()}.bind(this)),this.render=ut.computed(function(){return!(vt&&!gt.productData.isInStock)&&(!ft.isOneSize&&this.variants()&&this.variants().length>1)}.bind(this)),this.disableSizeIfOutOfStock=function(ht,pt){var mt;null!=pt&&(mt=yt.hasDifferentPrices&&void 0!==pt.price&&void 0!==pt.price.current?" - "+pt.price.current.text:"",pt.isInStock||(mt+=" - "+this.outOfStockText),ht.text=pt.size+mt,ut.applyBindingsToNode(ht,{enable:pt.isInStock},pt))}.bind(this),this.sizeDropdownDisabled=ut.computed(function(){return void 0===this.colour()}.bind(this)),this.selectedSizeLabel=ut.computed(function(){return this.alwaysDisplaySizeLabel?St[0].variants[0].size:this.size()?this.size().size:""}.bind(this)),this.setDefaultSize=function(){if(!this.doNotSelectDefaultSize&&void 0!==yt&&void 0!==this.variants()&&1===yt.colours.length){for(var ut,ht=yt.colours[0],pt=ht.variants.length-1;pt>=0;pt--)if(ht.variants[pt].isInStock){if(void 0!==ut){ut=void 0;break}ut=this.variants()[pt]}void 0!==ut&&this.size(ut)}},this.setVariantSize=function(ut,ht){for(var pt=0;pt<ut.length;pt++)if(ut[pt].variantId===ht){if(!ut[pt].isInStock){this.size(void 0);break}this.size(ut[pt]);break}},this.setDefaultSize(),ht.state.defaultVariant&&this.setVariantSize(this.variants(),ht.state.defaultVariant.variantId)},template:ht}})),define("Pages/MixAndMatch",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","Models/VariantDecorator","Components/product-image/product-image","Components/product-price/product-price","Components/add-item/add-item","Components/social-share/social-share","Components/content/content","Components/size-guide/size-guide","Components/mix-and-match/mix-and-match","Components/product-gallery/product-gallery","Components/product-colour/product-colour","Components/product-size/product-size","Components/add-item/add-item","PageConfig","ProductUtils/NewRelicLogger","ProductUtils/ScrollTo","ProductUtils/Performance"],(function(ut,ht,pt,mt,ft,gt,vt,bt,yt,St,wt,xt,It,Pt,Tt,zt,Ct,Et){return this.init=function(){function a(ht){for(var pt=0;pt<ht.products.length;pt++){var mt={selectedColour:ut.observable(),selectedSize:ut.observable(),showNoColourSelectedWarning:ut.observable(!1),showNoSizeSelectedWarning:ut.observable(!1),focusColourSelect:ut.observable(!1),focusSizeSelect:ut.observable(!1),preventFocusScroll:ut.observable(!1),showAddToBagError:ut.observable(!1),addToBagErrorMessage:ut.observable(""),productImage:ht.products[pt].productImage.url,resources:St,sizeGuideOpened:kt.sizeGuideOpened,session:kt.session};ht.products[pt].brandName=bt.brandName,mt.productData=(new ft).getData(ht.products[pt],!0),Mt.push(mt)}Vt.States=Mt,At.register({type:"content",name:"content1",elementId:"aside-content",useComponentTemplate:!1},Vt,kt),Dt=!0}function l(){Lt||(window.asos.eventBus.addListener("productAndPriceData",(function(ut){Dt||a(ut)})),function e(){return _t.getStockPrice(Vt,a,(function(){})),e}(),At.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},Vt,this.state),ut.components.register("product-gallery",It),ut.components.register("size-guide",wt),ut.components.register("product-image",gt),ut.components.register("product-colour",Pt),ut.components.register("product-size",Tt),ut.components.register("product-price",vt),ut.components.register("social-share",yt),ut.components.register("mix-and-match",xt),ut.components.register("asos-video-player-prod",pt.videoPlayer),ut.components.register("asos-spin-viewer-prod",pt.spinViewer),ut.components.register("add-item",zt),Lt=!0,window.asos.pdp.koComponents=At,window.asos.pdp.koState=kt,window.asos.eventBus.emit("knockoutInitialised",At,kt))}Et.init(Et.PAGE_TYPE.GRP);var bt=window.asos.pdp.config.product,St=window.asos.pdp.config.translations;this.state={resources:St,features:window.asos.pdp.config.features,selectedColour:ut.observable(),showNoSizesSelectedWarning:ut.observable(!1),focusColourSelect:ut.observable(!1),focusSizeSelect:ut.observable(!1),preventFocusScroll:ut.observable(!1),showAddToBagError:ut.observable(!1),addToBagErrorMessage:ut.observable(""),sizeGuideOpened:ut.observable(!1)},this.isMobile="mobile"===Ct.platform,this.useProductIdForVideos=!0;var kt=this.state,At=new ht,Vt="string"==typeof bt?JSON.parse(bt):bt;Vt||Et.logError(new Error(Et.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"});var _t=new mt,Mt=[],Lt=!1,Dt=!1;document.addEventListener("DOMContentLoaded",function(){l.call(this)}.bind(this)),document.getElementById("aside-content")&&document.getElementById("gallery-content")&&l.call(this)},this.init})),window.location.href.includes("/grp/")&&require(["Pages/MixAndMatch"],(function(ut){ut()})),define("PageConfig",(function(){var ut=window.asos.webContext.getWebContext();return{storeCode:ut.storeId,countryCode:ut.browseCountry,geoCountryCode:ut.geoCountry,currency:ut.browseCurrency,language:ut.browseLanguage,languageShort:ut.browseLanguage.substring(0,2),sizeSchema:ut.browseSizeSchema,keyStoreDataversion:ut.keyStoreDataversion,siteChromeTemplateVersion:ut.templateVersion,siteChromeTemplateBuild:ut.buildVersion,gender:ut.floor,siteDomain:window.asos.pdp.config.siteDomain,platform:ut.platform,storeId:ut.storeId,pageTitle:document.title,version:window.asos.pdp.config.appVersion,pageType:window.location.href.includes("/prd/")?"product":"mix&match",useTestFeaturesManifest:window.asos.pdp.config.useTestFeaturesManifest,imagePresets:JSON.parse(window.asos.pdp.config.imagePresets)}})),define("Promise",(function(){return Promise})),define("main",["Pages/FullProduct","Pages/MixAndMatch"],(function(){}));